/*! For license information please see 856.48c44269.iframe.bundle.js.LICENSE.txt */
(self.webpackChunk_tisoap_react_flow_smart_edge=self.webpackChunk_tisoap_react_flow_smart_edge||[]).push([[856],{"./node_modules/@reactflow/core/dist/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u5:()=>BaseEdge,Jd:()=>BezierEdge,QZ:()=>MarkerType,x$:()=>ReactFlow,xC:()=>StepEdge,r4:()=>StraightEdge,SM:()=>useNodes});var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),react=__webpack_require__("./node_modules/react/index.js");function cc(names){if("string"==typeof names||"number"==typeof names)return""+names;let out="";if(Array.isArray(names))for(let tmp,i=0;i<names.length;i++)""!==(tmp=cc(names[i]))&&(out+=(out&&" ")+tmp);else for(let k in names)names[k]&&(out+=(out&&" ")+k);return out}var with_selector=__webpack_require__("./node_modules/use-sync-external-store/shim/with-selector.js");const createStoreImpl=createState=>{let state;const listeners=new Set,setState=(partial,replace)=>{const nextState="function"==typeof partial?partial(state):partial;if(!Object.is(nextState,state)){const previousState=state;state=(null!=replace?replace:"object"!=typeof nextState)?nextState:Object.assign({},state,nextState),listeners.forEach((listener=>listener(state,previousState)))}},getState=()=>state,api={setState,getState,subscribe:listener=>(listeners.add(listener),()=>listeners.delete(listener)),destroy:()=>{console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),listeners.clear()}};return state=createState(setState,getState,api),api},createStore=createState=>createState?createStoreImpl(createState):createStoreImpl;const{useSyncExternalStoreWithSelector}=with_selector;function useStoreWithEqualityFn(api,selector=api.getState,equalityFn){const slice=useSyncExternalStoreWithSelector(api.subscribe,api.getState,api.getServerState||api.getState,selector,equalityFn);return(0,react.useDebugValue)(slice),slice}const createWithEqualityFnImpl=(createState,defaultEqualityFn)=>{const api=createStore(createState),useBoundStoreWithEqualityFn=(selector,equalityFn=defaultEqualityFn)=>useStoreWithEqualityFn(api,selector,equalityFn);return Object.assign(useBoundStoreWithEqualityFn,api),useBoundStoreWithEqualityFn};function shallow_shallow(objA,objB){if(Object.is(objA,objB))return!0;if("object"!=typeof objA||null===objA||"object"!=typeof objB||null===objB)return!1;if(objA instanceof Map&&objB instanceof Map){if(objA.size!==objB.size)return!1;for(const[key,value]of objA)if(!Object.is(value,objB.get(key)))return!1;return!0}if(objA instanceof Set&&objB instanceof Set){if(objA.size!==objB.size)return!1;for(const value of objA)if(!objB.has(value))return!1;return!0}const keysA=Object.keys(objA);if(keysA.length!==Object.keys(objB).length)return!1;for(let i=0;i<keysA.length;i++)if(!Object.prototype.hasOwnProperty.call(objB,keysA[i])||!Object.is(objA[keysA[i]],objB[keysA[i]]))return!1;return!0}var noop={value:()=>{}};function dispatch(){for(var t,i=0,n=arguments.length,_={};i<n;++i){if(!(t=arguments[i]+"")||t in _||/[\s.]/.test(t))throw new Error("illegal type: "+t);_[t]=[]}return new Dispatch(_)}function Dispatch(_){this._=_}function get(type,name){for(var c,i=0,n=type.length;i<n;++i)if((c=type[i]).name===name)return c.value}function set(type,name,callback){for(var i=0,n=type.length;i<n;++i)if(type[i].name===name){type[i]=noop,type=type.slice(0,i).concat(type.slice(i+1));break}return null!=callback&&type.push({name,value:callback}),type}Dispatch.prototype=dispatch.prototype={constructor:Dispatch,on:function(typename,callback){var t,_=this._,T=function parseTypenames(typenames,types){return typenames.trim().split(/^|\s+/).map((function(t){var name="",i=t.indexOf(".");if(i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),t&&!types.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name}}))}(typename+"",_),i=-1,n=T.length;if(!(arguments.length<2)){if(null!=callback&&"function"!=typeof callback)throw new Error("invalid callback: "+callback);for(;++i<n;)if(t=(typename=T[i]).type)_[t]=set(_[t],typename.name,callback);else if(null==callback)for(t in _)_[t]=set(_[t],typename.name,null);return this}for(;++i<n;)if((t=(typename=T[i]).type)&&(t=get(_[t],typename.name)))return t},copy:function(){var copy={},_=this._;for(var t in _)copy[t]=_[t].slice();return new Dispatch(copy)},call:function(type,that){if((n=arguments.length-2)>0)for(var n,t,args=new Array(n),i=0;i<n;++i)args[i]=arguments[i+2];if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(i=0,n=(t=this._[type]).length;i<n;++i)t[i].value.apply(that,args)},apply:function(type,that,args){if(!this._.hasOwnProperty(type))throw new Error("unknown type: "+type);for(var t=this._[type],i=0,n=t.length;i<n;++i)t[i].value.apply(that,args)}};const src_dispatch=dispatch;function none(){}function selector(selector){return null==selector?none:function(){return this.querySelector(selector)}}function empty(){return[]}function selectorAll(selector){return null==selector?empty:function(){return this.querySelectorAll(selector)}}function arrayAll(select){return function(){return function array(x){return null==x?[]:Array.isArray(x)?x:Array.from(x)}(select.apply(this,arguments))}}function matcher(selector){return function(){return this.matches(selector)}}function childMatcher(selector){return function(node){return node.matches(selector)}}var find=Array.prototype.find;function childFirst(){return this.firstElementChild}var filter=Array.prototype.filter;function children(){return Array.from(this.children)}function sparse(update){return new Array(update.length)}function EnterNode(parent,datum){this.ownerDocument=parent.ownerDocument,this.namespaceURI=parent.namespaceURI,this._next=null,this._parent=parent,this.__data__=datum}function bindIndex(parent,group,enter,update,exit,data){for(var node,i=0,groupLength=group.length,dataLength=data.length;i<dataLength;++i)(node=group[i])?(node.__data__=data[i],update[i]=node):enter[i]=new EnterNode(parent,data[i]);for(;i<groupLength;++i)(node=group[i])&&(exit[i]=node)}function bindKey(parent,group,enter,update,exit,data,key){var i,node,keyValue,nodeByKeyValue=new Map,groupLength=group.length,dataLength=data.length,keyValues=new Array(groupLength);for(i=0;i<groupLength;++i)(node=group[i])&&(keyValues[i]=keyValue=key.call(node,node.__data__,i,group)+"",nodeByKeyValue.has(keyValue)?exit[i]=node:nodeByKeyValue.set(keyValue,node));for(i=0;i<dataLength;++i)keyValue=key.call(parent,data[i],i,data)+"",(node=nodeByKeyValue.get(keyValue))?(update[i]=node,node.__data__=data[i],nodeByKeyValue.delete(keyValue)):enter[i]=new EnterNode(parent,data[i]);for(i=0;i<groupLength;++i)(node=group[i])&&nodeByKeyValue.get(keyValues[i])===node&&(exit[i]=node)}function datum(node){return node.__data__}function arraylike(data){return"object"==typeof data&&"length"in data?data:Array.from(data)}function ascending(a,b){return a<b?-1:a>b?1:a>=b?0:NaN}EnterNode.prototype={constructor:EnterNode,appendChild:function(child){return this._parent.insertBefore(child,this._next)},insertBefore:function(child,next){return this._parent.insertBefore(child,next)},querySelector:function(selector){return this._parent.querySelector(selector)},querySelectorAll:function(selector){return this._parent.querySelectorAll(selector)}};var xhtml="http://www.w3.org/1999/xhtml";const namespaces={svg:"http://www.w3.org/2000/svg",xhtml,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function namespace(name){var prefix=name+="",i=prefix.indexOf(":");return i>=0&&"xmlns"!==(prefix=name.slice(0,i))&&(name=name.slice(i+1)),namespaces.hasOwnProperty(prefix)?{space:namespaces[prefix],local:name}:name}function attrRemove(name){return function(){this.removeAttribute(name)}}function attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attrConstant(name,value){return function(){this.setAttribute(name,value)}}function attrConstantNS(fullname,value){return function(){this.setAttributeNS(fullname.space,fullname.local,value)}}function attrFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttribute(name):this.setAttribute(name,v)}}function attrFunctionNS(fullname,value){return function(){var v=value.apply(this,arguments);null==v?this.removeAttributeNS(fullname.space,fullname.local):this.setAttributeNS(fullname.space,fullname.local,v)}}function src_window(node){return node.ownerDocument&&node.ownerDocument.defaultView||node.document&&node||node.defaultView}function styleRemove(name){return function(){this.style.removeProperty(name)}}function styleConstant(name,value,priority){return function(){this.style.setProperty(name,value,priority)}}function styleFunction(name,value,priority){return function(){var v=value.apply(this,arguments);null==v?this.style.removeProperty(name):this.style.setProperty(name,v,priority)}}function styleValue(node,name){return node.style.getPropertyValue(name)||src_window(node).getComputedStyle(node,null).getPropertyValue(name)}function propertyRemove(name){return function(){delete this[name]}}function propertyConstant(name,value){return function(){this[name]=value}}function propertyFunction(name,value){return function(){var v=value.apply(this,arguments);null==v?delete this[name]:this[name]=v}}function classArray(string){return string.trim().split(/^|\s+/)}function classList(node){return node.classList||new ClassList(node)}function ClassList(node){this._node=node,this._names=classArray(node.getAttribute("class")||"")}function classedAdd(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.add(names[i])}function classedRemove(node,names){for(var list=classList(node),i=-1,n=names.length;++i<n;)list.remove(names[i])}function classedTrue(names){return function(){classedAdd(this,names)}}function classedFalse(names){return function(){classedRemove(this,names)}}function classedFunction(names,value){return function(){(value.apply(this,arguments)?classedAdd:classedRemove)(this,names)}}function textRemove(){this.textContent=""}function textConstant(value){return function(){this.textContent=value}}function textFunction(value){return function(){var v=value.apply(this,arguments);this.textContent=null==v?"":v}}function htmlRemove(){this.innerHTML=""}function htmlConstant(value){return function(){this.innerHTML=value}}function htmlFunction(value){return function(){var v=value.apply(this,arguments);this.innerHTML=null==v?"":v}}function raise(){this.nextSibling&&this.parentNode.appendChild(this)}function lower(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function creatorInherit(name){return function(){var document=this.ownerDocument,uri=this.namespaceURI;return uri===xhtml&&document.documentElement.namespaceURI===xhtml?document.createElement(name):document.createElementNS(uri,name)}}function creatorFixed(fullname){return function(){return this.ownerDocument.createElementNS(fullname.space,fullname.local)}}function creator(name){var fullname=namespace(name);return(fullname.local?creatorFixed:creatorInherit)(fullname)}function constantNull(){return null}function remove(){var parent=this.parentNode;parent&&parent.removeChild(this)}function selection_cloneShallow(){var clone=this.cloneNode(!1),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function selection_cloneDeep(){var clone=this.cloneNode(!0),parent=this.parentNode;return parent?parent.insertBefore(clone,this.nextSibling):clone}function onRemove(typename){return function(){var on=this.__on;if(on){for(var o,j=0,i=-1,m=on.length;j<m;++j)o=on[j],typename.type&&o.type!==typename.type||o.name!==typename.name?on[++i]=o:this.removeEventListener(o.type,o.listener,o.options);++i?on.length=i:delete this.__on}}}function onAdd(typename,value,options){return function(){var o,on=this.__on,listener=function contextListener(listener){return function(event){listener.call(this,event,this.__data__)}}(value);if(on)for(var j=0,m=on.length;j<m;++j)if((o=on[j]).type===typename.type&&o.name===typename.name)return this.removeEventListener(o.type,o.listener,o.options),this.addEventListener(o.type,o.listener=listener,o.options=options),void(o.value=value);this.addEventListener(typename.type,listener,options),o={type:typename.type,name:typename.name,value,listener,options},on?on.push(o):this.__on=[o]}}function dispatchEvent(node,type,params){var window=src_window(node),event=window.CustomEvent;"function"==typeof event?event=new event(type,params):(event=window.document.createEvent("Event"),params?(event.initEvent(type,params.bubbles,params.cancelable),event.detail=params.detail):event.initEvent(type,!1,!1)),node.dispatchEvent(event)}function dispatchConstant(type,params){return function(){return dispatchEvent(this,type,params)}}function dispatchFunction(type,params){return function(){return dispatchEvent(this,type,params.apply(this,arguments))}}ClassList.prototype={add:function(name){this._names.indexOf(name)<0&&(this._names.push(name),this._node.setAttribute("class",this._names.join(" ")))},remove:function(name){var i=this._names.indexOf(name);i>=0&&(this._names.splice(i,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(name){return this._names.indexOf(name)>=0}};var root=[null];function Selection(groups,parents){this._groups=groups,this._parents=parents}function selection(){return new Selection([[document.documentElement]],root)}Selection.prototype=selection.prototype={constructor:Selection,select:function selection_select(select){"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode);return new Selection(subgroups,this._parents)},selectAll:function selectAll(select){select="function"==typeof select?arrayAll(select):selectorAll(select);for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&(subgroups.push(select.call(node,node.__data__,i,group)),parents.push(node));return new Selection(subgroups,parents)},selectChild:function selectChild(match){return this.select(null==match?childFirst:function childFind(match){return function(){return find.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},selectChildren:function selectChildren(match){return this.selectAll(null==match?children:function childrenFilter(match){return function(){return filter.call(this.children,match)}}("function"==typeof match?match:childMatcher(match)))},filter:function selection_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Selection(subgroups,this._parents)},data:function data(value,key){if(!arguments.length)return Array.from(this,datum);var bind=key?bindKey:bindIndex,parents=this._parents,groups=this._groups;"function"!=typeof value&&(value=function src_constant(x){return function(){return x}}(value));for(var m=groups.length,update=new Array(m),enter=new Array(m),exit=new Array(m),j=0;j<m;++j){var parent=parents[j],group=groups[j],groupLength=group.length,data=arraylike(value.call(parent,parent&&parent.__data__,j,parents)),dataLength=data.length,enterGroup=enter[j]=new Array(dataLength),updateGroup=update[j]=new Array(dataLength);bind(parent,group,enterGroup,updateGroup,exit[j]=new Array(groupLength),data,key);for(var previous,next,i0=0,i1=0;i0<dataLength;++i0)if(previous=enterGroup[i0]){for(i0>=i1&&(i1=i0+1);!(next=updateGroup[i1])&&++i1<dataLength;);previous._next=next||null}}return(update=new Selection(update,parents))._enter=enter,update._exit=exit,update},enter:function enter(){return new Selection(this._enter||this._groups.map(sparse),this._parents)},exit:function exit(){return new Selection(this._exit||this._groups.map(sparse),this._parents)},join:function join(onenter,onupdate,onexit){var enter=this.enter(),update=this,exit=this.exit();return"function"==typeof onenter?(enter=onenter(enter))&&(enter=enter.selection()):enter=enter.append(onenter+""),null!=onupdate&&(update=onupdate(update))&&(update=update.selection()),null==onexit?exit.remove():onexit(exit),enter&&update?enter.merge(update).order():update},merge:function merge(context){for(var selection=context.selection?context.selection():context,groups0=this._groups,groups1=selection._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Selection(merges,this._parents)},selection:function selection_selection(){return this},order:function order(){for(var groups=this._groups,j=-1,m=groups.length;++j<m;)for(var node,group=groups[j],i=group.length-1,next=group[i];--i>=0;)(node=group[i])&&(next&&4^node.compareDocumentPosition(next)&&next.parentNode.insertBefore(node,next),next=node);return this},sort:function sort(compare){function compareNode(a,b){return a&&b?compare(a.__data__,b.__data__):!a-!b}compare||(compare=ascending);for(var groups=this._groups,m=groups.length,sortgroups=new Array(m),j=0;j<m;++j){for(var node,group=groups[j],n=group.length,sortgroup=sortgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(sortgroup[i]=node);sortgroup.sort(compareNode)}return new Selection(sortgroups,this._parents).order()},call:function call(){var callback=arguments[0];return arguments[0]=this,callback.apply(null,arguments),this},nodes:function nodes(){return Array.from(this)},node:function node(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var group=groups[j],i=0,n=group.length;i<n;++i){var node=group[i];if(node)return node}return null},size:function size(){let size=0;for(const node of this)++size;return size},empty:function selection_empty(){return!this.node()},each:function each(callback){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&callback.call(node,node.__data__,i,group);return this},attr:function attr(name,value){var fullname=namespace(name);if(arguments.length<2){var node=this.node();return fullname.local?node.getAttributeNS(fullname.space,fullname.local):node.getAttribute(fullname)}return this.each((null==value?fullname.local?attrRemoveNS:attrRemove:"function"==typeof value?fullname.local?attrFunctionNS:attrFunction:fullname.local?attrConstantNS:attrConstant)(fullname,value))},style:function style(name,value,priority){return arguments.length>1?this.each((null==value?styleRemove:"function"==typeof value?styleFunction:styleConstant)(name,value,null==priority?"":priority)):styleValue(this.node(),name)},property:function property(name,value){return arguments.length>1?this.each((null==value?propertyRemove:"function"==typeof value?propertyFunction:propertyConstant)(name,value)):this.node()[name]},classed:function classed(name,value){var names=classArray(name+"");if(arguments.length<2){for(var list=classList(this.node()),i=-1,n=names.length;++i<n;)if(!list.contains(names[i]))return!1;return!0}return this.each(("function"==typeof value?classedFunction:value?classedTrue:classedFalse)(names,value))},text:function selection_text(value){return arguments.length?this.each(null==value?textRemove:("function"==typeof value?textFunction:textConstant)(value)):this.node().textContent},html:function html(value){return arguments.length?this.each(null==value?htmlRemove:("function"==typeof value?htmlFunction:htmlConstant)(value)):this.node().innerHTML},raise:function selection_raise(){return this.each(raise)},lower:function selection_lower(){return this.each(lower)},append:function append(name){var create="function"==typeof name?name:creator(name);return this.select((function(){return this.appendChild(create.apply(this,arguments))}))},insert:function insert(name,before){var create="function"==typeof name?name:creator(name),select=null==before?constantNull:"function"==typeof before?before:selector(before);return this.select((function(){return this.insertBefore(create.apply(this,arguments),select.apply(this,arguments)||null)}))},remove:function selection_remove(){return this.each(remove)},clone:function clone(deep){return this.select(deep?selection_cloneDeep:selection_cloneShallow)},datum:function selection_datum(value){return arguments.length?this.property("__data__",value):this.node().__data__},on:function on(typename,value,options){var i,t,typenames=function on_parseTypenames(typenames){return typenames.trim().split(/^|\s+/).map((function(t){var name="",i=t.indexOf(".");return i>=0&&(name=t.slice(i+1),t=t.slice(0,i)),{type:t,name}}))}(typename+""),n=typenames.length;if(!(arguments.length<2)){for(on=value?onAdd:onRemove,i=0;i<n;++i)this.each(on(typenames[i],value,options));return this}var on=this.node().__on;if(on)for(var o,j=0,m=on.length;j<m;++j)for(i=0,o=on[j];i<n;++i)if((t=typenames[i]).type===o.type&&t.name===o.name)return o.value},dispatch:function selection_dispatch(type,params){return this.each(("function"==typeof params?dispatchFunction:dispatchConstant)(type,params))},[Symbol.iterator]:function*iterator(){for(var groups=this._groups,j=0,m=groups.length;j<m;++j)for(var node,group=groups[j],i=0,n=group.length;i<n;++i)(node=group[i])&&(yield node)}};const src_selection=selection;function src_select(selector){return"string"==typeof selector?new Selection([[document.querySelector(selector)]],[document.documentElement]):new Selection([[selector]],root)}const nonpassive={passive:!1},nonpassivecapture={capture:!0,passive:!1};function nopropagation(event){event.stopImmediatePropagation()}function noevent(event){event.preventDefault(),event.stopImmediatePropagation()}function nodrag(view){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",noevent,nonpassivecapture);"onselectstart"in root?selection.on("selectstart.drag",noevent,nonpassivecapture):(root.__noselect=root.style.MozUserSelect,root.style.MozUserSelect="none")}function yesdrag(view,noclick){var root=view.document.documentElement,selection=src_select(view).on("dragstart.drag",null);noclick&&(selection.on("click.drag",noevent,nonpassivecapture),setTimeout((function(){selection.on("click.drag",null)}),0)),"onselectstart"in root?selection.on("selectstart.drag",null):(root.style.MozUserSelect=root.__noselect,delete root.__noselect)}function cosh(x){return((x=Math.exp(x))+1/x)/2}const src_zoom=function zoomRho(rho,rho2,rho4){function zoom(p0,p1){var i,S,ux0=p0[0],uy0=p0[1],w0=p0[2],ux1=p1[0],uy1=p1[1],w1=p1[2],dx=ux1-ux0,dy=uy1-uy0,d2=dx*dx+dy*dy;if(d2<1e-12)S=Math.log(w1/w0)/rho,i=function(t){return[ux0+t*dx,uy0+t*dy,w0*Math.exp(rho*t*S)]};else{var d1=Math.sqrt(d2),b0=(w1*w1-w0*w0+rho4*d2)/(2*w0*rho2*d1),b1=(w1*w1-w0*w0-rho4*d2)/(2*w1*rho2*d1),r0=Math.log(Math.sqrt(b0*b0+1)-b0),r1=Math.log(Math.sqrt(b1*b1+1)-b1);S=(r1-r0)/rho,i=function(t){var s=t*S,coshr0=cosh(r0),u=w0/(rho2*d1)*(coshr0*function tanh(x){return((x=Math.exp(2*x))-1)/(x+1)}(rho*s+r0)-function sinh(x){return((x=Math.exp(x))-1/x)/2}(r0));return[ux0+u*dx,uy0+u*dy,w0*coshr0/cosh(rho*s+r0)]}}return i.duration=1e3*S*rho/Math.SQRT2,i}return zoom.rho=function(_){var _1=Math.max(.001,+_),_2=_1*_1;return zoomRho(_1,_2,_2*_2)},zoom}(Math.SQRT2,2,4);function pointer(event,node){if(event=function sourceEvent(event){let sourceEvent;for(;sourceEvent=event.sourceEvent;)event=sourceEvent;return event}(event),void 0===node&&(node=event.currentTarget),node){var svg=node.ownerSVGElement||node;if(svg.createSVGPoint){var point=svg.createSVGPoint();return point.x=event.clientX,point.y=event.clientY,[(point=point.matrixTransform(node.getScreenCTM().inverse())).x,point.y]}if(node.getBoundingClientRect){var rect=node.getBoundingClientRect();return[event.clientX-rect.left-node.clientLeft,event.clientY-rect.top-node.clientTop]}}return[event.pageX,event.pageY]}var taskHead,taskTail,timer_frame=0,timeout=0,interval=0,pokeDelay=1e3,clockLast=0,clockNow=0,clockSkew=0,clock="object"==typeof performance&&performance.now?performance:Date,setFrame="object"==typeof window&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(f){setTimeout(f,17)};function now(){return clockNow||(setFrame(clearNow),clockNow=clock.now()+clockSkew)}function clearNow(){clockNow=0}function Timer(){this._call=this._time=this._next=null}function timer(callback,delay,time){var t=new Timer;return t.restart(callback,delay,time),t}function wake(){clockNow=(clockLast=clock.now())+clockSkew,timer_frame=timeout=0;try{!function timerFlush(){now(),++timer_frame;for(var e,t=taskHead;t;)(e=clockNow-t._time)>=0&&t._call.call(void 0,e),t=t._next;--timer_frame}()}finally{timer_frame=0,function nap(){var t0,t2,t1=taskHead,time=1/0;for(;t1;)t1._call?(time>t1._time&&(time=t1._time),t0=t1,t1=t1._next):(t2=t1._next,t1._next=null,t1=t0?t0._next=t2:taskHead=t2);taskTail=t0,sleep(time)}(),clockNow=0}}function poke(){var now=clock.now(),delay=now-clockLast;delay>pokeDelay&&(clockSkew-=delay,clockLast=now)}function sleep(time){timer_frame||(timeout&&(timeout=clearTimeout(timeout)),time-clockNow>24?(time<1/0&&(timeout=setTimeout(wake,time-clock.now()-clockSkew)),interval&&(interval=clearInterval(interval))):(interval||(clockLast=clock.now(),interval=setInterval(poke,pokeDelay)),timer_frame=1,setFrame(wake)))}function src_timeout(callback,delay,time){var t=new Timer;return delay=null==delay?0:+delay,t.restart((elapsed=>{t.stop(),callback(elapsed+delay)}),delay,time),t}Timer.prototype=timer.prototype={constructor:Timer,restart:function(callback,delay,time){if("function"!=typeof callback)throw new TypeError("callback is not a function");time=(null==time?now():+time)+(null==delay?0:+delay),this._next||taskTail===this||(taskTail?taskTail._next=this:taskHead=this,taskTail=this),this._call=callback,this._time=time,sleep()},stop:function(){this._call&&(this._call=null,this._time=1/0,sleep())}};var emptyOn=src_dispatch("start","end","cancel","interrupt"),emptyTween=[],CREATED=0,SCHEDULED=1,STARTING=2,STARTED=3,RUNNING=4,ENDING=5,ENDED=6;function schedule(node,name,id,index,group,timing){var schedules=node.__transition;if(schedules){if(id in schedules)return}else node.__transition={};!function create(node,id,self){var tween,schedules=node.__transition;function schedule(elapsed){self.state=SCHEDULED,self.timer.restart(start,self.delay,self.time),self.delay<=elapsed&&start(elapsed-self.delay)}function start(elapsed){var i,j,n,o;if(self.state!==SCHEDULED)return stop();for(i in schedules)if((o=schedules[i]).name===self.name){if(o.state===STARTED)return src_timeout(start);o.state===RUNNING?(o.state=ENDED,o.timer.stop(),o.on.call("interrupt",node,node.__data__,o.index,o.group),delete schedules[i]):+i<id&&(o.state=ENDED,o.timer.stop(),o.on.call("cancel",node,node.__data__,o.index,o.group),delete schedules[i])}if(src_timeout((function(){self.state===STARTED&&(self.state=RUNNING,self.timer.restart(tick,self.delay,self.time),tick(elapsed))})),self.state=STARTING,self.on.call("start",node,node.__data__,self.index,self.group),self.state===STARTING){for(self.state=STARTED,tween=new Array(n=self.tween.length),i=0,j=-1;i<n;++i)(o=self.tween[i].value.call(node,node.__data__,self.index,self.group))&&(tween[++j]=o);tween.length=j+1}}function tick(elapsed){for(var t=elapsed<self.duration?self.ease.call(null,elapsed/self.duration):(self.timer.restart(stop),self.state=ENDING,1),i=-1,n=tween.length;++i<n;)tween[i].call(node,t);self.state===ENDING&&(self.on.call("end",node,node.__data__,self.index,self.group),stop())}function stop(){for(var i in self.state=ENDED,self.timer.stop(),delete schedules[id],schedules)return;delete node.__transition}schedules[id]=self,self.timer=timer(schedule,0,self.time)}(node,id,{name,index,group,on:emptyOn,tween:emptyTween,time:timing.time,delay:timing.delay,duration:timing.duration,ease:timing.ease,timer:null,state:CREATED})}function init(node,id){var schedule=schedule_get(node,id);if(schedule.state>CREATED)throw new Error("too late; already scheduled");return schedule}function schedule_set(node,id){var schedule=schedule_get(node,id);if(schedule.state>STARTED)throw new Error("too late; already running");return schedule}function schedule_get(node,id){var schedule=node.__transition;if(!schedule||!(schedule=schedule[id]))throw new Error("transition not found");return schedule}function interrupt(node,name){var schedule,active,i,schedules=node.__transition,empty=!0;if(schedules){for(i in name=null==name?null:name+"",schedules)(schedule=schedules[i]).name===name?(active=schedule.state>STARTING&&schedule.state<ENDING,schedule.state=ENDED,schedule.timer.stop(),schedule.on.call(active?"interrupt":"cancel",node,node.__data__,schedule.index,schedule.group),delete schedules[i]):empty=!1;empty&&delete node.__transition}}function number(a,b){return a=+a,b=+b,function(t){return a*(1-t)+b*t}}var svgNode,degrees=180/Math.PI,identity={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function decompose(a,b,c,d,e,f){var scaleX,scaleY,skewX;return(scaleX=Math.sqrt(a*a+b*b))&&(a/=scaleX,b/=scaleX),(skewX=a*c+b*d)&&(c-=a*skewX,d-=b*skewX),(scaleY=Math.sqrt(c*c+d*d))&&(c/=scaleY,d/=scaleY,skewX/=scaleY),a*d<b*c&&(a=-a,b=-b,skewX=-skewX,scaleX=-scaleX),{translateX:e,translateY:f,rotate:Math.atan2(b,a)*degrees,skewX:Math.atan(skewX)*degrees,scaleX,scaleY}}function interpolateTransform(parse,pxComma,pxParen,degParen){function pop(s){return s.length?s.pop()+" ":""}return function(a,b){var s=[],q=[];return a=parse(a),b=parse(b),function translate(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push("translate(",null,pxComma,null,pxParen);q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else(xb||yb)&&s.push("translate("+xb+pxComma+yb+pxParen)}(a.translateX,a.translateY,b.translateX,b.translateY,s,q),function rotate(a,b,s,q){a!==b?(a-b>180?b+=360:b-a>180&&(a+=360),q.push({i:s.push(pop(s)+"rotate(",null,degParen)-2,x:number(a,b)})):b&&s.push(pop(s)+"rotate("+b+degParen)}(a.rotate,b.rotate,s,q),function skewX(a,b,s,q){a!==b?q.push({i:s.push(pop(s)+"skewX(",null,degParen)-2,x:number(a,b)}):b&&s.push(pop(s)+"skewX("+b+degParen)}(a.skewX,b.skewX,s,q),function scale(xa,ya,xb,yb,s,q){if(xa!==xb||ya!==yb){var i=s.push(pop(s)+"scale(",null,",",null,")");q.push({i:i-4,x:number(xa,xb)},{i:i-2,x:number(ya,yb)})}else 1===xb&&1===yb||s.push(pop(s)+"scale("+xb+","+yb+")")}(a.scaleX,a.scaleY,b.scaleX,b.scaleY,s,q),a=b=null,function(t){for(var o,i=-1,n=q.length;++i<n;)s[(o=q[i]).i]=o.x(t);return s.join("")}}}var interpolateTransformCss=interpolateTransform((function parseCss(value){const m=new("function"==typeof DOMMatrix?DOMMatrix:WebKitCSSMatrix)(value+"");return m.isIdentity?identity:decompose(m.a,m.b,m.c,m.d,m.e,m.f)}),"px, ","px)","deg)"),interpolateTransformSvg=interpolateTransform((function parseSvg(value){return null==value?identity:(svgNode||(svgNode=document.createElementNS("http://www.w3.org/2000/svg","g")),svgNode.setAttribute("transform",value),(value=svgNode.transform.baseVal.consolidate())?decompose((value=value.matrix).a,value.b,value.c,value.d,value.e,value.f):identity)}),", ",")",")");function tweenRemove(id,name){var tween0,tween1;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0)for(var i=0,n=(tween1=tween0=tween).length;i<n;++i)if(tween1[i].name===name){(tween1=tween1.slice()).splice(i,1);break}schedule.tween=tween1}}function tweenFunction(id,name,value){var tween0,tween1;if("function"!=typeof value)throw new Error;return function(){var schedule=schedule_set(this,id),tween=schedule.tween;if(tween!==tween0){tween1=(tween0=tween).slice();for(var t={name,value},i=0,n=tween1.length;i<n;++i)if(tween1[i].name===name){tween1[i]=t;break}i===n&&tween1.push(t)}schedule.tween=tween1}}function tweenValue(transition,name,value){var id=transition._id;return transition.each((function(){var schedule=schedule_set(this,id);(schedule.value||(schedule.value={}))[name]=value.apply(this,arguments)})),function(node){return schedule_get(node,id).value[name]}}function src_define(constructor,factory,prototype){constructor.prototype=factory.prototype=prototype,prototype.constructor=constructor}function extend(parent,definition){var prototype=Object.create(parent.prototype);for(var key in definition)prototype[key]=definition[key];return prototype}function Color(){}var brighter=1/.7,reI="\\s*([+-]?\\d+)\\s*",reN="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",reP="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",reHex=/^#([0-9a-f]{3,8})$/,reRgbInteger=new RegExp(`^rgb\\(${reI},${reI},${reI}\\)$`),reRgbPercent=new RegExp(`^rgb\\(${reP},${reP},${reP}\\)$`),reRgbaInteger=new RegExp(`^rgba\\(${reI},${reI},${reI},${reN}\\)$`),reRgbaPercent=new RegExp(`^rgba\\(${reP},${reP},${reP},${reN}\\)$`),reHslPercent=new RegExp(`^hsl\\(${reN},${reP},${reP}\\)$`),reHslaPercent=new RegExp(`^hsla\\(${reN},${reP},${reP},${reN}\\)$`),named={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};function color_formatHex(){return this.rgb().formatHex()}function color_formatRgb(){return this.rgb().formatRgb()}function color(format){var m,l;return format=(format+"").trim().toLowerCase(),(m=reHex.exec(format))?(l=m[1].length,m=parseInt(m[1],16),6===l?rgbn(m):3===l?new Rgb(m>>8&15|m>>4&240,m>>4&15|240&m,(15&m)<<4|15&m,1):8===l?rgba(m>>24&255,m>>16&255,m>>8&255,(255&m)/255):4===l?rgba(m>>12&15|m>>8&240,m>>8&15|m>>4&240,m>>4&15|240&m,((15&m)<<4|15&m)/255):null):(m=reRgbInteger.exec(format))?new Rgb(m[1],m[2],m[3],1):(m=reRgbPercent.exec(format))?new Rgb(255*m[1]/100,255*m[2]/100,255*m[3]/100,1):(m=reRgbaInteger.exec(format))?rgba(m[1],m[2],m[3],m[4]):(m=reRgbaPercent.exec(format))?rgba(255*m[1]/100,255*m[2]/100,255*m[3]/100,m[4]):(m=reHslPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,1):(m=reHslaPercent.exec(format))?hsla(m[1],m[2]/100,m[3]/100,m[4]):named.hasOwnProperty(format)?rgbn(named[format]):"transparent"===format?new Rgb(NaN,NaN,NaN,0):null}function rgbn(n){return new Rgb(n>>16&255,n>>8&255,255&n,1)}function rgba(r,g,b,a){return a<=0&&(r=g=b=NaN),new Rgb(r,g,b,a)}function color_rgb(r,g,b,opacity){return 1===arguments.length?function rgbConvert(o){return o instanceof Color||(o=color(o)),o?new Rgb((o=o.rgb()).r,o.g,o.b,o.opacity):new Rgb}(r):new Rgb(r,g,b,null==opacity?1:opacity)}function Rgb(r,g,b,opacity){this.r=+r,this.g=+g,this.b=+b,this.opacity=+opacity}function rgb_formatHex(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}`}function rgb_formatRgb(){const a=clampa(this.opacity);return`${1===a?"rgb(":"rgba("}${clampi(this.r)}, ${clampi(this.g)}, ${clampi(this.b)}${1===a?")":`, ${a})`}`}function clampa(opacity){return isNaN(opacity)?1:Math.max(0,Math.min(1,opacity))}function clampi(value){return Math.max(0,Math.min(255,Math.round(value)||0))}function hex(value){return((value=clampi(value))<16?"0":"")+value.toString(16)}function hsla(h,s,l,a){return a<=0?h=s=l=NaN:l<=0||l>=1?h=s=NaN:s<=0&&(h=NaN),new Hsl(h,s,l,a)}function hslConvert(o){if(o instanceof Hsl)return new Hsl(o.h,o.s,o.l,o.opacity);if(o instanceof Color||(o=color(o)),!o)return new Hsl;if(o instanceof Hsl)return o;var r=(o=o.rgb()).r/255,g=o.g/255,b=o.b/255,min=Math.min(r,g,b),max=Math.max(r,g,b),h=NaN,s=max-min,l=(max+min)/2;return s?(h=r===max?(g-b)/s+6*(g<b):g===max?(b-r)/s+2:(r-g)/s+4,s/=l<.5?max+min:2-max-min,h*=60):s=l>0&&l<1?0:h,new Hsl(h,s,l,o.opacity)}function Hsl(h,s,l,opacity){this.h=+h,this.s=+s,this.l=+l,this.opacity=+opacity}function clamph(value){return(value=(value||0)%360)<0?value+360:value}function clampt(value){return Math.max(0,Math.min(1,value||0))}function hsl2rgb(h,m1,m2){return 255*(h<60?m1+(m2-m1)*h/60:h<180?m2:h<240?m1+(m2-m1)*(240-h)/60:m1)}function basis(t1,v0,v1,v2,v3){var t2=t1*t1,t3=t2*t1;return((1-3*t1+3*t2-t3)*v0+(4-6*t2+3*t3)*v1+(1+3*t1+3*t2-3*t3)*v2+t3*v3)/6}src_define(Color,color,{copy(channels){return Object.assign(new this.constructor,this,channels)},displayable(){return this.rgb().displayable()},hex:color_formatHex,formatHex:color_formatHex,formatHex8:function color_formatHex8(){return this.rgb().formatHex8()},formatHsl:function color_formatHsl(){return hslConvert(this).formatHsl()},formatRgb:color_formatRgb,toString:color_formatRgb}),src_define(Rgb,color_rgb,extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Rgb(this.r*k,this.g*k,this.b*k,this.opacity)},rgb(){return this},clamp(){return new Rgb(clampi(this.r),clampi(this.g),clampi(this.b),clampa(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:rgb_formatHex,formatHex:rgb_formatHex,formatHex8:function rgb_formatHex8(){return`#${hex(this.r)}${hex(this.g)}${hex(this.b)}${hex(255*(isNaN(this.opacity)?1:this.opacity))}`},formatRgb:rgb_formatRgb,toString:rgb_formatRgb})),src_define(Hsl,(function hsl(h,s,l,opacity){return 1===arguments.length?hslConvert(h):new Hsl(h,s,l,null==opacity?1:opacity)}),extend(Color,{brighter(k){return k=null==k?brighter:Math.pow(brighter,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},darker(k){return k=null==k?.7:Math.pow(.7,k),new Hsl(this.h,this.s,this.l*k,this.opacity)},rgb(){var h=this.h%360+360*(this.h<0),s=isNaN(h)||isNaN(this.s)?0:this.s,l=this.l,m2=l+(l<.5?l:1-l)*s,m1=2*l-m2;return new Rgb(hsl2rgb(h>=240?h-240:h+120,m1,m2),hsl2rgb(h,m1,m2),hsl2rgb(h<120?h+240:h-120,m1,m2),this.opacity)},clamp(){return new Hsl(clamph(this.h),clampt(this.s),clampt(this.l),clampa(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const a=clampa(this.opacity);return`${1===a?"hsl(":"hsla("}${clamph(this.h)}, ${100*clampt(this.s)}%, ${100*clampt(this.l)}%${1===a?")":`, ${a})`}`}}));const d3_interpolate_src_constant=x=>()=>x;function linear(a,d){return function(t){return a+t*d}}function gamma(y){return 1==(y=+y)?nogamma:function(a,b){return b-a?function exponential(a,b,y){return a=Math.pow(a,y),b=Math.pow(b,y)-a,y=1/y,function(t){return Math.pow(a+t*b,y)}}(a,b,y):d3_interpolate_src_constant(isNaN(a)?b:a)}}function nogamma(a,b){var d=b-a;return d?linear(a,d):d3_interpolate_src_constant(isNaN(a)?b:a)}const rgb=function rgbGamma(y){var color=gamma(y);function rgb(start,end){var r=color((start=color_rgb(start)).r,(end=color_rgb(end)).r),g=color(start.g,end.g),b=color(start.b,end.b),opacity=nogamma(start.opacity,end.opacity);return function(t){return start.r=r(t),start.g=g(t),start.b=b(t),start.opacity=opacity(t),start+""}}return rgb.gamma=rgbGamma,rgb}(1);function rgbSpline(spline){return function(colors){var i,color,n=colors.length,r=new Array(n),g=new Array(n),b=new Array(n);for(i=0;i<n;++i)color=color_rgb(colors[i]),r[i]=color.r||0,g[i]=color.g||0,b[i]=color.b||0;return r=spline(r),g=spline(g),b=spline(b),color.opacity=1,function(t){return color.r=r(t),color.g=g(t),color.b=b(t),color+""}}}rgbSpline((function src_basis(values){var n=values.length-1;return function(t){var i=t<=0?t=0:t>=1?(t=1,n-1):Math.floor(t*n),v1=values[i],v2=values[i+1],v0=i>0?values[i-1]:2*v1-v2,v3=i<n-1?values[i+2]:2*v2-v1;return basis((t-i/n)*n,v0,v1,v2,v3)}})),rgbSpline((function basisClosed(values){var n=values.length;return function(t){var i=Math.floor(((t%=1)<0?++t:t)*n),v0=values[(i+n-1)%n],v1=values[i%n],v2=values[(i+1)%n],v3=values[(i+2)%n];return basis((t-i/n)*n,v0,v1,v2,v3)}}));var reA=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,reB=new RegExp(reA.source,"g");function string(a,b){var am,bm,bs,bi=reA.lastIndex=reB.lastIndex=0,i=-1,s=[],q=[];for(a+="",b+="";(am=reA.exec(a))&&(bm=reB.exec(b));)(bs=bm.index)>bi&&(bs=b.slice(bi,bs),s[i]?s[i]+=bs:s[++i]=bs),(am=am[0])===(bm=bm[0])?s[i]?s[i]+=bm:s[++i]=bm:(s[++i]=null,q.push({i,x:number(am,bm)})),bi=reB.lastIndex;return bi<b.length&&(bs=b.slice(bi),s[i]?s[i]+=bs:s[++i]=bs),s.length<2?q[0]?function one(b){return function(t){return b(t)+""}}(q[0].x):function zero(b){return function(){return b}}(b):(b=q.length,function(t){for(var o,i=0;i<b;++i)s[(o=q[i]).i]=o.x(t);return s.join("")})}function interpolate(a,b){var c;return("number"==typeof b?number:b instanceof color?rgb:(c=color(b))?(b=c,rgb):string)(a,b)}function attr_attrRemove(name){return function(){this.removeAttribute(name)}}function attr_attrRemoveNS(fullname){return function(){this.removeAttributeNS(fullname.space,fullname.local)}}function attr_attrConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttribute(name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrConstantNS(fullname,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=this.getAttributeNS(fullname.space,fullname.local);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}function attr_attrFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttribute(name))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttribute(name)}}function attr_attrFunctionNS(fullname,interpolate,value){var string00,string10,interpolate0;return function(){var string0,string1,value1=value(this);if(null!=value1)return(string0=this.getAttributeNS(fullname.space,fullname.local))===(string1=value1+"")?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1));this.removeAttributeNS(fullname.space,fullname.local)}}function attrTweenNS(fullname,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolateNS(fullname,i){return function(t){this.setAttributeNS(fullname.space,fullname.local,i.call(this,t))}}(fullname,i)),t0}return tween._value=value,tween}function attrTween(name,value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function attrInterpolate(name,i){return function(t){this.setAttribute(name,i.call(this,t))}}(name,i)),t0}return tween._value=value,tween}function delayFunction(id,value){return function(){init(this,id).delay=+value.apply(this,arguments)}}function delayConstant(id,value){return value=+value,function(){init(this,id).delay=value}}function durationFunction(id,value){return function(){schedule_set(this,id).duration=+value.apply(this,arguments)}}function durationConstant(id,value){return value=+value,function(){schedule_set(this,id).duration=value}}var selection_Selection=src_selection.prototype.constructor;function style_styleRemove(name){return function(){this.style.removeProperty(name)}}var id=0;function Transition(groups,parents,name,id){this._groups=groups,this._parents=parents,this._name=name,this._id=id}function newId(){return++id}var selection_prototype=src_selection.prototype;Transition.prototype=function transition_transition(name){return src_selection().transition(name)}.prototype={constructor:Transition,select:function transition_select(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selector(select));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,subnode,group=groups[j],n=group.length,subgroup=subgroups[j]=new Array(n),i=0;i<n;++i)(node=group[i])&&(subnode=select.call(node,node.__data__,i,group))&&("__data__"in node&&(subnode.__data__=node.__data__),subgroup[i]=subnode,schedule(subgroup[i],name,id,i,subgroup,schedule_get(node,id)));return new Transition(subgroups,this._parents,name,id)},selectAll:function transition_selectAll(select){var name=this._name,id=this._id;"function"!=typeof select&&(select=selectorAll(select));for(var groups=this._groups,m=groups.length,subgroups=[],parents=[],j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){for(var child,children=select.call(node,node.__data__,i,group),inherit=schedule_get(node,id),k=0,l=children.length;k<l;++k)(child=children[k])&&schedule(child,name,id,k,children,inherit);subgroups.push(children),parents.push(node)}return new Transition(subgroups,parents,name,id)},selectChild:selection_prototype.selectChild,selectChildren:selection_prototype.selectChildren,filter:function transition_filter(match){"function"!=typeof match&&(match=matcher(match));for(var groups=this._groups,m=groups.length,subgroups=new Array(m),j=0;j<m;++j)for(var node,group=groups[j],n=group.length,subgroup=subgroups[j]=[],i=0;i<n;++i)(node=group[i])&&match.call(node,node.__data__,i,group)&&subgroup.push(node);return new Transition(subgroups,this._parents,this._name,this._id)},merge:function transition_merge(transition){if(transition._id!==this._id)throw new Error;for(var groups0=this._groups,groups1=transition._groups,m0=groups0.length,m1=groups1.length,m=Math.min(m0,m1),merges=new Array(m0),j=0;j<m;++j)for(var node,group0=groups0[j],group1=groups1[j],n=group0.length,merge=merges[j]=new Array(n),i=0;i<n;++i)(node=group0[i]||group1[i])&&(merge[i]=node);for(;j<m0;++j)merges[j]=groups0[j];return new Transition(merges,this._parents,this._name,this._id)},selection:function transition_selection(){return new selection_Selection(this._groups,this._parents)},transition:function transition(){for(var name=this._name,id0=this._id,id1=newId(),groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)if(node=group[i]){var inherit=schedule_get(node,id0);schedule(node,name,id1,i,group,{time:inherit.time+inherit.delay+inherit.duration,delay:0,duration:inherit.duration,ease:inherit.ease})}return new Transition(groups,this._parents,name,id1)},call:selection_prototype.call,nodes:selection_prototype.nodes,node:selection_prototype.node,size:selection_prototype.size,empty:selection_prototype.empty,each:selection_prototype.each,on:function transition_on(name,listener){var id=this._id;return arguments.length<2?schedule_get(this.node(),id).on.on(name):this.each(function onFunction(id,name,listener){var on0,on1,sit=function start(name){return(name+"").trim().split(/^|\s+/).every((function(t){var i=t.indexOf(".");return i>=0&&(t=t.slice(0,i)),!t||"start"===t}))}(name)?init:schedule_set;return function(){var schedule=sit(this,id),on=schedule.on;on!==on0&&(on1=(on0=on).copy()).on(name,listener),schedule.on=on1}}(id,name,listener))},attr:function transition_attr(name,value){var fullname=namespace(name),i="transform"===fullname?interpolateTransformSvg:interpolate;return this.attrTween(name,"function"==typeof value?(fullname.local?attr_attrFunctionNS:attr_attrFunction)(fullname,i,tweenValue(this,"attr."+name,value)):null==value?(fullname.local?attr_attrRemoveNS:attr_attrRemove)(fullname):(fullname.local?attr_attrConstantNS:attr_attrConstant)(fullname,i,value))},attrTween:function transition_attrTween(name,value){var key="attr."+name;if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;var fullname=namespace(name);return this.tween(key,(fullname.local?attrTweenNS:attrTween)(fullname,value))},style:function transition_style(name,value,priority){var i="transform"==(name+="")?interpolateTransformCss:interpolate;return null==value?this.styleTween(name,function styleNull(name,interpolate){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),string1=(this.style.removeProperty(name),styleValue(this,name));return string0===string1?null:string0===string00&&string1===string10?interpolate0:interpolate0=interpolate(string00=string0,string10=string1)}}(name,i)).on("end.style."+name,style_styleRemove(name)):"function"==typeof value?this.styleTween(name,function style_styleFunction(name,interpolate,value){var string00,string10,interpolate0;return function(){var string0=styleValue(this,name),value1=value(this),string1=value1+"";return null==value1&&(this.style.removeProperty(name),string1=value1=styleValue(this,name)),string0===string1?null:string0===string00&&string1===string10?interpolate0:(string10=string1,interpolate0=interpolate(string00=string0,value1))}}(name,i,tweenValue(this,"style."+name,value))).each(function styleMaybeRemove(id,name){var on0,on1,listener0,remove,key="style."+name,event="end."+key;return function(){var schedule=schedule_set(this,id),on=schedule.on,listener=null==schedule.value[key]?remove||(remove=style_styleRemove(name)):void 0;on===on0&&listener0===listener||(on1=(on0=on).copy()).on(event,listener0=listener),schedule.on=on1}}(this._id,name)):this.styleTween(name,function style_styleConstant(name,interpolate,value1){var string00,interpolate0,string1=value1+"";return function(){var string0=styleValue(this,name);return string0===string1?null:string0===string00?interpolate0:interpolate0=interpolate(string00=string0,value1)}}(name,i,value),priority).on("end.style."+name,null)},styleTween:function transition_styleTween(name,value,priority){var key="style."+(name+="");if(arguments.length<2)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function styleTween(name,value,priority){var t,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t=(i0=i)&&function styleInterpolate(name,i,priority){return function(t){this.style.setProperty(name,i.call(this,t),priority)}}(name,i,priority)),t}return tween._value=value,tween}(name,value,null==priority?"":priority))},text:function transition_text(value){return this.tween("text","function"==typeof value?function text_textFunction(value){return function(){var value1=value(this);this.textContent=null==value1?"":value1}}(tweenValue(this,"text",value)):function text_textConstant(value){return function(){this.textContent=value}}(null==value?"":value+""))},textTween:function transition_textTween(value){var key="text";if(arguments.length<1)return(key=this.tween(key))&&key._value;if(null==value)return this.tween(key,null);if("function"!=typeof value)throw new Error;return this.tween(key,function textTween(value){var t0,i0;function tween(){var i=value.apply(this,arguments);return i!==i0&&(t0=(i0=i)&&function textInterpolate(i){return function(t){this.textContent=i.call(this,t)}}(i)),t0}return tween._value=value,tween}(value))},remove:function transition_remove(){return this.on("end.remove",function removeFunction(id){return function(){var parent=this.parentNode;for(var i in this.__transition)if(+i!==id)return;parent&&parent.removeChild(this)}}(this._id))},tween:function tween(name,value){var id=this._id;if(name+="",arguments.length<2){for(var t,tween=schedule_get(this.node(),id).tween,i=0,n=tween.length;i<n;++i)if((t=tween[i]).name===name)return t.value;return null}return this.each((null==value?tweenRemove:tweenFunction)(id,name,value))},delay:function delay(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?delayFunction:delayConstant)(id,value)):schedule_get(this.node(),id).delay},duration:function duration(value){var id=this._id;return arguments.length?this.each(("function"==typeof value?durationFunction:durationConstant)(id,value)):schedule_get(this.node(),id).duration},ease:function ease(value){var id=this._id;return arguments.length?this.each(function easeConstant(id,value){if("function"!=typeof value)throw new Error;return function(){schedule_set(this,id).ease=value}}(id,value)):schedule_get(this.node(),id).ease},easeVarying:function transition_easeVarying(value){if("function"!=typeof value)throw new Error;return this.each(function easeVarying(id,value){return function(){var v=value.apply(this,arguments);if("function"!=typeof v)throw new Error;schedule_set(this,id).ease=v}}(this._id,value))},end:function end(){var on0,on1,that=this,id=that._id,size=that.size();return new Promise((function(resolve,reject){var cancel={value:reject},end={value:function(){0==--size&&resolve()}};that.each((function(){var schedule=schedule_set(this,id),on=schedule.on;on!==on0&&((on1=(on0=on).copy())._.cancel.push(cancel),on1._.interrupt.push(cancel),on1._.end.push(end)),schedule.on=on1})),0===size&&resolve()}))},[Symbol.iterator]:selection_prototype[Symbol.iterator]};var defaultTiming={time:null,delay:0,duration:250,ease:function cubicInOut(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}};function inherit(node,id){for(var timing;!(timing=node.__transition)||!(timing=timing[id]);)if(!(node=node.parentNode))throw new Error(`transition ${id} not found`);return timing}src_selection.prototype.interrupt=function selection_interrupt(name){return this.each((function(){interrupt(this,name)}))},src_selection.prototype.transition=function selection_transition(name){var id,timing;name instanceof Transition?(id=name._id,name=name._name):(id=newId(),(timing=defaultTiming).time=now(),name=null==name?null:name+"");for(var groups=this._groups,m=groups.length,j=0;j<m;++j)for(var node,group=groups[j],n=group.length,i=0;i<n;++i)(node=group[i])&&schedule(node,name,id,i,group,timing||inherit(node,id));return new Transition(groups,this._parents,name,id)};const d3_zoom_src_constant=x=>()=>x;function ZoomEvent(type,{sourceEvent,target,transform,dispatch}){Object.defineProperties(this,{type:{value:type,enumerable:!0,configurable:!0},sourceEvent:{value:sourceEvent,enumerable:!0,configurable:!0},target:{value:target,enumerable:!0,configurable:!0},transform:{value:transform,enumerable:!0,configurable:!0},_:{value:dispatch}})}function Transform(k,x,y){this.k=k,this.x=x,this.y=y}Transform.prototype={constructor:Transform,scale:function(k){return 1===k?this:new Transform(this.k*k,this.x,this.y)},translate:function(x,y){return 0===x&0===y?this:new Transform(this.k,this.x+this.k*x,this.y+this.k*y)},apply:function(point){return[point[0]*this.k+this.x,point[1]*this.k+this.y]},applyX:function(x){return x*this.k+this.x},applyY:function(y){return y*this.k+this.y},invert:function(location){return[(location[0]-this.x)/this.k,(location[1]-this.y)/this.k]},invertX:function(x){return(x-this.x)/this.k},invertY:function(y){return(y-this.y)/this.k},rescaleX:function(x){return x.copy().domain(x.range().map(this.invertX,this).map(x.invert,x))},rescaleY:function(y){return y.copy().domain(y.range().map(this.invertY,this).map(y.invert,y))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var transform_identity=new Transform(1,0,0);function noevent_nopropagation(event){event.stopImmediatePropagation()}function src_noevent(event){event.preventDefault(),event.stopImmediatePropagation()}function defaultFilter(event){return!(event.ctrlKey&&"wheel"!==event.type||event.button)}function defaultExtent(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e).hasAttribute("viewBox")?[[(e=e.viewBox.baseVal).x,e.y],[e.x+e.width,e.y+e.height]]:[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]:[[0,0],[e.clientWidth,e.clientHeight]]}function defaultTransform(){return this.__zoom||transform_identity}function defaultWheelDelta(event){return-event.deltaY*(1===event.deltaMode?.05:event.deltaMode?1:.002)*(event.ctrlKey?10:1)}function defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}function defaultConstrain(transform,extent,translateExtent){var dx0=transform.invertX(extent[0][0])-translateExtent[0][0],dx1=transform.invertX(extent[1][0])-translateExtent[1][0],dy0=transform.invertY(extent[0][1])-translateExtent[0][1],dy1=transform.invertY(extent[1][1])-translateExtent[1][1];return transform.translate(dx1>dx0?(dx0+dx1)/2:Math.min(0,dx0)||Math.max(0,dx1),dy1>dy0?(dy0+dy1)/2:Math.min(0,dy0)||Math.max(0,dy1))}Transform.prototype;const d3_drag_src_constant=x=>()=>x;function DragEvent(type,{sourceEvent,subject,target,identifier,active,x,y,dx,dy,dispatch}){Object.defineProperties(this,{type:{value:type,enumerable:!0,configurable:!0},sourceEvent:{value:sourceEvent,enumerable:!0,configurable:!0},subject:{value:subject,enumerable:!0,configurable:!0},target:{value:target,enumerable:!0,configurable:!0},identifier:{value:identifier,enumerable:!0,configurable:!0},active:{value:active,enumerable:!0,configurable:!0},x:{value:x,enumerable:!0,configurable:!0},y:{value:y,enumerable:!0,configurable:!0},dx:{value:dx,enumerable:!0,configurable:!0},dy:{value:dy,enumerable:!0,configurable:!0},_:{value:dispatch}})}function drag_defaultFilter(event){return!event.ctrlKey&&!event.button}function defaultContainer(){return this.parentNode}function defaultSubject(event,d){return null==d?{x:event.x,y:event.y}:d}function drag_defaultTouchable(){return navigator.maxTouchPoints||"ontouchstart"in this}DragEvent.prototype.on=function(){var value=this._.on.apply(this._,arguments);return value===this._?this:value};__webpack_require__("./node_modules/react-dom/index.js");const StoreContext=(0,react.createContext)(null),Provider$1=StoreContext.Provider,errorMessages={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:nodeType=>`Node type "${nodeType}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:id=>`The old edge with id=${id} does not exist.`,error009:type=>`Marker type "${type}" doesn't exist.`,error008:(sourceHandle,edge)=>`Couldn't create edge for ${sourceHandle?"target":"source"} handle id: "${sourceHandle?edge.targetHandle:edge.sourceHandle}", edge id: ${edge.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:edgeType=>`Edge type "${edgeType}" not found. Using fallback type "default".`,error012:id=>`Node with id "${id}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},zustandErrorMessage=errorMessages.error001();function useStore(selector,equalityFn){const store=(0,react.useContext)(StoreContext);if(null===store)throw new Error(zustandErrorMessage);return useStoreWithEqualityFn(store,selector,equalityFn)}const useStoreApi=()=>{const store=(0,react.useContext)(StoreContext);if(null===store)throw new Error(zustandErrorMessage);return(0,react.useMemo)((()=>({getState:store.getState,setState:store.setState,subscribe:store.subscribe,destroy:store.destroy})),[store])},selector$g=s=>s.userSelectionActive?"none":"all";function Panel({position,children,className,style,...rest}){const pointerEvents=useStore(selector$g),positionClasses=`${position}`.split("-");return(0,jsx_runtime.jsx)("div",{className:cc(["react-flow__panel",className,...positionClasses]),style:{...style,pointerEvents},...rest,children})}function Attribution({proOptions,position="bottom-right"}){return proOptions?.hideAttribution?null:(0,jsx_runtime.jsx)(Panel,{position,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:(0,jsx_runtime.jsx)("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}var EdgeText$1=(0,react.memo)((({x,y,label,labelStyle={},labelShowBg=!0,labelBgStyle={},labelBgPadding=[2,4],labelBgBorderRadius=2,children,className,...rest})=>{const edgeRef=(0,react.useRef)(null),[edgeTextBbox,setEdgeTextBbox]=(0,react.useState)({x:0,y:0,width:0,height:0}),edgeTextClasses=cc(["react-flow__edge-textwrapper",className]);return(0,react.useEffect)((()=>{if(edgeRef.current){const textBbox=edgeRef.current.getBBox();setEdgeTextBbox({x:textBbox.x,y:textBbox.y,width:textBbox.width,height:textBbox.height})}}),[label]),void 0!==label&&label?(0,jsx_runtime.jsxs)("g",{transform:`translate(${x-edgeTextBbox.width/2} ${y-edgeTextBbox.height/2})`,className:edgeTextClasses,visibility:edgeTextBbox.width?"visible":"hidden",...rest,children:[labelShowBg&&(0,jsx_runtime.jsx)("rect",{width:edgeTextBbox.width+2*labelBgPadding[0],x:-labelBgPadding[0],y:-labelBgPadding[1],height:edgeTextBbox.height+2*labelBgPadding[1],className:"react-flow__edge-textbg",style:labelBgStyle,rx:labelBgBorderRadius,ry:labelBgBorderRadius}),(0,jsx_runtime.jsx)("text",{className:"react-flow__edge-text",y:edgeTextBbox.height/2,dy:"0.3em",ref:edgeRef,style:labelStyle,children:label}),children]}):null}));const getDimensions=node=>({width:node.offsetWidth,height:node.offsetHeight}),clamp=(val,min=0,max=1)=>Math.min(Math.max(val,min),max),clampPosition=(position={x:0,y:0},extent)=>({x:clamp(position.x,extent[0][0],extent[1][0]),y:clamp(position.y,extent[0][1],extent[1][1])}),calcAutoPanVelocity=(value,min,max)=>value<min?clamp(Math.abs(value-min),1,50)/50:value>max?-clamp(Math.abs(value-max),1,50)/50:0,calcAutoPan=(pos,bounds)=>[20*calcAutoPanVelocity(pos.x,35,bounds.width-35),20*calcAutoPanVelocity(pos.y,35,bounds.height-35)],getHostForElement=element=>element.getRootNode?.()||window?.document,getBoundsOfBoxes=(box1,box2)=>({x:Math.min(box1.x,box2.x),y:Math.min(box1.y,box2.y),x2:Math.max(box1.x2,box2.x2),y2:Math.max(box1.y2,box2.y2)}),rectToBox=({x,y,width,height})=>({x,y,x2:x+width,y2:y+height}),boxToRect=({x,y,x2,y2})=>({x,y,width:x2-x,height:y2-y}),nodeToRect=node=>({...node.positionAbsolute||{x:0,y:0},width:node.width||0,height:node.height||0}),getOverlappingArea=(rectA,rectB)=>{const xOverlap=Math.max(0,Math.min(rectA.x+rectA.width,rectB.x+rectB.width)-Math.max(rectA.x,rectB.x)),yOverlap=Math.max(0,Math.min(rectA.y+rectA.height,rectB.y+rectB.height)-Math.max(rectA.y,rectB.y));return Math.ceil(xOverlap*yOverlap)},isRectObject=obj=>isNumeric(obj.width)&&isNumeric(obj.height)&&isNumeric(obj.x)&&isNumeric(obj.y),isNumeric=n=>!isNaN(n)&&isFinite(n),internalsSymbol=Symbol.for("internals"),elementSelectionKeys=["Enter"," ","Escape"],devWarn=(id,message)=>{0};function isInputDOMNode(event){const kbEvent=(event=>"nativeEvent"in event)(event)?event.nativeEvent:event,target=kbEvent.composedPath?.()?.[0]||event.target;return["INPUT","SELECT","TEXTAREA"].includes(target?.nodeName)||target?.hasAttribute("contenteditable")||!!target?.closest(".nokey")}const isMouseEvent=event=>"clientX"in event,getEventPosition=(event,bounds)=>{const isMouseTriggered=isMouseEvent(event),evtX=isMouseTriggered?event.clientX:event.touches?.[0].clientX,evtY=isMouseTriggered?event.clientY:event.touches?.[0].clientY;return{x:evtX-(bounds?.left??0),y:evtY-(bounds?.top??0)}},isMacOs=()=>"undefined"!=typeof navigator&&navigator?.userAgent?.indexOf("Mac")>=0,BaseEdge=({id,path,labelX,labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth=20})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)("path",{id,style,d:path,fill:"none",className:"react-flow__edge-path",markerEnd,markerStart}),interactionWidth&&(0,jsx_runtime.jsx)("path",{d:path,fill:"none",strokeOpacity:0,strokeWidth:interactionWidth,className:"react-flow__edge-interaction"}),label&&isNumeric(labelX)&&isNumeric(labelY)?(0,jsx_runtime.jsx)(EdgeText$1,{x:labelX,y:labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius}):null]});BaseEdge.displayName="BaseEdge";function getMouseHandler$1(id,getState,handler){return void 0===handler?handler:event=>{const edge=getState().edges.find((e=>e.id===id));edge&&handler(event,{...edge})}}function getEdgeCenter({sourceX,sourceY,targetX,targetY}){const xOffset=Math.abs(targetX-sourceX)/2,centerX=targetX<sourceX?targetX+xOffset:targetX-xOffset,yOffset=Math.abs(targetY-sourceY)/2;return[centerX,targetY<sourceY?targetY+yOffset:targetY-yOffset,xOffset,yOffset]}function getBezierEdgeCenter({sourceX,sourceY,targetX,targetY,sourceControlX,sourceControlY,targetControlX,targetControlY}){const centerX=.125*sourceX+.375*sourceControlX+.375*targetControlX+.125*targetX,centerY=.125*sourceY+.375*sourceControlY+.375*targetControlY+.125*targetY;return[centerX,centerY,Math.abs(centerX-sourceX),Math.abs(centerY-sourceY)]}var ConnectionMode,PanOnScrollMode,SelectionMode,ConnectionLineType,MarkerType,Position;function getControl({pos,x1,y1,x2,y2}){return pos===Position.Left||pos===Position.Right?[.5*(x1+x2),y1]:[x1,.5*(y1+y2)]}function getSimpleBezierPath({sourceX,sourceY,sourcePosition=Position.Bottom,targetX,targetY,targetPosition=Position.Top}){const[sourceControlX,sourceControlY]=getControl({pos:sourcePosition,x1:sourceX,y1:sourceY,x2:targetX,y2:targetY}),[targetControlX,targetControlY]=getControl({pos:targetPosition,x1:targetX,y1:targetY,x2:sourceX,y2:sourceY}),[labelX,labelY,offsetX,offsetY]=getBezierEdgeCenter({sourceX,sourceY,targetX,targetY,sourceControlX,sourceControlY,targetControlX,targetControlY});return[`M${sourceX},${sourceY} C${sourceControlX},${sourceControlY} ${targetControlX},${targetControlY} ${targetX},${targetY}`,labelX,labelY,offsetX,offsetY]}!function(ConnectionMode){ConnectionMode.Strict="strict",ConnectionMode.Loose="loose"}(ConnectionMode||(ConnectionMode={})),function(PanOnScrollMode){PanOnScrollMode.Free="free",PanOnScrollMode.Vertical="vertical",PanOnScrollMode.Horizontal="horizontal"}(PanOnScrollMode||(PanOnScrollMode={})),function(SelectionMode){SelectionMode.Partial="partial",SelectionMode.Full="full"}(SelectionMode||(SelectionMode={})),function(ConnectionLineType){ConnectionLineType.Bezier="default",ConnectionLineType.Straight="straight",ConnectionLineType.Step="step",ConnectionLineType.SmoothStep="smoothstep",ConnectionLineType.SimpleBezier="simplebezier"}(ConnectionLineType||(ConnectionLineType={})),function(MarkerType){MarkerType.Arrow="arrow",MarkerType.ArrowClosed="arrowclosed"}(MarkerType||(MarkerType={})),function(Position){Position.Left="left",Position.Top="top",Position.Right="right",Position.Bottom="bottom"}(Position||(Position={}));const SimpleBezierEdge=(0,react.memo)((({sourceX,sourceY,targetX,targetY,sourcePosition=Position.Bottom,targetPosition=Position.Top,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})=>{const[path,labelX,labelY]=getSimpleBezierPath({sourceX,sourceY,sourcePosition,targetX,targetY,targetPosition});return(0,jsx_runtime.jsx)(BaseEdge,{path,labelX,labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})}));SimpleBezierEdge.displayName="SimpleBezierEdge";const handleDirections={[Position.Left]:{x:-1,y:0},[Position.Right]:{x:1,y:0},[Position.Top]:{x:0,y:-1},[Position.Bottom]:{x:0,y:1}},getDirection=({source,sourcePosition=Position.Bottom,target})=>sourcePosition===Position.Left||sourcePosition===Position.Right?source.x<target.x?{x:1,y:0}:{x:-1,y:0}:source.y<target.y?{x:0,y:1}:{x:0,y:-1},distance=(a,b)=>Math.sqrt(Math.pow(b.x-a.x,2)+Math.pow(b.y-a.y,2));function getSmoothStepPath({sourceX,sourceY,sourcePosition=Position.Bottom,targetX,targetY,targetPosition=Position.Top,borderRadius=5,centerX,centerY,offset=20}){const[points,labelX,labelY,offsetX,offsetY]=function getPoints({source,sourcePosition=Position.Bottom,target,targetPosition=Position.Top,center,offset}){const sourceDir=handleDirections[sourcePosition],targetDir=handleDirections[targetPosition],sourceGapped={x:source.x+sourceDir.x*offset,y:source.y+sourceDir.y*offset},targetGapped={x:target.x+targetDir.x*offset,y:target.y+targetDir.y*offset},dir=getDirection({source:sourceGapped,sourcePosition,target:targetGapped}),dirAccessor=0!==dir.x?"x":"y",currDir=dir[dirAccessor];let centerX,centerY,points=[];const sourceGapOffset={x:0,y:0},targetGapOffset={x:0,y:0},[defaultCenterX,defaultCenterY,defaultOffsetX,defaultOffsetY]=getEdgeCenter({sourceX:source.x,sourceY:source.y,targetX:target.x,targetY:target.y});if(sourceDir[dirAccessor]*targetDir[dirAccessor]==-1){centerX=center.x||defaultCenterX,centerY=center.y||defaultCenterY;const verticalSplit=[{x:centerX,y:sourceGapped.y},{x:centerX,y:targetGapped.y}],horizontalSplit=[{x:sourceGapped.x,y:centerY},{x:targetGapped.x,y:centerY}];points=sourceDir[dirAccessor]===currDir?"x"===dirAccessor?verticalSplit:horizontalSplit:"x"===dirAccessor?horizontalSplit:verticalSplit}else{const sourceTarget=[{x:sourceGapped.x,y:targetGapped.y}],targetSource=[{x:targetGapped.x,y:sourceGapped.y}];if(points="x"===dirAccessor?sourceDir.x===currDir?targetSource:sourceTarget:sourceDir.y===currDir?sourceTarget:targetSource,sourcePosition===targetPosition){const diff=Math.abs(source[dirAccessor]-target[dirAccessor]);if(diff<=offset){const gapOffset=Math.min(offset-1,offset-diff);sourceDir[dirAccessor]===currDir?sourceGapOffset[dirAccessor]=(sourceGapped[dirAccessor]>source[dirAccessor]?-1:1)*gapOffset:targetGapOffset[dirAccessor]=(targetGapped[dirAccessor]>target[dirAccessor]?-1:1)*gapOffset}}if(sourcePosition!==targetPosition){const dirAccessorOpposite="x"===dirAccessor?"y":"x",isSameDir=sourceDir[dirAccessor]===targetDir[dirAccessorOpposite],sourceGtTargetOppo=sourceGapped[dirAccessorOpposite]>targetGapped[dirAccessorOpposite],sourceLtTargetOppo=sourceGapped[dirAccessorOpposite]<targetGapped[dirAccessorOpposite];(1===sourceDir[dirAccessor]&&(!isSameDir&&sourceGtTargetOppo||isSameDir&&sourceLtTargetOppo)||1!==sourceDir[dirAccessor]&&(!isSameDir&&sourceLtTargetOppo||isSameDir&&sourceGtTargetOppo))&&(points="x"===dirAccessor?sourceTarget:targetSource)}const sourceGapPoint={x:sourceGapped.x+sourceGapOffset.x,y:sourceGapped.y+sourceGapOffset.y},targetGapPoint={x:targetGapped.x+targetGapOffset.x,y:targetGapped.y+targetGapOffset.y};Math.max(Math.abs(sourceGapPoint.x-points[0].x),Math.abs(targetGapPoint.x-points[0].x))>=Math.max(Math.abs(sourceGapPoint.y-points[0].y),Math.abs(targetGapPoint.y-points[0].y))?(centerX=(sourceGapPoint.x+targetGapPoint.x)/2,centerY=points[0].y):(centerX=points[0].x,centerY=(sourceGapPoint.y+targetGapPoint.y)/2)}return[[source,{x:sourceGapped.x+sourceGapOffset.x,y:sourceGapped.y+sourceGapOffset.y},...points,{x:targetGapped.x+targetGapOffset.x,y:targetGapped.y+targetGapOffset.y},target],centerX,centerY,defaultOffsetX,defaultOffsetY]}({source:{x:sourceX,y:sourceY},sourcePosition,target:{x:targetX,y:targetY},targetPosition,center:{x:centerX,y:centerY},offset}),path=points.reduce(((res,p,i)=>{let segment="";return segment=i>0&&i<points.length-1?function getBend(a,b,c,size){const bendSize=Math.min(distance(a,b)/2,distance(b,c)/2,size),{x,y}=b;if(a.x===x&&x===c.x||a.y===y&&y===c.y)return`L${x} ${y}`;if(a.y===y)return`L ${x+bendSize*(a.x<c.x?-1:1)},${y}Q ${x},${y} ${x},${y+bendSize*(a.y<c.y?1:-1)}`;const xDir=a.x<c.x?1:-1;return`L ${x},${y+bendSize*(a.y<c.y?-1:1)}Q ${x},${y} ${x+bendSize*xDir},${y}`}(points[i-1],p,points[i+1],borderRadius):`${0===i?"M":"L"}${p.x} ${p.y}`,res+=segment}),"");return[path,labelX,labelY,offsetX,offsetY]}const SmoothStepEdge=(0,react.memo)((({sourceX,sourceY,targetX,targetY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,sourcePosition=Position.Bottom,targetPosition=Position.Top,markerEnd,markerStart,pathOptions,interactionWidth})=>{const[path,labelX,labelY]=getSmoothStepPath({sourceX,sourceY,sourcePosition,targetX,targetY,targetPosition,borderRadius:pathOptions?.borderRadius,offset:pathOptions?.offset});return(0,jsx_runtime.jsx)(BaseEdge,{path,labelX,labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})}));SmoothStepEdge.displayName="SmoothStepEdge";const StepEdge=(0,react.memo)((props=>(0,jsx_runtime.jsx)(SmoothStepEdge,{...props,pathOptions:(0,react.useMemo)((()=>({borderRadius:0,offset:props.pathOptions?.offset})),[props.pathOptions?.offset])})));StepEdge.displayName="StepEdge";const StraightEdge=(0,react.memo)((({sourceX,sourceY,targetX,targetY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})=>{const[path,labelX,labelY]=function getStraightPath({sourceX,sourceY,targetX,targetY}){const[labelX,labelY,offsetX,offsetY]=getEdgeCenter({sourceX,sourceY,targetX,targetY});return[`M ${sourceX},${sourceY}L ${targetX},${targetY}`,labelX,labelY,offsetX,offsetY]}({sourceX,sourceY,targetX,targetY});return(0,jsx_runtime.jsx)(BaseEdge,{path,labelX,labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})}));function calculateControlOffset(distance,curvature){return distance>=0?.5*distance:25*curvature*Math.sqrt(-distance)}function getControlWithCurvature({pos,x1,y1,x2,y2,c}){switch(pos){case Position.Left:return[x1-calculateControlOffset(x1-x2,c),y1];case Position.Right:return[x1+calculateControlOffset(x2-x1,c),y1];case Position.Top:return[x1,y1-calculateControlOffset(y1-y2,c)];case Position.Bottom:return[x1,y1+calculateControlOffset(y2-y1,c)]}}function getBezierPath({sourceX,sourceY,sourcePosition=Position.Bottom,targetX,targetY,targetPosition=Position.Top,curvature=.25}){const[sourceControlX,sourceControlY]=getControlWithCurvature({pos:sourcePosition,x1:sourceX,y1:sourceY,x2:targetX,y2:targetY,c:curvature}),[targetControlX,targetControlY]=getControlWithCurvature({pos:targetPosition,x1:targetX,y1:targetY,x2:sourceX,y2:sourceY,c:curvature}),[labelX,labelY,offsetX,offsetY]=getBezierEdgeCenter({sourceX,sourceY,targetX,targetY,sourceControlX,sourceControlY,targetControlX,targetControlY});return[`M${sourceX},${sourceY} C${sourceControlX},${sourceControlY} ${targetControlX},${targetControlY} ${targetX},${targetY}`,labelX,labelY,offsetX,offsetY]}StraightEdge.displayName="StraightEdge";const BezierEdge=(0,react.memo)((({sourceX,sourceY,targetX,targetY,sourcePosition=Position.Bottom,targetPosition=Position.Top,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,pathOptions,interactionWidth})=>{const[path,labelX,labelY]=getBezierPath({sourceX,sourceY,sourcePosition,targetX,targetY,targetPosition,curvature:pathOptions?.curvature});return(0,jsx_runtime.jsx)(BaseEdge,{path,labelX,labelY,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,markerEnd,markerStart,interactionWidth})}));BezierEdge.displayName="BezierEdge";const NodeIdContext=(0,react.createContext)(null),Provider=NodeIdContext.Provider;NodeIdContext.Consumer;const getEdgeId=({source,sourceHandle,target,targetHandle})=>`reactflow__edge-${source}${sourceHandle||""}-${target}${targetHandle||""}`,getMarkerId=(marker,rfId)=>{if(void 0===marker)return"";if("string"==typeof marker)return marker;return`${rfId?`${rfId}__`:""}${Object.keys(marker).sort().map((key=>`${key}=${marker[key]}`)).join("&")}`},pointToRendererPoint=({x,y},[tx,ty,tScale],snapToGrid,[snapX,snapY])=>{const position={x:(x-tx)/tScale,y:(y-ty)/tScale};return snapToGrid?{x:snapX*Math.round(position.x/snapX),y:snapY*Math.round(position.y/snapY)}:position},rendererPointToPoint=({x,y},[tx,ty,tScale])=>({x:x*tScale+tx,y:y*tScale+ty}),getNodePositionWithOrigin=(node,nodeOrigin=[0,0])=>{if(!node)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const offsetX=(node.width??0)*nodeOrigin[0],offsetY=(node.height??0)*nodeOrigin[1],position={x:node.position.x-offsetX,y:node.position.y-offsetY};return{...position,positionAbsolute:node.positionAbsolute?{x:node.positionAbsolute.x-offsetX,y:node.positionAbsolute.y-offsetY}:position}},getRectOfNodes=(nodes,nodeOrigin=[0,0])=>{if(0===nodes.length)return{x:0,y:0,width:0,height:0};const box=nodes.reduce(((currBox,node)=>{const{x,y}=getNodePositionWithOrigin(node,nodeOrigin).positionAbsolute;return getBoundsOfBoxes(currBox,rectToBox({x,y,width:node.width||0,height:node.height||0}))}),{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return boxToRect(box)},getNodesInside=(nodeInternals,rect,[tx,ty,tScale]=[0,0,1],partially=!1,excludeNonSelectableNodes=!1,nodeOrigin=[0,0])=>{const paneRect={x:(rect.x-tx)/tScale,y:(rect.y-ty)/tScale,width:rect.width/tScale,height:rect.height/tScale},visibleNodes=[];return nodeInternals.forEach((node=>{const{width,height,selectable=!0,hidden=!1}=node;if(excludeNonSelectableNodes&&!selectable||hidden)return!1;const{positionAbsolute}=getNodePositionWithOrigin(node,nodeOrigin),nodeRect={x:positionAbsolute.x,y:positionAbsolute.y,width:width||0,height:height||0},overlappingArea=getOverlappingArea(paneRect,nodeRect);(void 0===width||void 0===height||null===width||null===height||partially&&overlappingArea>0||overlappingArea>=(width||0)*(height||0)||node.dragging)&&visibleNodes.push(node)})),visibleNodes},getConnectedEdges=(nodes,edges)=>{const nodeIds=nodes.map((node=>node.id));return edges.filter((edge=>nodeIds.includes(edge.source)||nodeIds.includes(edge.target)))},getTransformForBounds=(bounds,width,height,minZoom,maxZoom,padding=.1)=>{const xZoom=width/(bounds.width*(1+padding)),yZoom=height/(bounds.height*(1+padding)),zoom=Math.min(xZoom,yZoom),clampedZoom=clamp(zoom,minZoom,maxZoom);return[width/2-(bounds.x+bounds.width/2)*clampedZoom,height/2-(bounds.y+bounds.height/2)*clampedZoom,clampedZoom]},getD3Transition=(selection,duration=0)=>selection.transition().duration(duration);function getHandles(node,handleBounds,type,currentHandle){return(handleBounds[type]||[]).reduce(((res,h)=>(`${node.id}-${h.id}-${type}`!==currentHandle&&res.push({id:h.id||null,type,nodeId:node.id,x:(node.positionAbsolute?.x??0)+h.x+h.width/2,y:(node.positionAbsolute?.y??0)+h.y+h.height/2}),res)),[])}const nullConnection={source:null,target:null,sourceHandle:null,targetHandle:null},defaultResult=()=>({handleDomNode:null,isValid:!1,connection:nullConnection,endHandle:null});function isValidHandle(handle,connectionMode,fromNodeId,fromHandleId,fromType,isValidConnection,doc){const isTarget="target"===fromType,handleToCheck=doc.querySelector(`.react-flow__handle[data-id="${handle?.nodeId}-${handle?.id}-${handle?.type}"]`),result={...defaultResult(),handleDomNode:handleToCheck};if(handleToCheck){const handleType=getHandleType(void 0,handleToCheck),handleNodeId=handleToCheck.getAttribute("data-nodeid"),handleId=handleToCheck.getAttribute("data-handleid"),connectable=handleToCheck.classList.contains("connectable"),connectableEnd=handleToCheck.classList.contains("connectableend"),connection={source:isTarget?handleNodeId:fromNodeId,sourceHandle:isTarget?handleId:fromHandleId,target:isTarget?fromNodeId:handleNodeId,targetHandle:isTarget?fromHandleId:handleId};result.connection=connection;connectable&&connectableEnd&&(connectionMode===ConnectionMode.Strict?isTarget&&"source"===handleType||!isTarget&&"target"===handleType:handleNodeId!==fromNodeId||handleId!==fromHandleId)&&(result.endHandle={nodeId:handleNodeId,handleId,type:handleType},result.isValid=isValidConnection(connection))}return result}function getHandleType(edgeUpdaterType,handleDomNode){return edgeUpdaterType||(handleDomNode?.classList.contains("target")?"target":handleDomNode?.classList.contains("source")?"source":null)}function resetRecentHandle(handleDomNode){handleDomNode?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function getConnectionStatus(isInsideConnectionRadius,isHandleValid){let connectionStatus=null;return isHandleValid?connectionStatus="valid":isInsideConnectionRadius&&!isHandleValid&&(connectionStatus="invalid"),connectionStatus}function handlePointerDown({event,handleId,nodeId,onConnect,isTarget,getState,setState,isValidConnection,edgeUpdaterType,onEdgeUpdateEnd}){const doc=getHostForElement(event.target),{connectionMode,domNode,autoPanOnConnect,connectionRadius,onConnectStart,panBy,getNodes,cancelConnection}=getState();let closestHandle,autoPanId=0;const{x,y}=getEventPosition(event),clickedHandle=doc?.elementFromPoint(x,y),handleType=getHandleType(edgeUpdaterType,clickedHandle),containerBounds=domNode?.getBoundingClientRect();if(!containerBounds||!handleType)return;let prevActiveHandle,connectionPosition=getEventPosition(event,containerBounds),autoPanStarted=!1,connection=null,isValid=!1,handleDomNode=null;const handleLookup=function getHandleLookup({nodes,nodeId,handleId,handleType}){return nodes.reduce(((res,node)=>{if(node[internalsSymbol]){const{handleBounds}=node[internalsSymbol];let sourceHandles=[],targetHandles=[];handleBounds&&(sourceHandles=getHandles(node,handleBounds,"source",`${nodeId}-${handleId}-${handleType}`),targetHandles=getHandles(node,handleBounds,"target",`${nodeId}-${handleId}-${handleType}`)),res.push(...sourceHandles,...targetHandles)}return res}),[])}({nodes:getNodes(),nodeId,handleId,handleType}),autoPan=()=>{if(!autoPanOnConnect)return;const[xMovement,yMovement]=calcAutoPan(connectionPosition,containerBounds);panBy({x:xMovement,y:yMovement}),autoPanId=requestAnimationFrame(autoPan)};function onPointerMove(event){const{transform}=getState();connectionPosition=getEventPosition(event,containerBounds);const{handle,validHandleResult}=function getClosestHandle(event,doc,pos,connectionRadius,handles,validator){const{x,y}=getEventPosition(event),handleBelow=doc.elementsFromPoint(x,y).find((el=>el.classList.contains("react-flow__handle")));if(handleBelow){const handleNodeId=handleBelow.getAttribute("data-nodeid");if(handleNodeId){const handleType=getHandleType(void 0,handleBelow),handleId=handleBelow.getAttribute("data-handleid"),validHandleResult=validator({nodeId:handleNodeId,id:handleId,type:handleType});if(validHandleResult)return{handle:{id:handleId,type:handleType,nodeId:handleNodeId,x:pos.x,y:pos.y},validHandleResult}}}let closestHandles=[],minDistance=1/0;if(handles.forEach((handle=>{const distance=Math.sqrt((handle.x-pos.x)**2+(handle.y-pos.y)**2);if(distance<=connectionRadius){const validHandleResult=validator(handle);distance<=minDistance&&(distance<minDistance?closestHandles=[{handle,validHandleResult}]:distance===minDistance&&closestHandles.push({handle,validHandleResult}),minDistance=distance)}})),!closestHandles.length)return{handle:null,validHandleResult:defaultResult()};if(1===closestHandles.length)return closestHandles[0];const hasValidHandle=closestHandles.some((({validHandleResult})=>validHandleResult.isValid)),hasTargetHandle=closestHandles.some((({handle})=>"target"===handle.type));return closestHandles.find((({handle,validHandleResult})=>hasTargetHandle?"target"===handle.type:!hasValidHandle||validHandleResult.isValid))||closestHandles[0]}(event,doc,pointToRendererPoint(connectionPosition,transform,!1,[1,1]),connectionRadius,handleLookup,(handle=>isValidHandle(handle,connectionMode,nodeId,handleId,isTarget?"target":"source",isValidConnection,doc)));if(closestHandle=handle,autoPanStarted||(autoPan(),autoPanStarted=!0),handleDomNode=validHandleResult.handleDomNode,connection=validHandleResult.connection,isValid=validHandleResult.isValid,setState({connectionPosition:closestHandle&&isValid?rendererPointToPoint({x:closestHandle.x,y:closestHandle.y},transform):connectionPosition,connectionStatus:getConnectionStatus(!!closestHandle,isValid),connectionEndHandle:validHandleResult.endHandle}),!closestHandle&&!isValid&&!handleDomNode)return resetRecentHandle(prevActiveHandle);connection.source!==connection.target&&handleDomNode&&(resetRecentHandle(prevActiveHandle),prevActiveHandle=handleDomNode,handleDomNode.classList.add("connecting","react-flow__handle-connecting"),handleDomNode.classList.toggle("valid",isValid),handleDomNode.classList.toggle("react-flow__handle-valid",isValid))}function onPointerUp(event){(closestHandle||handleDomNode)&&connection&&isValid&&onConnect?.(connection),getState().onConnectEnd?.(event),edgeUpdaterType&&onEdgeUpdateEnd?.(event),resetRecentHandle(prevActiveHandle),cancelConnection(),cancelAnimationFrame(autoPanId),autoPanStarted=!1,isValid=!1,connection=null,handleDomNode=null,doc.removeEventListener("mousemove",onPointerMove),doc.removeEventListener("mouseup",onPointerUp),doc.removeEventListener("touchmove",onPointerMove),doc.removeEventListener("touchend",onPointerUp)}setState({connectionPosition,connectionStatus:null,connectionNodeId:nodeId,connectionHandleId:handleId,connectionHandleType:handleType,connectionStartHandle:{nodeId,handleId,type:handleType},connectionEndHandle:null}),onConnectStart?.(event,{nodeId,handleId,handleType}),doc.addEventListener("mousemove",onPointerMove),doc.addEventListener("mouseup",onPointerUp),doc.addEventListener("touchmove",onPointerMove),doc.addEventListener("touchend",onPointerUp)}const alwaysValid=()=>!0,selector$f=s=>({connectionStartHandle:s.connectionStartHandle,connectOnClick:s.connectOnClick,noPanClassName:s.noPanClassName}),Handle=(0,react.forwardRef)((({type="source",position=Position.Top,isValidConnection,isConnectable=!0,isConnectableStart=!0,isConnectableEnd=!0,id,onConnect,children,className,onMouseDown,onTouchStart,...rest},ref)=>{const handleId=id||null,isTarget="target"===type,store=useStoreApi(),nodeId=(0,react.useContext)(NodeIdContext),{connectOnClick,noPanClassName}=useStore(selector$f,shallow_shallow),{connecting,clickConnecting}=useStore(((nodeId,handleId,type)=>state=>{const{connectionStartHandle:startHandle,connectionEndHandle:endHandle,connectionClickStartHandle:clickHandle}=state;return{connecting:startHandle?.nodeId===nodeId&&startHandle?.handleId===handleId&&startHandle?.type===type||endHandle?.nodeId===nodeId&&endHandle?.handleId===handleId&&endHandle?.type===type,clickConnecting:clickHandle?.nodeId===nodeId&&clickHandle?.handleId===handleId&&clickHandle?.type===type}})(nodeId,handleId,type),shallow_shallow);nodeId||store.getState().onError?.("010",errorMessages.error010());const onConnectExtended=params=>{const{defaultEdgeOptions,onConnect:onConnectAction,hasDefaultEdges}=store.getState(),edgeParams={...defaultEdgeOptions,...params};if(hasDefaultEdges){const{edges,setEdges}=store.getState();setEdges(((edgeParams,edges)=>{if(!edgeParams.source||!edgeParams.target)return devWarn(0,errorMessages.error006()),edges;let edge;var element;return edge="id"in(element=edgeParams)&&"source"in element&&"target"in element?{...edgeParams}:{...edgeParams,id:getEdgeId(edgeParams)},((edge,edges)=>edges.some((el=>!(el.source!==edge.source||el.target!==edge.target||el.sourceHandle!==edge.sourceHandle&&(el.sourceHandle||edge.sourceHandle)||el.targetHandle!==edge.targetHandle&&(el.targetHandle||edge.targetHandle)))))(edge,edges)?edges:edges.concat(edge)})(edgeParams,edges))}onConnectAction?.(edgeParams),onConnect?.(edgeParams)},onPointerDown=event=>{if(!nodeId)return;const isMouseTriggered=isMouseEvent(event);isConnectableStart&&(isMouseTriggered&&0===event.button||!isMouseTriggered)&&handlePointerDown({event,handleId,nodeId,onConnect:onConnectExtended,isTarget,getState:store.getState,setState:store.setState,isValidConnection:isValidConnection||store.getState().isValidConnection||alwaysValid}),isMouseTriggered?onMouseDown?.(event):onTouchStart?.(event)};return(0,jsx_runtime.jsx)("div",{"data-handleid":handleId,"data-nodeid":nodeId,"data-handlepos":position,"data-id":`${nodeId}-${handleId}-${type}`,className:cc(["react-flow__handle",`react-flow__handle-${position}`,"nodrag",noPanClassName,className,{source:!isTarget,target:isTarget,connectable:isConnectable,connectablestart:isConnectableStart,connectableend:isConnectableEnd,connecting:clickConnecting,connectionindicator:isConnectable&&(isConnectableStart&&!connecting||isConnectableEnd&&connecting)}]),onMouseDown:onPointerDown,onTouchStart:onPointerDown,onClick:connectOnClick?event=>{const{onClickConnectStart,onClickConnectEnd,connectionClickStartHandle,connectionMode,isValidConnection:isValidConnectionStore}=store.getState();if(!nodeId||!connectionClickStartHandle&&!isConnectableStart)return;if(!connectionClickStartHandle)return onClickConnectStart?.(event,{nodeId,handleId,handleType:type}),void store.setState({connectionClickStartHandle:{nodeId,type,handleId}});const doc=getHostForElement(event.target),isValidConnectionHandler=isValidConnection||isValidConnectionStore||alwaysValid,{connection,isValid}=isValidHandle({nodeId,id:handleId,type},connectionMode,connectionClickStartHandle.nodeId,connectionClickStartHandle.handleId||null,connectionClickStartHandle.type,isValidConnectionHandler,doc);isValid&&onConnectExtended(connection),onClickConnectEnd?.(event),store.setState({connectionClickStartHandle:null})}:void 0,ref,...rest,children})}));Handle.displayName="Handle";var Handle$1=(0,react.memo)(Handle);const DefaultNode=({data,isConnectable,targetPosition=Position.Top,sourcePosition=Position.Bottom})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Handle$1,{type:"target",position:targetPosition,isConnectable}),data?.label,(0,jsx_runtime.jsx)(Handle$1,{type:"source",position:sourcePosition,isConnectable})]});DefaultNode.displayName="DefaultNode";var DefaultNode$1=(0,react.memo)(DefaultNode);const InputNode=({data,isConnectable,sourcePosition=Position.Bottom})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[data?.label,(0,jsx_runtime.jsx)(Handle$1,{type:"source",position:sourcePosition,isConnectable})]});InputNode.displayName="InputNode";var InputNode$1=(0,react.memo)(InputNode);const OutputNode=({data,isConnectable,targetPosition=Position.Top})=>(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(Handle$1,{type:"target",position:targetPosition,isConnectable}),data?.label]});OutputNode.displayName="OutputNode";var OutputNode$1=(0,react.memo)(OutputNode);const GroupNode=()=>null;GroupNode.displayName="GroupNode";const selector$e=s=>({selectedNodes:s.getNodes().filter((n=>n.selected)),selectedEdges:s.edges.filter((e=>e.selected))}),selectId=obj=>obj.id;function areEqual(a,b){return shallow_shallow(a.selectedNodes.map(selectId),b.selectedNodes.map(selectId))&&shallow_shallow(a.selectedEdges.map(selectId),b.selectedEdges.map(selectId))}const SelectionListener=(0,react.memo)((({onSelectionChange})=>{const store=useStoreApi(),{selectedNodes,selectedEdges}=useStore(selector$e,areEqual);return(0,react.useEffect)((()=>{const params={nodes:selectedNodes,edges:selectedEdges};onSelectionChange?.(params),store.getState().onSelectionChange?.(params)}),[selectedNodes,selectedEdges,onSelectionChange]),null}));SelectionListener.displayName="SelectionListener";const changeSelector=s=>!!s.onSelectionChange;function Wrapper$1({onSelectionChange}){const storeHasSelectionChange=useStore(changeSelector);return onSelectionChange||storeHasSelectionChange?(0,jsx_runtime.jsx)(SelectionListener,{onSelectionChange}):null}const selector$d=s=>({setNodes:s.setNodes,setEdges:s.setEdges,setDefaultNodesAndEdges:s.setDefaultNodesAndEdges,setMinZoom:s.setMinZoom,setMaxZoom:s.setMaxZoom,setTranslateExtent:s.setTranslateExtent,setNodeExtent:s.setNodeExtent,reset:s.reset});function useStoreUpdater(value,setStoreState){(0,react.useEffect)((()=>{void 0!==value&&setStoreState(value)}),[value])}function useDirectStoreUpdater(key,value,setState){(0,react.useEffect)((()=>{void 0!==value&&setState({[key]:value})}),[value])}const StoreUpdater=({nodes,edges,defaultNodes,defaultEdges,onConnect,onConnectStart,onConnectEnd,onClickConnectStart,onClickConnectEnd,nodesDraggable,nodesConnectable,nodesFocusable,edgesFocusable,edgesUpdatable,elevateNodesOnSelect,minZoom,maxZoom,nodeExtent,onNodesChange,onEdgesChange,elementsSelectable,connectionMode,snapGrid,snapToGrid,translateExtent,connectOnClick,defaultEdgeOptions,fitView,fitViewOptions,onNodesDelete,onEdgesDelete,onNodeDrag,onNodeDragStart,onNodeDragStop,onSelectionDrag,onSelectionDragStart,onSelectionDragStop,noPanClassName,nodeOrigin,rfId,autoPanOnConnect,autoPanOnNodeDrag,onError,connectionRadius,isValidConnection})=>{const{setNodes,setEdges,setDefaultNodesAndEdges,setMinZoom,setMaxZoom,setTranslateExtent,setNodeExtent,reset}=useStore(selector$d,shallow_shallow),store=useStoreApi();return(0,react.useEffect)((()=>{const edgesWithDefaults=defaultEdges?.map((e=>({...e,...defaultEdgeOptions})));return setDefaultNodesAndEdges(defaultNodes,edgesWithDefaults),()=>{reset()}}),[]),useDirectStoreUpdater("defaultEdgeOptions",defaultEdgeOptions,store.setState),useDirectStoreUpdater("connectionMode",connectionMode,store.setState),useDirectStoreUpdater("onConnect",onConnect,store.setState),useDirectStoreUpdater("onConnectStart",onConnectStart,store.setState),useDirectStoreUpdater("onConnectEnd",onConnectEnd,store.setState),useDirectStoreUpdater("onClickConnectStart",onClickConnectStart,store.setState),useDirectStoreUpdater("onClickConnectEnd",onClickConnectEnd,store.setState),useDirectStoreUpdater("nodesDraggable",nodesDraggable,store.setState),useDirectStoreUpdater("nodesConnectable",nodesConnectable,store.setState),useDirectStoreUpdater("nodesFocusable",nodesFocusable,store.setState),useDirectStoreUpdater("edgesFocusable",edgesFocusable,store.setState),useDirectStoreUpdater("edgesUpdatable",edgesUpdatable,store.setState),useDirectStoreUpdater("elementsSelectable",elementsSelectable,store.setState),useDirectStoreUpdater("elevateNodesOnSelect",elevateNodesOnSelect,store.setState),useDirectStoreUpdater("snapToGrid",snapToGrid,store.setState),useDirectStoreUpdater("snapGrid",snapGrid,store.setState),useDirectStoreUpdater("onNodesChange",onNodesChange,store.setState),useDirectStoreUpdater("onEdgesChange",onEdgesChange,store.setState),useDirectStoreUpdater("connectOnClick",connectOnClick,store.setState),useDirectStoreUpdater("fitViewOnInit",fitView,store.setState),useDirectStoreUpdater("fitViewOnInitOptions",fitViewOptions,store.setState),useDirectStoreUpdater("onNodesDelete",onNodesDelete,store.setState),useDirectStoreUpdater("onEdgesDelete",onEdgesDelete,store.setState),useDirectStoreUpdater("onNodeDrag",onNodeDrag,store.setState),useDirectStoreUpdater("onNodeDragStart",onNodeDragStart,store.setState),useDirectStoreUpdater("onNodeDragStop",onNodeDragStop,store.setState),useDirectStoreUpdater("onSelectionDrag",onSelectionDrag,store.setState),useDirectStoreUpdater("onSelectionDragStart",onSelectionDragStart,store.setState),useDirectStoreUpdater("onSelectionDragStop",onSelectionDragStop,store.setState),useDirectStoreUpdater("noPanClassName",noPanClassName,store.setState),useDirectStoreUpdater("nodeOrigin",nodeOrigin,store.setState),useDirectStoreUpdater("rfId",rfId,store.setState),useDirectStoreUpdater("autoPanOnConnect",autoPanOnConnect,store.setState),useDirectStoreUpdater("autoPanOnNodeDrag",autoPanOnNodeDrag,store.setState),useDirectStoreUpdater("onError",onError,store.setState),useDirectStoreUpdater("connectionRadius",connectionRadius,store.setState),useDirectStoreUpdater("isValidConnection",isValidConnection,store.setState),useStoreUpdater(nodes,setNodes),useStoreUpdater(edges,setEdges),useStoreUpdater(minZoom,setMinZoom),useStoreUpdater(maxZoom,setMaxZoom),useStoreUpdater(translateExtent,setTranslateExtent),useStoreUpdater(nodeExtent,setNodeExtent),null},esm_style={display:"none"},ariaLiveStyle={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},ARIA_LIVE_MESSAGE="react-flow__aria-live",selector$c=s=>s.ariaLiveMessage;function AriaLiveMessage({rfId}){const ariaLiveMessage=useStore(selector$c);return(0,jsx_runtime.jsx)("div",{id:`${ARIA_LIVE_MESSAGE}-${rfId}`,"aria-live":"assertive","aria-atomic":"true",style:ariaLiveStyle,children:ariaLiveMessage})}function A11yDescriptions({rfId,disableKeyboardA11y}){return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsxs)("div",{id:`react-flow__node-desc-${rfId}`,style:esm_style,children:["Press enter or space to select a node.",!disableKeyboardA11y&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "]}),(0,jsx_runtime.jsx)("div",{id:`react-flow__edge-desc-${rfId}`,style:esm_style,children:"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."}),!disableKeyboardA11y&&(0,jsx_runtime.jsx)(AriaLiveMessage,{rfId})]})}const doc="undefined"!=typeof document?document:null;var useKeyPress=(keyCode=null,options={target:doc})=>{const[keyPressed,setKeyPressed]=(0,react.useState)(!1),modifierPressed=(0,react.useRef)(!1),pressedKeys=(0,react.useRef)(new Set([])),[keyCodes,keysToWatch]=(0,react.useMemo)((()=>{if(null!==keyCode){const keys=(Array.isArray(keyCode)?keyCode:[keyCode]).filter((kc=>"string"==typeof kc)).map((kc=>kc.split("+"))),keysFlat=keys.reduce(((res,item)=>res.concat(...item)),[]);return[keys,keysFlat]}return[[],[]]}),[keyCode]);return(0,react.useEffect)((()=>{if(null!==keyCode){const downHandler=event=>{if(modifierPressed.current=event.ctrlKey||event.metaKey||event.shiftKey,!modifierPressed.current&&isInputDOMNode(event))return!1;const keyOrCode=useKeyOrCode(event.code,keysToWatch);pressedKeys.current.add(event[keyOrCode]),isMatchingKey(keyCodes,pressedKeys.current,!1)&&(event.preventDefault(),setKeyPressed(!0))},upHandler=event=>{if(!modifierPressed.current&&isInputDOMNode(event))return!1;const keyOrCode=useKeyOrCode(event.code,keysToWatch);isMatchingKey(keyCodes,pressedKeys.current,!0)?(setKeyPressed(!1),pressedKeys.current.clear()):pressedKeys.current.delete(event[keyOrCode]),"Meta"===event.key&&pressedKeys.current.clear(),modifierPressed.current=!1},resetHandler=()=>{pressedKeys.current.clear(),setKeyPressed(!1)};return options?.target?.addEventListener("keydown",downHandler),options?.target?.addEventListener("keyup",upHandler),window.addEventListener("blur",resetHandler),()=>{options?.target?.removeEventListener("keydown",downHandler),options?.target?.removeEventListener("keyup",upHandler),window.removeEventListener("blur",resetHandler)}}}),[keyCode,setKeyPressed]),keyPressed};function isMatchingKey(keyCodes,pressedKeys,isUp){return keyCodes.filter((keys=>isUp||keys.length===pressedKeys.size)).some((keys=>keys.every((k=>pressedKeys.has(k)))))}function useKeyOrCode(eventCode,keysToWatch){return keysToWatch.includes(eventCode)?"code":"key"}function calculateXYZPosition(node,nodeInternals,result,nodeOrigin){if(!node.parentNode)return result;const parentNode=nodeInternals.get(node.parentNode),parentNodePosition=getNodePositionWithOrigin(parentNode,nodeOrigin);return calculateXYZPosition(parentNode,nodeInternals,{x:(result.x??0)+parentNodePosition.x,y:(result.y??0)+parentNodePosition.y,z:(parentNode[internalsSymbol]?.z??0)>(result.z??0)?parentNode[internalsSymbol]?.z??0:result.z??0},nodeOrigin)}function updateAbsoluteNodePositions(nodeInternals,nodeOrigin,parentNodes){nodeInternals.forEach((node=>{if(node.parentNode&&!nodeInternals.has(node.parentNode))throw new Error(`Parent node ${node.parentNode} not found`);if(node.parentNode||parentNodes?.[node.id]){const{x,y,z}=calculateXYZPosition(node,nodeInternals,{...node.position,z:node[internalsSymbol]?.z??0},nodeOrigin);node.positionAbsolute={x,y},node[internalsSymbol].z=z,parentNodes?.[node.id]&&(node[internalsSymbol].isParent=!0)}}))}function createNodeInternals(nodes,nodeInternals,nodeOrigin,elevateNodesOnSelect){const nextNodeInternals=new Map,parentNodes={},selectedNodeZ=elevateNodesOnSelect?1e3:0;return nodes.forEach((node=>{const z=(isNumeric(node.zIndex)?node.zIndex:0)+(node.selected?selectedNodeZ:0),currInternals=nodeInternals.get(node.id),internals={width:currInternals?.width,height:currInternals?.height,...node,positionAbsolute:{x:node.position.x,y:node.position.y}};node.parentNode&&(internals.parentNode=node.parentNode,parentNodes[node.parentNode]=!0),Object.defineProperty(internals,internalsSymbol,{enumerable:!1,value:{handleBounds:currInternals?.[internalsSymbol]?.handleBounds,z}}),nextNodeInternals.set(node.id,internals)})),updateAbsoluteNodePositions(nextNodeInternals,nodeOrigin,parentNodes),nextNodeInternals}function fitView(get,options={}){const{getNodes,width,height,minZoom,maxZoom,d3Zoom,d3Selection,fitViewOnInitDone,fitViewOnInit,nodeOrigin}=get(),isInitialFitView=options.initial&&!fitViewOnInitDone&&fitViewOnInit;if(d3Zoom&&d3Selection&&(isInitialFitView||!options.initial)){const nodes=getNodes().filter((n=>{const isVisible=options.includeHiddenNodes?n.width&&n.height:!n.hidden;return options.nodes?.length?isVisible&&options.nodes.some((optionNode=>optionNode.id===n.id)):isVisible})),nodesInitialized=nodes.every((n=>n.width&&n.height));if(nodes.length>0&&nodesInitialized){const bounds=getRectOfNodes(nodes,nodeOrigin),[x,y,zoom]=getTransformForBounds(bounds,width,height,options.minZoom??minZoom,options.maxZoom??maxZoom,options.padding??.1),nextTransform=transform_identity.translate(x,y).scale(zoom);return"number"==typeof options.duration&&options.duration>0?d3Zoom.transform(getD3Transition(d3Selection,options.duration),nextTransform):d3Zoom.transform(d3Selection,nextTransform),!0}}return!1}function handleControlledNodeSelectionChange(nodeChanges,nodeInternals){return nodeChanges.forEach((change=>{const node=nodeInternals.get(change.id);node&&nodeInternals.set(node.id,{...node,[internalsSymbol]:node[internalsSymbol],selected:change.selected})})),new Map(nodeInternals)}function handleControlledEdgeSelectionChange(edgeChanges,edges){return edges.map((e=>{const change=edgeChanges.find((change=>change.id===e.id));return change&&(e.selected=change.selected),e}))}function updateNodesAndEdgesSelections({changedNodes,changedEdges,get,set}){const{nodeInternals,edges,onNodesChange,onEdgesChange,hasDefaultNodes,hasDefaultEdges}=get();changedNodes?.length&&(hasDefaultNodes&&set({nodeInternals:handleControlledNodeSelectionChange(changedNodes,nodeInternals)}),onNodesChange?.(changedNodes)),changedEdges?.length&&(hasDefaultEdges&&set({edges:handleControlledEdgeSelectionChange(changedEdges,edges)}),onEdgesChange?.(changedEdges))}const esm_noop=()=>{},initialViewportHelper={zoomIn:esm_noop,zoomOut:esm_noop,zoomTo:esm_noop,getZoom:()=>1,setViewport:esm_noop,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:esm_noop,fitBounds:esm_noop,project:position=>position,viewportInitialized:!1},selector$b=s=>({d3Zoom:s.d3Zoom,d3Selection:s.d3Selection}),useViewportHelper=()=>{const store=useStoreApi(),{d3Zoom,d3Selection}=useStore(selector$b,shallow_shallow),viewportHelperFunctions=(0,react.useMemo)((()=>d3Selection&&d3Zoom?{zoomIn:options=>d3Zoom.scaleBy(getD3Transition(d3Selection,options?.duration),1.2),zoomOut:options=>d3Zoom.scaleBy(getD3Transition(d3Selection,options?.duration),1/1.2),zoomTo:(zoomLevel,options)=>d3Zoom.scaleTo(getD3Transition(d3Selection,options?.duration),zoomLevel),getZoom:()=>store.getState().transform[2],setViewport:(transform,options)=>{const[x,y,zoom]=store.getState().transform,nextTransform=transform_identity.translate(transform.x??x,transform.y??y).scale(transform.zoom??zoom);d3Zoom.transform(getD3Transition(d3Selection,options?.duration),nextTransform)},getViewport:()=>{const[x,y,zoom]=store.getState().transform;return{x,y,zoom}},fitView:options=>fitView(store.getState,options),setCenter:(x,y,options)=>{const{width,height,maxZoom}=store.getState(),nextZoom=void 0!==options?.zoom?options.zoom:maxZoom,centerX=width/2-x*nextZoom,centerY=height/2-y*nextZoom,transform=transform_identity.translate(centerX,centerY).scale(nextZoom);d3Zoom.transform(getD3Transition(d3Selection,options?.duration),transform)},fitBounds:(bounds,options)=>{const{width,height,minZoom,maxZoom}=store.getState(),[x,y,zoom]=getTransformForBounds(bounds,width,height,minZoom,maxZoom,options?.padding??.1),transform=transform_identity.translate(x,y).scale(zoom);d3Zoom.transform(getD3Transition(d3Selection,options?.duration),transform)},project:position=>{const{transform,snapToGrid,snapGrid}=store.getState();return pointToRendererPoint(position,transform,snapToGrid,snapGrid)},viewportInitialized:!0}:initialViewportHelper),[d3Zoom,d3Selection]);return viewportHelperFunctions};function useReactFlow(){const viewportHelper=useViewportHelper(),store=useStoreApi(),getNodes=(0,react.useCallback)((()=>store.getState().getNodes().map((n=>({...n})))),[]),getNode=(0,react.useCallback)((id=>store.getState().nodeInternals.get(id)),[]),getEdges=(0,react.useCallback)((()=>{const{edges=[]}=store.getState();return edges.map((e=>({...e})))}),[]),getEdge=(0,react.useCallback)((id=>{const{edges=[]}=store.getState();return edges.find((e=>e.id===id))}),[]),setNodes=(0,react.useCallback)((payload=>{const{getNodes,setNodes,hasDefaultNodes,onNodesChange}=store.getState(),nodes=getNodes(),nextNodes="function"==typeof payload?payload(nodes):payload;if(hasDefaultNodes)setNodes(nextNodes);else if(onNodesChange){const changes=0===nextNodes.length?nodes.map((node=>({type:"remove",id:node.id}))):nextNodes.map((node=>({item:node,type:"reset"})));onNodesChange(changes)}}),[]),setEdges=(0,react.useCallback)((payload=>{const{edges=[],setEdges,hasDefaultEdges,onEdgesChange}=store.getState(),nextEdges="function"==typeof payload?payload(edges):payload;if(hasDefaultEdges)setEdges(nextEdges);else if(onEdgesChange){onEdgesChange(0===nextEdges.length?edges.map((edge=>({type:"remove",id:edge.id}))):nextEdges.map((edge=>({item:edge,type:"reset"}))))}}),[]),addNodes=(0,react.useCallback)((payload=>{const nodes=Array.isArray(payload)?payload:[payload],{getNodes,setNodes,hasDefaultNodes,onNodesChange}=store.getState();if(hasDefaultNodes){setNodes([...getNodes(),...nodes])}else if(onNodesChange){const changes=nodes.map((node=>({item:node,type:"add"})));onNodesChange(changes)}}),[]),addEdges=(0,react.useCallback)((payload=>{const nextEdges=Array.isArray(payload)?payload:[payload],{edges=[],setEdges,hasDefaultEdges,onEdgesChange}=store.getState();if(hasDefaultEdges)setEdges([...edges,...nextEdges]);else if(onEdgesChange){onEdgesChange(nextEdges.map((edge=>({item:edge,type:"add"}))))}}),[]),toObject=(0,react.useCallback)((()=>{const{getNodes,edges=[],transform}=store.getState(),[x,y,zoom]=transform;return{nodes:getNodes().map((n=>({...n}))),edges:edges.map((e=>({...e}))),viewport:{x,y,zoom}}}),[]),deleteElements=(0,react.useCallback)((({nodes:nodesDeleted,edges:edgesDeleted})=>{const{nodeInternals,getNodes,edges,hasDefaultNodes,hasDefaultEdges,onNodesDelete,onEdgesDelete,onNodesChange,onEdgesChange}=store.getState(),nodeIds=(nodesDeleted||[]).map((node=>node.id)),edgeIds=(edgesDeleted||[]).map((edge=>edge.id)),nodesToRemove=getNodes().reduce(((res,node)=>{const parentHit=!nodeIds.includes(node.id)&&node.parentNode&&res.find((n=>n.id===node.parentNode));return("boolean"!=typeof node.deletable||node.deletable)&&(nodeIds.includes(node.id)||parentHit)&&res.push(node),res}),[]),deletableEdges=edges.filter((e=>"boolean"!=typeof e.deletable||e.deletable)),initialHitEdges=deletableEdges.filter((e=>edgeIds.includes(e.id)));if(nodesToRemove||initialHitEdges){const connectedEdges=getConnectedEdges(nodesToRemove,deletableEdges),edgesToRemove=[...initialHitEdges,...connectedEdges],edgeIdsToRemove=edgesToRemove.reduce(((res,edge)=>(res.includes(edge.id)||res.push(edge.id),res)),[]);if((hasDefaultEdges||hasDefaultNodes)&&(hasDefaultEdges&&store.setState({edges:edges.filter((e=>!edgeIdsToRemove.includes(e.id)))}),hasDefaultNodes&&(nodesToRemove.forEach((node=>{nodeInternals.delete(node.id)})),store.setState({nodeInternals:new Map(nodeInternals)}))),edgeIdsToRemove.length>0&&(onEdgesDelete?.(edgesToRemove),onEdgesChange&&onEdgesChange(edgeIdsToRemove.map((id=>({id,type:"remove"}))))),nodesToRemove.length>0&&(onNodesDelete?.(nodesToRemove),onNodesChange)){onNodesChange(nodesToRemove.map((n=>({id:n.id,type:"remove"}))))}}}),[]),getNodeRect=(0,react.useCallback)((nodeOrRect=>{const isRect=isRectObject(nodeOrRect),node=isRect?null:store.getState().nodeInternals.get(nodeOrRect.id);return[isRect?nodeOrRect:nodeToRect(node),node,isRect]}),[]),getIntersectingNodes=(0,react.useCallback)(((nodeOrRect,partially=!0,nodes)=>{const[nodeRect,node,isRect]=getNodeRect(nodeOrRect);return nodeRect?(nodes||store.getState().getNodes()).filter((n=>{if(!(isRect||n.id!==node.id&&n.positionAbsolute))return!1;const currNodeRect=nodeToRect(n),overlappingArea=getOverlappingArea(currNodeRect,nodeRect);return partially&&overlappingArea>0||overlappingArea>=nodeOrRect.width*nodeOrRect.height})):[]}),[]),isNodeIntersecting=(0,react.useCallback)(((nodeOrRect,area,partially=!0)=>{const[nodeRect]=getNodeRect(nodeOrRect);if(!nodeRect)return!1;const overlappingArea=getOverlappingArea(nodeRect,area);return partially&&overlappingArea>0||overlappingArea>=nodeOrRect.width*nodeOrRect.height}),[]);return(0,react.useMemo)((()=>({...viewportHelper,getNodes,getNode,getEdges,getEdge,setNodes,setEdges,addNodes,addEdges,toObject,deleteElements,getIntersectingNodes,isNodeIntersecting})),[viewportHelper,getNodes,getNode,getEdges,getEdge,setNodes,setEdges,addNodes,addEdges,toObject,deleteElements,getIntersectingNodes,isNodeIntersecting])}const containerStyle={position:"absolute",width:"100%",height:"100%",top:0,left:0},eventToFlowTransform=eventTransform=>({x:eventTransform.x,y:eventTransform.y,zoom:eventTransform.k}),isWrappedWithClass=(event,className)=>event.target.closest(`.${className}`),isRightClickPan=(panOnDrag,usedButton)=>2===usedButton&&Array.isArray(panOnDrag)&&panOnDrag.includes(2),wheelDelta=event=>{const factor=event.ctrlKey&&isMacOs()?10:1;return-event.deltaY*(1===event.deltaMode?.05:event.deltaMode?1:.002)*factor},selector$a=s=>({d3Zoom:s.d3Zoom,d3Selection:s.d3Selection,d3ZoomHandler:s.d3ZoomHandler,userSelectionActive:s.userSelectionActive}),ZoomPane=({onMove,onMoveStart,onMoveEnd,onPaneContextMenu,zoomOnScroll=!0,zoomOnPinch=!0,panOnScroll=!1,panOnScrollSpeed=.5,panOnScrollMode=PanOnScrollMode.Free,zoomOnDoubleClick=!0,elementsSelectable,panOnDrag=!0,defaultViewport,translateExtent,minZoom,maxZoom,zoomActivationKeyCode,preventScrolling=!0,children,noWheelClassName,noPanClassName})=>{const timerId=(0,react.useRef)(),store=useStoreApi(),isZoomingOrPanning=(0,react.useRef)(!1),zoomedWithRightMouseButton=(0,react.useRef)(!1),zoomPane=(0,react.useRef)(null),prevTransform=(0,react.useRef)({x:0,y:0,zoom:0}),{d3Zoom,d3Selection,d3ZoomHandler,userSelectionActive}=useStore(selector$a,shallow_shallow),zoomActivationKeyPressed=useKeyPress(zoomActivationKeyCode),mouseButton=(0,react.useRef)(0),isPanScrolling=(0,react.useRef)(!1),panScrollTimeout=(0,react.useRef)();return function useResizeHandler(rendererNode){const store=useStoreApi();(0,react.useEffect)((()=>{let resizeObserver;const updateDimensions=()=>{if(!rendererNode.current)return;const size=getDimensions(rendererNode.current);0!==size.height&&0!==size.width||store.getState().onError?.("004",errorMessages.error004()),store.setState({width:size.width||500,height:size.height||500})};return updateDimensions(),window.addEventListener("resize",updateDimensions),rendererNode.current&&(resizeObserver=new ResizeObserver((()=>updateDimensions())),resizeObserver.observe(rendererNode.current)),()=>{window.removeEventListener("resize",updateDimensions),resizeObserver&&rendererNode.current&&resizeObserver.unobserve(rendererNode.current)}}),[])}(zoomPane),(0,react.useEffect)((()=>{if(zoomPane.current){const bbox=zoomPane.current.getBoundingClientRect(),d3ZoomInstance=function zoom(){var touchstarting,touchfirst,touchending,filter=defaultFilter,extent=defaultExtent,constrain=defaultConstrain,wheelDelta=defaultWheelDelta,touchable=defaultTouchable,scaleExtent=[0,1/0],translateExtent=[[-1/0,-1/0],[1/0,1/0]],duration=250,interpolate=src_zoom,listeners=src_dispatch("start","zoom","end"),touchDelay=500,wheelDelay=150,clickDistance2=0,tapDistance=10;function zoom(selection){selection.property("__zoom",defaultTransform).on("wheel.zoom",wheeled,{passive:!1}).on("mousedown.zoom",mousedowned).on("dblclick.zoom",dblclicked).filter(touchable).on("touchstart.zoom",touchstarted).on("touchmove.zoom",touchmoved).on("touchend.zoom touchcancel.zoom",touchended).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function scale(transform,k){return(k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],k)))===transform.k?transform:new Transform(k,transform.x,transform.y)}function translate(transform,p0,p1){var x=p0[0]-p1[0]*transform.k,y=p0[1]-p1[1]*transform.k;return x===transform.x&&y===transform.y?transform:new Transform(transform.k,x,y)}function centroid(extent){return[(+extent[0][0]+ +extent[1][0])/2,(+extent[0][1]+ +extent[1][1])/2]}function schedule(transition,transform,point,event){transition.on("start.zoom",(function(){gesture(this,arguments).event(event).start()})).on("interrupt.zoom end.zoom",(function(){gesture(this,arguments).event(event).end()})).tween("zoom",(function(){var args=arguments,g=gesture(this,args).event(event),e=extent.apply(this,args),p=null==point?centroid(e):"function"==typeof point?point.apply(this,args):point,w=Math.max(e[1][0]-e[0][0],e[1][1]-e[0][1]),a=this.__zoom,b="function"==typeof transform?transform.apply(this,args):transform,i=interpolate(a.invert(p).concat(w/a.k),b.invert(p).concat(w/b.k));return function(t){if(1===t)t=b;else{var l=i(t),k=w/l[2];t=new Transform(k,p[0]-l[0]*k,p[1]-l[1]*k)}g.zoom(null,t)}}))}function gesture(that,args,clean){return!clean&&that.__zooming||new Gesture(that,args)}function Gesture(that,args){this.that=that,this.args=args,this.active=0,this.sourceEvent=null,this.extent=extent.apply(that,args),this.taps=0}function wheeled(event,...args){if(filter.apply(this,arguments)){var g=gesture(this,args).event(event),t=this.__zoom,k=Math.max(scaleExtent[0],Math.min(scaleExtent[1],t.k*Math.pow(2,wheelDelta.apply(this,arguments)))),p=pointer(event);if(g.wheel)g.mouse[0][0]===p[0]&&g.mouse[0][1]===p[1]||(g.mouse[1]=t.invert(g.mouse[0]=p)),clearTimeout(g.wheel);else{if(t.k===k)return;g.mouse=[p,t.invert(p)],interrupt(this),g.start()}src_noevent(event),g.wheel=setTimeout((function wheelidled(){g.wheel=null,g.end()}),wheelDelay),g.zoom("mouse",constrain(translate(scale(t,k),g.mouse[0],g.mouse[1]),g.extent,translateExtent))}}function mousedowned(event,...args){if(!touchending&&filter.apply(this,arguments)){var currentTarget=event.currentTarget,g=gesture(this,args,!0).event(event),v=src_select(event.view).on("mousemove.zoom",(function mousemoved(event){if(src_noevent(event),!g.moved){var dx=event.clientX-x0,dy=event.clientY-y0;g.moved=dx*dx+dy*dy>clickDistance2}g.event(event).zoom("mouse",constrain(translate(g.that.__zoom,g.mouse[0]=pointer(event,currentTarget),g.mouse[1]),g.extent,translateExtent))}),!0).on("mouseup.zoom",(function mouseupped(event){v.on("mousemove.zoom mouseup.zoom",null),yesdrag(event.view,g.moved),src_noevent(event),g.event(event).end()}),!0),p=pointer(event,currentTarget),x0=event.clientX,y0=event.clientY;nodrag(event.view),noevent_nopropagation(event),g.mouse=[p,this.__zoom.invert(p)],interrupt(this),g.start()}}function dblclicked(event,...args){if(filter.apply(this,arguments)){var t0=this.__zoom,p0=pointer(event.changedTouches?event.changedTouches[0]:event,this),p1=t0.invert(p0),k1=t0.k*(event.shiftKey?.5:2),t1=constrain(translate(scale(t0,k1),p0,p1),extent.apply(this,args),translateExtent);src_noevent(event),duration>0?src_select(this).transition().duration(duration).call(schedule,t1,p0,event):src_select(this).call(zoom.transform,t1,p0,event)}}function touchstarted(event,...args){if(filter.apply(this,arguments)){var started,i,t,p,touches=event.touches,n=touches.length,g=gesture(this,args,event.changedTouches.length===n).event(event);for(noevent_nopropagation(event),i=0;i<n;++i)p=[p=pointer(t=touches[i],this),this.__zoom.invert(p),t.identifier],g.touch0?g.touch1||g.touch0[2]===p[2]||(g.touch1=p,g.taps=0):(g.touch0=p,started=!0,g.taps=1+!!touchstarting);touchstarting&&(touchstarting=clearTimeout(touchstarting)),started&&(g.taps<2&&(touchfirst=p[0],touchstarting=setTimeout((function(){touchstarting=null}),touchDelay)),interrupt(this),g.start())}}function touchmoved(event,...args){if(this.__zooming){var i,t,p,l,g=gesture(this,args).event(event),touches=event.changedTouches,n=touches.length;for(src_noevent(event),i=0;i<n;++i)p=pointer(t=touches[i],this),g.touch0&&g.touch0[2]===t.identifier?g.touch0[0]=p:g.touch1&&g.touch1[2]===t.identifier&&(g.touch1[0]=p);if(t=g.that.__zoom,g.touch1){var p0=g.touch0[0],l0=g.touch0[1],p1=g.touch1[0],l1=g.touch1[1],dp=(dp=p1[0]-p0[0])*dp+(dp=p1[1]-p0[1])*dp,dl=(dl=l1[0]-l0[0])*dl+(dl=l1[1]-l0[1])*dl;t=scale(t,Math.sqrt(dp/dl)),p=[(p0[0]+p1[0])/2,(p0[1]+p1[1])/2],l=[(l0[0]+l1[0])/2,(l0[1]+l1[1])/2]}else{if(!g.touch0)return;p=g.touch0[0],l=g.touch0[1]}g.zoom("touch",constrain(translate(t,p,l),g.extent,translateExtent))}}function touchended(event,...args){if(this.__zooming){var i,t,g=gesture(this,args).event(event),touches=event.changedTouches,n=touches.length;for(noevent_nopropagation(event),touchending&&clearTimeout(touchending),touchending=setTimeout((function(){touchending=null}),touchDelay),i=0;i<n;++i)t=touches[i],g.touch0&&g.touch0[2]===t.identifier?delete g.touch0:g.touch1&&g.touch1[2]===t.identifier&&delete g.touch1;if(g.touch1&&!g.touch0&&(g.touch0=g.touch1,delete g.touch1),g.touch0)g.touch0[1]=this.__zoom.invert(g.touch0[0]);else if(g.end(),2===g.taps&&(t=pointer(t,this),Math.hypot(touchfirst[0]-t[0],touchfirst[1]-t[1])<tapDistance)){var p=src_select(this).on("dblclick.zoom");p&&p.apply(this,arguments)}}}return zoom.transform=function(collection,transform,point,event){var selection=collection.selection?collection.selection():collection;selection.property("__zoom",defaultTransform),collection!==selection?schedule(collection,transform,point,event):selection.interrupt().each((function(){gesture(this,arguments).event(event).start().zoom(null,"function"==typeof transform?transform.apply(this,arguments):transform).end()}))},zoom.scaleBy=function(selection,k,p,event){zoom.scaleTo(selection,(function(){return this.__zoom.k*("function"==typeof k?k.apply(this,arguments):k)}),p,event)},zoom.scaleTo=function(selection,k,p,event){zoom.transform(selection,(function(){var e=extent.apply(this,arguments),t0=this.__zoom,p0=null==p?centroid(e):"function"==typeof p?p.apply(this,arguments):p,p1=t0.invert(p0),k1="function"==typeof k?k.apply(this,arguments):k;return constrain(translate(scale(t0,k1),p0,p1),e,translateExtent)}),p,event)},zoom.translateBy=function(selection,x,y,event){zoom.transform(selection,(function(){return constrain(this.__zoom.translate("function"==typeof x?x.apply(this,arguments):x,"function"==typeof y?y.apply(this,arguments):y),extent.apply(this,arguments),translateExtent)}),null,event)},zoom.translateTo=function(selection,x,y,p,event){zoom.transform(selection,(function(){var e=extent.apply(this,arguments),t=this.__zoom,p0=null==p?centroid(e):"function"==typeof p?p.apply(this,arguments):p;return constrain(transform_identity.translate(p0[0],p0[1]).scale(t.k).translate("function"==typeof x?-x.apply(this,arguments):-x,"function"==typeof y?-y.apply(this,arguments):-y),e,translateExtent)}),p,event)},Gesture.prototype={event:function(event){return event&&(this.sourceEvent=event),this},start:function(){return 1==++this.active&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(key,transform){return this.mouse&&"mouse"!==key&&(this.mouse[1]=transform.invert(this.mouse[0])),this.touch0&&"touch"!==key&&(this.touch0[1]=transform.invert(this.touch0[0])),this.touch1&&"touch"!==key&&(this.touch1[1]=transform.invert(this.touch1[0])),this.that.__zoom=transform,this.emit("zoom"),this},end:function(){return 0==--this.active&&(delete this.that.__zooming,this.emit("end")),this},emit:function(type){var d=src_select(this.that).datum();listeners.call(type,this.that,new ZoomEvent(type,{sourceEvent:this.sourceEvent,target:zoom,type,transform:this.that.__zoom,dispatch:listeners}),d)}},zoom.wheelDelta=function(_){return arguments.length?(wheelDelta="function"==typeof _?_:d3_zoom_src_constant(+_),zoom):wheelDelta},zoom.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_zoom_src_constant(!!_),zoom):filter},zoom.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_zoom_src_constant(!!_),zoom):touchable},zoom.extent=function(_){return arguments.length?(extent="function"==typeof _?_:d3_zoom_src_constant([[+_[0][0],+_[0][1]],[+_[1][0],+_[1][1]]]),zoom):extent},zoom.scaleExtent=function(_){return arguments.length?(scaleExtent[0]=+_[0],scaleExtent[1]=+_[1],zoom):[scaleExtent[0],scaleExtent[1]]},zoom.translateExtent=function(_){return arguments.length?(translateExtent[0][0]=+_[0][0],translateExtent[1][0]=+_[1][0],translateExtent[0][1]=+_[0][1],translateExtent[1][1]=+_[1][1],zoom):[[translateExtent[0][0],translateExtent[0][1]],[translateExtent[1][0],translateExtent[1][1]]]},zoom.constrain=function(_){return arguments.length?(constrain=_,zoom):constrain},zoom.duration=function(_){return arguments.length?(duration=+_,zoom):duration},zoom.interpolate=function(_){return arguments.length?(interpolate=_,zoom):interpolate},zoom.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?zoom:value},zoom.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,zoom):Math.sqrt(clickDistance2)},zoom.tapDistance=function(_){return arguments.length?(tapDistance=+_,zoom):tapDistance},zoom}().scaleExtent([minZoom,maxZoom]).translateExtent(translateExtent),selection=src_select(zoomPane.current).call(d3ZoomInstance),updatedTransform=transform_identity.translate(defaultViewport.x,defaultViewport.y).scale(clamp(defaultViewport.zoom,minZoom,maxZoom)),extent=[[0,0],[bbox.width,bbox.height]],constrainedTransform=d3ZoomInstance.constrain()(updatedTransform,extent,translateExtent);d3ZoomInstance.transform(selection,constrainedTransform),d3ZoomInstance.wheelDelta(wheelDelta),store.setState({d3Zoom:d3ZoomInstance,d3Selection:selection,d3ZoomHandler:selection.on("wheel.zoom"),transform:[constrainedTransform.x,constrainedTransform.y,constrainedTransform.k],domNode:zoomPane.current.closest(".react-flow")})}}),[]),(0,react.useEffect)((()=>{d3Selection&&d3Zoom&&(!panOnScroll||zoomActivationKeyPressed||userSelectionActive?void 0!==d3ZoomHandler&&d3Selection.on("wheel.zoom",(function(event,d){if(!preventScrolling||isWrappedWithClass(event,noWheelClassName))return null;event.preventDefault(),d3ZoomHandler.call(this,event,d)}),{passive:!1}):d3Selection.on("wheel.zoom",(event=>{if(isWrappedWithClass(event,noWheelClassName))return!1;event.preventDefault(),event.stopImmediatePropagation();const currentZoom=d3Selection.property("__zoom").k||1,_isMacOs=isMacOs();if(event.ctrlKey&&zoomOnPinch&&_isMacOs){const point=pointer(event),pinchDelta=wheelDelta(event),zoom=currentZoom*Math.pow(2,pinchDelta);return void d3Zoom.scaleTo(d3Selection,zoom,point,event)}const deltaNormalize=1===event.deltaMode?20:1;let deltaX=panOnScrollMode===PanOnScrollMode.Vertical?0:event.deltaX*deltaNormalize,deltaY=panOnScrollMode===PanOnScrollMode.Horizontal?0:event.deltaY*deltaNormalize;!_isMacOs&&event.shiftKey&&panOnScrollMode!==PanOnScrollMode.Vertical&&(deltaX=event.deltaY*deltaNormalize,deltaY=0),d3Zoom.translateBy(d3Selection,-deltaX/currentZoom*panOnScrollSpeed,-deltaY/currentZoom*panOnScrollSpeed,{internal:!0});const nextViewport=eventToFlowTransform(d3Selection.property("__zoom")),{onViewportChangeStart,onViewportChange,onViewportChangeEnd}=store.getState();clearTimeout(panScrollTimeout.current),isPanScrolling.current||(isPanScrolling.current=!0,onMoveStart?.(event,nextViewport),onViewportChangeStart?.(nextViewport)),isPanScrolling.current&&(onMove?.(event,nextViewport),onViewportChange?.(nextViewport),panScrollTimeout.current=setTimeout((()=>{onMoveEnd?.(event,nextViewport),onViewportChangeEnd?.(nextViewport),isPanScrolling.current=!1}),150))}),{passive:!1}))}),[userSelectionActive,panOnScroll,panOnScrollMode,d3Selection,d3Zoom,d3ZoomHandler,zoomActivationKeyPressed,zoomOnPinch,preventScrolling,noWheelClassName,onMoveStart,onMove,onMoveEnd]),(0,react.useEffect)((()=>{d3Zoom&&d3Zoom.on("start",(event=>{if(!event.sourceEvent||event.sourceEvent.internal)return null;mouseButton.current=event.sourceEvent?.button;const{onViewportChangeStart}=store.getState(),flowTransform=eventToFlowTransform(event.transform);isZoomingOrPanning.current=!0,prevTransform.current=flowTransform,"mousedown"===event.sourceEvent?.type&&store.setState({paneDragging:!0}),onViewportChangeStart?.(flowTransform),onMoveStart?.(event.sourceEvent,flowTransform)}))}),[d3Zoom,onMoveStart]),(0,react.useEffect)((()=>{d3Zoom&&(userSelectionActive&&!isZoomingOrPanning.current?d3Zoom.on("zoom",null):userSelectionActive||d3Zoom.on("zoom",(event=>{const{onViewportChange}=store.getState();if(store.setState({transform:[event.transform.x,event.transform.y,event.transform.k]}),zoomedWithRightMouseButton.current=!(!onPaneContextMenu||!isRightClickPan(panOnDrag,mouseButton.current??0)),(onMove||onViewportChange)&&!event.sourceEvent?.internal){const flowTransform=eventToFlowTransform(event.transform);onViewportChange?.(flowTransform),onMove?.(event.sourceEvent,flowTransform)}})))}),[userSelectionActive,d3Zoom,onMove,panOnDrag,onPaneContextMenu]),(0,react.useEffect)((()=>{d3Zoom&&d3Zoom.on("end",(event=>{if(!event.sourceEvent||event.sourceEvent.internal)return null;const{onViewportChangeEnd}=store.getState();if(isZoomingOrPanning.current=!1,store.setState({paneDragging:!1}),onPaneContextMenu&&isRightClickPan(panOnDrag,mouseButton.current??0)&&!zoomedWithRightMouseButton.current&&onPaneContextMenu(event.sourceEvent),zoomedWithRightMouseButton.current=!1,(onMoveEnd||onViewportChangeEnd)&&(prevViewport=prevTransform.current,eventTransform=event.transform,prevViewport.x!==eventTransform.x||prevViewport.y!==eventTransform.y||prevViewport.zoom!==eventTransform.k)){const flowTransform=eventToFlowTransform(event.transform);prevTransform.current=flowTransform,clearTimeout(timerId.current),timerId.current=setTimeout((()=>{onViewportChangeEnd?.(flowTransform),onMoveEnd?.(event.sourceEvent,flowTransform)}),panOnScroll?150:0)}var prevViewport,eventTransform}))}),[d3Zoom,panOnScroll,panOnDrag,onMoveEnd,onPaneContextMenu]),(0,react.useEffect)((()=>{d3Zoom&&d3Zoom.filter((event=>{const zoomScroll=zoomActivationKeyPressed||zoomOnScroll,pinchZoom=zoomOnPinch&&event.ctrlKey;if(1===event.button&&"mousedown"===event.type&&(isWrappedWithClass(event,"react-flow__node")||isWrappedWithClass(event,"react-flow__edge")))return!0;if(!(panOnDrag||zoomScroll||panOnScroll||zoomOnDoubleClick||zoomOnPinch))return!1;if(userSelectionActive)return!1;if(!zoomOnDoubleClick&&"dblclick"===event.type)return!1;if(isWrappedWithClass(event,noWheelClassName)&&"wheel"===event.type)return!1;if(isWrappedWithClass(event,noPanClassName)&&"wheel"!==event.type)return!1;if(!zoomOnPinch&&event.ctrlKey&&"wheel"===event.type)return!1;if(!zoomScroll&&!panOnScroll&&!pinchZoom&&"wheel"===event.type)return!1;if(!panOnDrag&&("mousedown"===event.type||"touchstart"===event.type))return!1;if(Array.isArray(panOnDrag)&&!panOnDrag.includes(event.button)&&("mousedown"===event.type||"touchstart"===event.type))return!1;const buttonAllowed=Array.isArray(panOnDrag)&&panOnDrag.includes(event.button)||!event.button||event.button<=1;return(!event.ctrlKey||"wheel"===event.type)&&buttonAllowed}))}),[userSelectionActive,d3Zoom,zoomOnScroll,zoomOnPinch,panOnScroll,zoomOnDoubleClick,panOnDrag,elementsSelectable,zoomActivationKeyPressed]),(0,jsx_runtime.jsx)("div",{className:"react-flow__renderer",ref:zoomPane,style:containerStyle,children})},selector$9=s=>({userSelectionActive:s.userSelectionActive,userSelectionRect:s.userSelectionRect});function UserSelection(){const{userSelectionActive,userSelectionRect}=useStore(selector$9,shallow_shallow);return userSelectionActive&&userSelectionRect?(0,jsx_runtime.jsx)("div",{className:"react-flow__selection react-flow__container",style:{width:userSelectionRect.width,height:userSelectionRect.height,transform:`translate(${userSelectionRect.x}px, ${userSelectionRect.y}px)`}}):null}function handleParentExpand(res,updateItem){const parent=res.find((e=>e.id===updateItem.parentNode));if(parent){const extendWidth=updateItem.position.x+updateItem.width-parent.width,extendHeight=updateItem.position.y+updateItem.height-parent.height;if(extendWidth>0||extendHeight>0||updateItem.position.x<0||updateItem.position.y<0){if(parent.style={...parent.style}||{},parent.style.width=parent.style.width??parent.width,parent.style.height=parent.style.height??parent.height,extendWidth>0&&(parent.style.width+=extendWidth),extendHeight>0&&(parent.style.height+=extendHeight),updateItem.position.x<0){const xDiff=Math.abs(updateItem.position.x);parent.position.x=parent.position.x-xDiff,parent.style.width+=xDiff,updateItem.position.x=0}if(updateItem.position.y<0){const yDiff=Math.abs(updateItem.position.y);parent.position.y=parent.position.y-yDiff,parent.style.height+=yDiff,updateItem.position.y=0}parent.width=parent.style.width,parent.height=parent.style.height}}}function applyChanges(changes,elements){if(changes.some((c=>"reset"===c.type)))return changes.filter((c=>"reset"===c.type)).map((c=>c.item));const initElements=changes.filter((c=>"add"===c.type)).map((c=>c.item));return elements.reduce(((res,item)=>{const currentChanges=changes.filter((c=>c.id===item.id));if(0===currentChanges.length)return res.push(item),res;const updateItem={...item};for(const currentChange of currentChanges)if(currentChange)switch(currentChange.type){case"select":updateItem.selected=currentChange.selected;break;case"position":void 0!==currentChange.position&&(updateItem.position=currentChange.position),void 0!==currentChange.positionAbsolute&&(updateItem.positionAbsolute=currentChange.positionAbsolute),void 0!==currentChange.dragging&&(updateItem.dragging=currentChange.dragging),updateItem.expandParent&&handleParentExpand(res,updateItem);break;case"dimensions":void 0!==currentChange.dimensions&&(updateItem.width=currentChange.dimensions.width,updateItem.height=currentChange.dimensions.height),void 0!==currentChange.updateStyle&&(updateItem.style={...updateItem.style||{},...currentChange.dimensions}),"boolean"==typeof currentChange.resizing&&(updateItem.resizing=currentChange.resizing),updateItem.expandParent&&handleParentExpand(res,updateItem);break;case"remove":return res}return res.push(updateItem),res}),initElements)}function applyNodeChanges(changes,nodes){return applyChanges(changes,nodes)}const createSelectionChange=(id,selected)=>({id,type:"select",selected});function getSelectionChanges(items,selectedIds){return items.reduce(((res,item)=>{const willBeSelected=selectedIds.includes(item.id);return!item.selected&&willBeSelected?(item.selected=!0,res.push(createSelectionChange(item.id,!0))):item.selected&&!willBeSelected&&(item.selected=!1,res.push(createSelectionChange(item.id,!1))),res}),[])}const wrapHandler=(handler,containerRef)=>event=>{event.target===containerRef.current&&handler?.(event)},selector$8=s=>({userSelectionActive:s.userSelectionActive,elementsSelectable:s.elementsSelectable,dragging:s.paneDragging}),Pane=(0,react.memo)((({isSelecting,selectionMode=SelectionMode.Full,panOnDrag,onSelectionStart,onSelectionEnd,onPaneClick,onPaneContextMenu,onPaneScroll,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,children})=>{const container=(0,react.useRef)(null),store=useStoreApi(),prevSelectedNodesCount=(0,react.useRef)(0),prevSelectedEdgesCount=(0,react.useRef)(0),containerBounds=(0,react.useRef)(),{userSelectionActive,elementsSelectable,dragging}=useStore(selector$8,shallow_shallow),resetUserSelection=()=>{store.setState({userSelectionActive:!1,userSelectionRect:null}),prevSelectedNodesCount.current=0,prevSelectedEdgesCount.current=0},onClick=event=>{onPaneClick?.(event),store.getState().resetSelectedElements(),store.setState({nodesSelectionActive:!1})},onWheel=onPaneScroll?event=>onPaneScroll(event):void 0,hasActiveSelection=elementsSelectable&&(isSelecting||userSelectionActive);return(0,jsx_runtime.jsxs)("div",{className:cc(["react-flow__pane",{dragging,selection:isSelecting}]),onClick:hasActiveSelection?void 0:wrapHandler(onClick,container),onContextMenu:wrapHandler((event=>{Array.isArray(panOnDrag)&&panOnDrag?.includes(2)?event.preventDefault():onPaneContextMenu?.(event)}),container),onWheel:wrapHandler(onWheel,container),onMouseEnter:hasActiveSelection?void 0:onPaneMouseEnter,onMouseDown:hasActiveSelection?event=>{const{resetSelectedElements,domNode}=store.getState();if(containerBounds.current=domNode?.getBoundingClientRect(),!elementsSelectable||!isSelecting||0!==event.button||event.target!==container.current||!containerBounds.current)return;const{x,y}=getEventPosition(event,containerBounds.current);resetSelectedElements(),store.setState({userSelectionRect:{width:0,height:0,startX:x,startY:y,x,y}}),onSelectionStart?.(event)}:void 0,onMouseMove:hasActiveSelection?event=>{const{userSelectionRect,nodeInternals,edges,transform,onNodesChange,onEdgesChange,nodeOrigin,getNodes}=store.getState();if(!isSelecting||!containerBounds.current||!userSelectionRect)return;store.setState({userSelectionActive:!0,nodesSelectionActive:!1});const mousePos=getEventPosition(event,containerBounds.current),startX=userSelectionRect.startX??0,startY=userSelectionRect.startY??0,nextUserSelectRect={...userSelectionRect,x:mousePos.x<startX?mousePos.x:startX,y:mousePos.y<startY?mousePos.y:startY,width:Math.abs(mousePos.x-startX),height:Math.abs(mousePos.y-startY)},nodes=getNodes(),selectedNodes=getNodesInside(nodeInternals,nextUserSelectRect,transform,selectionMode===SelectionMode.Partial,!0,nodeOrigin),selectedEdgeIds=getConnectedEdges(selectedNodes,edges).map((e=>e.id)),selectedNodeIds=selectedNodes.map((n=>n.id));if(prevSelectedNodesCount.current!==selectedNodeIds.length){prevSelectedNodesCount.current=selectedNodeIds.length;const changes=getSelectionChanges(nodes,selectedNodeIds);changes.length&&onNodesChange?.(changes)}if(prevSelectedEdgesCount.current!==selectedEdgeIds.length){prevSelectedEdgesCount.current=selectedEdgeIds.length;const changes=getSelectionChanges(edges,selectedEdgeIds);changes.length&&onEdgesChange?.(changes)}store.setState({userSelectionRect:nextUserSelectRect})}:onPaneMouseMove,onMouseUp:hasActiveSelection?event=>{if(0!==event.button)return;const{userSelectionRect}=store.getState();!userSelectionActive&&userSelectionRect&&event.target===container.current&&onClick?.(event),store.setState({nodesSelectionActive:prevSelectedNodesCount.current>0}),resetUserSelection(),onSelectionEnd?.(event)}:void 0,onMouseLeave:hasActiveSelection?event=>{userSelectionActive&&(store.setState({nodesSelectionActive:prevSelectedNodesCount.current>0}),onSelectionEnd?.(event)),resetUserSelection()}:onPaneMouseLeave,ref:container,style:containerStyle,children:[children,(0,jsx_runtime.jsx)(UserSelection,{})]})}));function isParentSelected(node,nodeInternals){if(!node.parentNode)return!1;const parentNode=nodeInternals.get(node.parentNode);return!!parentNode&&(!!parentNode.selected||isParentSelected(parentNode,nodeInternals))}function hasSelector(target,selector,nodeRef){let current=target;do{if(current?.matches(selector))return!0;if(current===nodeRef.current)return!1;current=current.parentElement}while(current);return!1}function getDragItems(nodeInternals,nodesDraggable,mousePos,nodeId){return Array.from(nodeInternals.values()).filter((n=>(n.selected||n.id===nodeId)&&(!n.parentNode||!isParentSelected(n,nodeInternals))&&(n.draggable||nodesDraggable&&void 0===n.draggable))).map((n=>({id:n.id,position:n.position||{x:0,y:0},positionAbsolute:n.positionAbsolute||{x:0,y:0},distance:{x:mousePos.x-(n.positionAbsolute?.x??0),y:mousePos.y-(n.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:n.extent,parentNode:n.parentNode,width:n.width,height:n.height})))}function calcNextPosition(node,nextPosition,nodeInternals,nodeExtent,nodeOrigin=[0,0],onError){const clampedNodeExtent=function clampNodeExtent(node,extent){return extent&&"parent"!==extent?[extent[0],[extent[1][0]-(node.width||0),extent[1][1]-(node.height||0)]]:extent}(node,node.extent||nodeExtent);let currentExtent=clampedNodeExtent;if("parent"===node.extent)if(node.parentNode&&node.width&&node.height){const parent=nodeInternals.get(node.parentNode),{x:parentX,y:parentY}=getNodePositionWithOrigin(parent,nodeOrigin).positionAbsolute;currentExtent=parent&&isNumeric(parentX)&&isNumeric(parentY)&&isNumeric(parent.width)&&isNumeric(parent.height)?[[parentX+node.width*nodeOrigin[0],parentY+node.height*nodeOrigin[1]],[parentX+parent.width-node.width+node.width*nodeOrigin[0],parentY+parent.height-node.height+node.height*nodeOrigin[1]]]:currentExtent}else onError?.("005",errorMessages.error005()),currentExtent=clampedNodeExtent;else if(node.extent&&node.parentNode){const parent=nodeInternals.get(node.parentNode),{x:parentX,y:parentY}=getNodePositionWithOrigin(parent,nodeOrigin).positionAbsolute;currentExtent=[[node.extent[0][0]+parentX,node.extent[0][1]+parentY],[node.extent[1][0]+parentX,node.extent[1][1]+parentY]]}let parentPosition={x:0,y:0};if(node.parentNode){const parentNode=nodeInternals.get(node.parentNode);parentPosition=getNodePositionWithOrigin(parentNode,nodeOrigin).positionAbsolute}const positionAbsolute=currentExtent&&"parent"!==currentExtent?clampPosition(nextPosition,currentExtent):nextPosition;return{position:{x:positionAbsolute.x-parentPosition.x,y:positionAbsolute.y-parentPosition.y},positionAbsolute}}function getEventHandlerParams({nodeId,dragItems,nodeInternals}){const extentedDragItems=dragItems.map((n=>({...nodeInternals.get(n.id),position:n.position,positionAbsolute:n.positionAbsolute})));return[nodeId?extentedDragItems.find((n=>n.id===nodeId)):extentedDragItems[0],extentedDragItems]}Pane.displayName="Pane";const getHandleBounds=(selector,nodeElement,zoom,nodeOrigin)=>{const handles=nodeElement.querySelectorAll(selector);if(!handles||!handles.length)return null;const handlesArray=Array.from(handles),nodeBounds=nodeElement.getBoundingClientRect(),nodeOffset_x=nodeBounds.width*nodeOrigin[0],nodeOffset_y=nodeBounds.height*nodeOrigin[1];return handlesArray.map((handle=>{const handleBounds=handle.getBoundingClientRect();return{id:handle.getAttribute("data-handleid"),position:handle.getAttribute("data-handlepos"),x:(handleBounds.left-nodeBounds.left-nodeOffset_x)/zoom,y:(handleBounds.top-nodeBounds.top-nodeOffset_y)/zoom,...getDimensions(handle)}}))};function getMouseHandler(id,getState,handler){return void 0===handler?handler:event=>{const node=getState().nodeInternals.get(id);node&&handler(event,{...node})}}function handleNodeClick({id,store,unselect=!1,nodeRef}){const{addSelectedNodes,unselectNodesAndEdges,multiSelectionActive,nodeInternals,onError}=store.getState(),node=nodeInternals.get(id);node?(store.setState({nodesSelectionActive:!1}),node.selected?(unselect||node.selected&&multiSelectionActive)&&(unselectNodesAndEdges({nodes:[node]}),requestAnimationFrame((()=>nodeRef?.current?.blur()))):addSelectedNodes([id])):onError?.("012",errorMessages.error012(id))}function wrapSelectionDragFunc(selectionFunc){return(event,_,nodes)=>selectionFunc?.(event,nodes)}function useDrag({nodeRef,disabled=!1,noDragClassName,handleSelector,nodeId,isSelectable,selectNodesOnDrag}){const store=useStoreApi(),[dragging,setDragging]=(0,react.useState)(!1),dragItems=(0,react.useRef)([]),lastPos=(0,react.useRef)({x:null,y:null}),autoPanId=(0,react.useRef)(0),containerBounds=(0,react.useRef)(null),mousePosition=(0,react.useRef)({x:0,y:0}),dragEvent=(0,react.useRef)(null),autoPanStarted=(0,react.useRef)(!1),getPointerPosition=function useGetPointerPosition(){const store=useStoreApi(),getPointerPosition=(0,react.useCallback)((({sourceEvent})=>{const{transform,snapGrid,snapToGrid}=store.getState(),x=sourceEvent.touches?sourceEvent.touches[0].clientX:sourceEvent.clientX,y=sourceEvent.touches?sourceEvent.touches[0].clientY:sourceEvent.clientY,pointerPos={x:(x-transform[0])/transform[2],y:(y-transform[1])/transform[2]};return{xSnapped:snapToGrid?snapGrid[0]*Math.round(pointerPos.x/snapGrid[0]):pointerPos.x,ySnapped:snapToGrid?snapGrid[1]*Math.round(pointerPos.y/snapGrid[1]):pointerPos.y,...pointerPos}}),[]);return getPointerPosition}();return(0,react.useEffect)((()=>{if(nodeRef?.current){const selection=src_select(nodeRef.current),updateNodes=({x,y})=>{const{nodeInternals,onNodeDrag,onSelectionDrag,updateNodePositions,nodeExtent,snapGrid,snapToGrid,nodeOrigin,onError}=store.getState();lastPos.current={x,y};let hasChange=!1,nodesBox={x:0,y:0,x2:0,y2:0};if(dragItems.current.length>1&&nodeExtent){const rect=getRectOfNodes(dragItems.current,nodeOrigin);nodesBox=rectToBox(rect)}if(dragItems.current=dragItems.current.map((n=>{const nextPosition={x:x-n.distance.x,y:y-n.distance.y};snapToGrid&&(nextPosition.x=snapGrid[0]*Math.round(nextPosition.x/snapGrid[0]),nextPosition.y=snapGrid[1]*Math.round(nextPosition.y/snapGrid[1]));const adjustedNodeExtent=[[nodeExtent[0][0],nodeExtent[0][1]],[nodeExtent[1][0],nodeExtent[1][1]]];dragItems.current.length>1&&nodeExtent&&!n.extent&&(adjustedNodeExtent[0][0]=n.positionAbsolute.x-nodesBox.x+nodeExtent[0][0],adjustedNodeExtent[1][0]=n.positionAbsolute.x+(n.width??0)-nodesBox.x2+nodeExtent[1][0],adjustedNodeExtent[0][1]=n.positionAbsolute.y-nodesBox.y+nodeExtent[0][1],adjustedNodeExtent[1][1]=n.positionAbsolute.y+(n.height??0)-nodesBox.y2+nodeExtent[1][1]);const updatedPos=calcNextPosition(n,nextPosition,nodeInternals,adjustedNodeExtent,nodeOrigin,onError);return hasChange=hasChange||n.position.x!==updatedPos.position.x||n.position.y!==updatedPos.position.y,n.position=updatedPos.position,n.positionAbsolute=updatedPos.positionAbsolute,n})),!hasChange)return;updateNodePositions(dragItems.current,!0,!0),setDragging(!0);const onDrag=nodeId?onNodeDrag:wrapSelectionDragFunc(onSelectionDrag);if(onDrag&&dragEvent.current){const[currentNode,nodes]=getEventHandlerParams({nodeId,dragItems:dragItems.current,nodeInternals});onDrag(dragEvent.current,currentNode,nodes)}},autoPan=()=>{if(!containerBounds.current)return;const[xMovement,yMovement]=calcAutoPan(mousePosition.current,containerBounds.current);if(0!==xMovement||0!==yMovement){const{transform,panBy}=store.getState();lastPos.current.x=(lastPos.current.x??0)-xMovement/transform[2],lastPos.current.y=(lastPos.current.y??0)-yMovement/transform[2],panBy({x:xMovement,y:yMovement})&&updateNodes(lastPos.current)}autoPanId.current=requestAnimationFrame(autoPan)};if(!disabled){const dragHandler=function drag(){var mousedownx,mousedowny,mousemoving,touchending,filter=drag_defaultFilter,container=defaultContainer,subject=defaultSubject,touchable=drag_defaultTouchable,gestures={},listeners=src_dispatch("start","drag","end"),active=0,clickDistance2=0;function drag(selection){selection.on("mousedown.drag",mousedowned).filter(touchable).on("touchstart.drag",touchstarted).on("touchmove.drag",touchmoved,nonpassive).on("touchend.drag touchcancel.drag",touchended).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function mousedowned(event,d){if(!touchending&&filter.call(this,event,d)){var gesture=beforestart(this,container.call(this,event,d),event,d,"mouse");gesture&&(src_select(event.view).on("mousemove.drag",mousemoved,nonpassivecapture).on("mouseup.drag",mouseupped,nonpassivecapture),nodrag(event.view),nopropagation(event),mousemoving=!1,mousedownx=event.clientX,mousedowny=event.clientY,gesture("start",event))}}function mousemoved(event){if(noevent(event),!mousemoving){var dx=event.clientX-mousedownx,dy=event.clientY-mousedowny;mousemoving=dx*dx+dy*dy>clickDistance2}gestures.mouse("drag",event)}function mouseupped(event){src_select(event.view).on("mousemove.drag mouseup.drag",null),yesdrag(event.view,mousemoving),noevent(event),gestures.mouse("end",event)}function touchstarted(event,d){if(filter.call(this,event,d)){var i,gesture,touches=event.changedTouches,c=container.call(this,event,d),n=touches.length;for(i=0;i<n;++i)(gesture=beforestart(this,c,event,d,touches[i].identifier,touches[i]))&&(nopropagation(event),gesture("start",event,touches[i]))}}function touchmoved(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(noevent(event),gesture("drag",event,touches[i]))}function touchended(event){var i,gesture,touches=event.changedTouches,n=touches.length;for(touchending&&clearTimeout(touchending),touchending=setTimeout((function(){touchending=null}),500),i=0;i<n;++i)(gesture=gestures[touches[i].identifier])&&(nopropagation(event),gesture("end",event,touches[i]))}function beforestart(that,container,event,d,identifier,touch){var dx,dy,s,dispatch=listeners.copy(),p=pointer(touch||event,container);if(null!=(s=subject.call(that,new DragEvent("beforestart",{sourceEvent:event,target:drag,identifier,active,x:p[0],y:p[1],dx:0,dy:0,dispatch}),d)))return dx=s.x-p[0]||0,dy=s.y-p[1]||0,function gesture(type,event,touch){var n,p0=p;switch(type){case"start":gestures[identifier]=gesture,n=active++;break;case"end":delete gestures[identifier],--active;case"drag":p=pointer(touch||event,container),n=active}dispatch.call(type,that,new DragEvent(type,{sourceEvent:event,subject:s,target:drag,identifier,active:n,x:p[0]+dx,y:p[1]+dy,dx:p[0]-p0[0],dy:p[1]-p0[1],dispatch}),d)}}return drag.filter=function(_){return arguments.length?(filter="function"==typeof _?_:d3_drag_src_constant(!!_),drag):filter},drag.container=function(_){return arguments.length?(container="function"==typeof _?_:d3_drag_src_constant(_),drag):container},drag.subject=function(_){return arguments.length?(subject="function"==typeof _?_:d3_drag_src_constant(_),drag):subject},drag.touchable=function(_){return arguments.length?(touchable="function"==typeof _?_:d3_drag_src_constant(!!_),drag):touchable},drag.on=function(){var value=listeners.on.apply(listeners,arguments);return value===listeners?drag:value},drag.clickDistance=function(_){return arguments.length?(clickDistance2=(_=+_)*_,drag):Math.sqrt(clickDistance2)},drag}().on("start",(event=>{const{nodeInternals,multiSelectionActive,domNode,nodesDraggable,unselectNodesAndEdges,onNodeDragStart,onSelectionDragStart}=store.getState(),onStart=nodeId?onNodeDragStart:wrapSelectionDragFunc(onSelectionDragStart);selectNodesOnDrag||multiSelectionActive||!nodeId||nodeInternals.get(nodeId)?.selected||unselectNodesAndEdges(),nodeId&&isSelectable&&selectNodesOnDrag&&handleNodeClick({id:nodeId,store,nodeRef});const pointerPos=getPointerPosition(event);if(lastPos.current=pointerPos,dragItems.current=getDragItems(nodeInternals,nodesDraggable,pointerPos,nodeId),onStart&&dragItems.current){const[currentNode,nodes]=getEventHandlerParams({nodeId,dragItems:dragItems.current,nodeInternals});onStart(event.sourceEvent,currentNode,nodes)}containerBounds.current=domNode?.getBoundingClientRect()||null,mousePosition.current=getEventPosition(event.sourceEvent,containerBounds.current)})).on("drag",(event=>{const pointerPos=getPointerPosition(event),{autoPanOnNodeDrag}=store.getState();!autoPanStarted.current&&autoPanOnNodeDrag&&(autoPanStarted.current=!0,autoPan()),lastPos.current.x===pointerPos.xSnapped&&lastPos.current.y===pointerPos.ySnapped||!dragItems.current||(dragEvent.current=event.sourceEvent,mousePosition.current=getEventPosition(event.sourceEvent,containerBounds.current),updateNodes(pointerPos))})).on("end",(event=>{if(setDragging(!1),autoPanStarted.current=!1,cancelAnimationFrame(autoPanId.current),dragItems.current){const{updateNodePositions,nodeInternals,onNodeDragStop,onSelectionDragStop}=store.getState(),onStop=nodeId?onNodeDragStop:wrapSelectionDragFunc(onSelectionDragStop);if(updateNodePositions(dragItems.current,!1,!1),onStop){const[currentNode,nodes]=getEventHandlerParams({nodeId,dragItems:dragItems.current,nodeInternals});onStop(event.sourceEvent,currentNode,nodes)}}})).filter((event=>{const target=event.target;return!event.button&&(!noDragClassName||!hasSelector(target,`.${noDragClassName}`,nodeRef))&&(!handleSelector||hasSelector(target,handleSelector,nodeRef))}));return selection.call(dragHandler),()=>{selection.on(".drag",null)}}selection.on(".drag",null)}}),[nodeRef,disabled,noDragClassName,handleSelector,isSelectable,store,nodeId,selectNodesOnDrag,getPointerPosition]),dragging}function useUpdateNodePositions(){const store=useStoreApi();return(0,react.useCallback)((params=>{const{nodeInternals,nodeExtent,updateNodePositions,getNodes,snapToGrid,snapGrid,onError,nodesDraggable}=store.getState(),selectedNodes=getNodes().filter((n=>n.selected&&(n.draggable||nodesDraggable&&void 0===n.draggable))),xVelo=snapToGrid?snapGrid[0]:5,yVelo=snapToGrid?snapGrid[1]:5,factor=params.isShiftPressed?4:1,positionDiffX=params.x*xVelo*factor,positionDiffY=params.y*yVelo*factor;updateNodePositions(selectedNodes.map((n=>{if(n.positionAbsolute){const nextPosition={x:n.positionAbsolute.x+positionDiffX,y:n.positionAbsolute.y+positionDiffY};snapToGrid&&(nextPosition.x=snapGrid[0]*Math.round(nextPosition.x/snapGrid[0]),nextPosition.y=snapGrid[1]*Math.round(nextPosition.y/snapGrid[1]));const{positionAbsolute,position}=calcNextPosition(n,nextPosition,nodeInternals,nodeExtent,void 0,onError);n.position=position,n.positionAbsolute=positionAbsolute}return n})),!0,!1)}),[])}const arrowKeyDiffs={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var wrapNode=NodeComponent=>{const NodeWrapper=({id,type,data,xPos,yPos,xPosOrigin,yPosOrigin,selected,onClick,onMouseEnter,onMouseMove,onMouseLeave,onContextMenu,onDoubleClick,style,className,isDraggable,isSelectable,isConnectable,isFocusable,selectNodesOnDrag,sourcePosition,targetPosition,hidden,resizeObserver,dragHandle,zIndex,isParent,noDragClassName,noPanClassName,initialized,disableKeyboardA11y,ariaLabel,rfId})=>{const store=useStoreApi(),nodeRef=(0,react.useRef)(null),prevSourcePosition=(0,react.useRef)(sourcePosition),prevTargetPosition=(0,react.useRef)(targetPosition),prevType=(0,react.useRef)(type),hasPointerEvents=isSelectable||isDraggable||onClick||onMouseEnter||onMouseMove||onMouseLeave,updatePositions=useUpdateNodePositions(),onMouseEnterHandler=getMouseHandler(id,store.getState,onMouseEnter),onMouseMoveHandler=getMouseHandler(id,store.getState,onMouseMove),onMouseLeaveHandler=getMouseHandler(id,store.getState,onMouseLeave),onContextMenuHandler=getMouseHandler(id,store.getState,onContextMenu),onDoubleClickHandler=getMouseHandler(id,store.getState,onDoubleClick);(0,react.useEffect)((()=>{if(nodeRef.current&&!hidden){const currNode=nodeRef.current;return resizeObserver?.observe(currNode),()=>resizeObserver?.unobserve(currNode)}}),[hidden]),(0,react.useEffect)((()=>{const typeChanged=prevType.current!==type,sourcePosChanged=prevSourcePosition.current!==sourcePosition,targetPosChanged=prevTargetPosition.current!==targetPosition;nodeRef.current&&(typeChanged||sourcePosChanged||targetPosChanged)&&(typeChanged&&(prevType.current=type),sourcePosChanged&&(prevSourcePosition.current=sourcePosition),targetPosChanged&&(prevTargetPosition.current=targetPosition),store.getState().updateNodeDimensions([{id,nodeElement:nodeRef.current,forceUpdate:!0}]))}),[id,type,sourcePosition,targetPosition]);const dragging=useDrag({nodeRef,disabled:hidden||!isDraggable,noDragClassName,handleSelector:dragHandle,nodeId:id,isSelectable,selectNodesOnDrag});return hidden?null:(0,jsx_runtime.jsx)("div",{className:cc(["react-flow__node",`react-flow__node-${type}`,{[noPanClassName]:isDraggable},className,{selected,selectable:isSelectable,parent:isParent,dragging}]),ref:nodeRef,style:{zIndex,transform:`translate(${xPosOrigin}px,${yPosOrigin}px)`,pointerEvents:hasPointerEvents?"all":"none",visibility:initialized?"visible":"hidden",...style},"data-id":id,"data-testid":`rf__node-${id}`,onMouseEnter:onMouseEnterHandler,onMouseMove:onMouseMoveHandler,onMouseLeave:onMouseLeaveHandler,onContextMenu:onContextMenuHandler,onClick:event=>{if(!isSelectable||selectNodesOnDrag&&isDraggable||handleNodeClick({id,store,nodeRef}),onClick){const node=store.getState().nodeInternals.get(id);node&&onClick(event,{...node})}},onDoubleClick:onDoubleClickHandler,onKeyDown:isFocusable?event=>{if(!isInputDOMNode(event))if(elementSelectionKeys.includes(event.key)&&isSelectable){const unselect="Escape"===event.key;handleNodeClick({id,store,unselect,nodeRef})}else!disableKeyboardA11y&&isDraggable&&selected&&Object.prototype.hasOwnProperty.call(arrowKeyDiffs,event.key)&&(store.setState({ariaLiveMessage:`Moved selected node ${event.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~xPos}, y: ${~~yPos}`}),updatePositions({x:arrowKeyDiffs[event.key].x,y:arrowKeyDiffs[event.key].y,isShiftPressed:event.shiftKey}))}:void 0,tabIndex:isFocusable?0:void 0,role:isFocusable?"button":void 0,"aria-describedby":disableKeyboardA11y?void 0:`react-flow__node-desc-${rfId}`,"aria-label":ariaLabel,children:(0,jsx_runtime.jsx)(Provider,{value:id,children:(0,jsx_runtime.jsx)(NodeComponent,{id,data,type,xPos,yPos,selected,isConnectable,sourcePosition,targetPosition,dragging,dragHandle,zIndex})})})};return NodeWrapper.displayName="NodeWrapper",(0,react.memo)(NodeWrapper)};const selector$7=s=>{const selectedNodes=s.getNodes().filter((n=>n.selected));return{...getRectOfNodes(selectedNodes,s.nodeOrigin),transformString:`translate(${s.transform[0]}px,${s.transform[1]}px) scale(${s.transform[2]})`,userSelectionActive:s.userSelectionActive}};var NodesSelection$1=(0,react.memo)((function NodesSelection({onSelectionContextMenu,noPanClassName,disableKeyboardA11y}){const store=useStoreApi(),{width,height,x:left,y:top,transformString,userSelectionActive}=useStore(selector$7,shallow_shallow),updatePositions=useUpdateNodePositions(),nodeRef=(0,react.useRef)(null);if((0,react.useEffect)((()=>{disableKeyboardA11y||nodeRef.current?.focus({preventScroll:!0})}),[disableKeyboardA11y]),useDrag({nodeRef}),userSelectionActive||!width||!height)return null;const onContextMenu=onSelectionContextMenu?event=>{const selectedNodes=store.getState().getNodes().filter((n=>n.selected));onSelectionContextMenu(event,selectedNodes)}:void 0;return(0,jsx_runtime.jsx)("div",{className:cc(["react-flow__nodesselection","react-flow__container",noPanClassName]),style:{transform:transformString},children:(0,jsx_runtime.jsx)("div",{ref:nodeRef,className:"react-flow__nodesselection-rect",onContextMenu,tabIndex:disableKeyboardA11y?void 0:-1,onKeyDown:disableKeyboardA11y?void 0:event=>{Object.prototype.hasOwnProperty.call(arrowKeyDiffs,event.key)&&updatePositions({x:arrowKeyDiffs[event.key].x,y:arrowKeyDiffs[event.key].y,isShiftPressed:event.shiftKey})},style:{width,height,top,left}})})}));const selector$6=s=>s.nodesSelectionActive,FlowRenderer=({children,onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneContextMenu,onPaneScroll,deleteKeyCode,onMove,onMoveStart,onMoveEnd,selectionKeyCode,selectionOnDrag,selectionMode,onSelectionStart,onSelectionEnd,multiSelectionKeyCode,panActivationKeyCode,zoomActivationKeyCode,elementsSelectable,zoomOnScroll,zoomOnPinch,panOnScroll,panOnScrollSpeed,panOnScrollMode,zoomOnDoubleClick,panOnDrag:_panOnDrag,defaultViewport,translateExtent,minZoom,maxZoom,preventScrolling,onSelectionContextMenu,noWheelClassName,noPanClassName,disableKeyboardA11y})=>{const nodesSelectionActive=useStore(selector$6),selectionKeyPressed=useKeyPress(selectionKeyCode),panOnDrag=useKeyPress(panActivationKeyCode)||_panOnDrag,isSelecting=selectionKeyPressed||selectionOnDrag&&!0!==panOnDrag;return(({deleteKeyCode,multiSelectionKeyCode})=>{const store=useStoreApi(),{deleteElements}=useReactFlow(),deleteKeyPressed=useKeyPress(deleteKeyCode),multiSelectionKeyPressed=useKeyPress(multiSelectionKeyCode);(0,react.useEffect)((()=>{if(deleteKeyPressed){const{edges,getNodes}=store.getState(),selectedNodes=getNodes().filter((node=>node.selected)),selectedEdges=edges.filter((edge=>edge.selected));deleteElements({nodes:selectedNodes,edges:selectedEdges}),store.setState({nodesSelectionActive:!1})}}),[deleteKeyPressed]),(0,react.useEffect)((()=>{store.setState({multiSelectionActive:multiSelectionKeyPressed})}),[multiSelectionKeyPressed])})({deleteKeyCode,multiSelectionKeyCode}),(0,jsx_runtime.jsx)(ZoomPane,{onMove,onMoveStart,onMoveEnd,onPaneContextMenu,elementsSelectable,zoomOnScroll,zoomOnPinch,panOnScroll,panOnScrollSpeed,panOnScrollMode,zoomOnDoubleClick,panOnDrag:!selectionKeyPressed&&panOnDrag,defaultViewport,translateExtent,minZoom,maxZoom,zoomActivationKeyCode,preventScrolling,noWheelClassName,noPanClassName,children:(0,jsx_runtime.jsxs)(Pane,{onSelectionStart,onSelectionEnd,onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneContextMenu,onPaneScroll,panOnDrag,isSelecting:!!isSelecting,selectionMode,children:[children,nodesSelectionActive&&(0,jsx_runtime.jsx)(NodesSelection$1,{onSelectionContextMenu,noPanClassName,disableKeyboardA11y})]})})};FlowRenderer.displayName="FlowRenderer";var FlowRenderer$1=(0,react.memo)(FlowRenderer);function createNodeTypes(nodeTypes){return{...{input:wrapNode(nodeTypes.input||InputNode$1),default:wrapNode(nodeTypes.default||DefaultNode$1),output:wrapNode(nodeTypes.output||OutputNode$1),group:wrapNode(nodeTypes.group||GroupNode)},...Object.keys(nodeTypes).filter((k=>!["input","default","output","group"].includes(k))).reduce(((res,key)=>(res[key]=wrapNode(nodeTypes[key]||DefaultNode$1),res)),{})}}const selector$5=s=>({nodesDraggable:s.nodesDraggable,nodesConnectable:s.nodesConnectable,nodesFocusable:s.nodesFocusable,elementsSelectable:s.elementsSelectable,updateNodeDimensions:s.updateNodeDimensions,onError:s.onError}),NodeRenderer=props=>{const{nodesDraggable,nodesConnectable,nodesFocusable,elementsSelectable,updateNodeDimensions,onError}=useStore(selector$5,shallow_shallow),nodes=function useVisibleNodes(onlyRenderVisible){return useStore((0,react.useCallback)((s=>onlyRenderVisible?getNodesInside(s.nodeInternals,{x:0,y:0,width:s.width,height:s.height},s.transform,!0):s.getNodes()),[onlyRenderVisible]))}(props.onlyRenderVisibleElements),resizeObserverRef=(0,react.useRef)(),resizeObserver=(0,react.useMemo)((()=>{if("undefined"==typeof ResizeObserver)return null;const observer=new ResizeObserver((entries=>{const updates=entries.map((entry=>({id:entry.target.getAttribute("data-id"),nodeElement:entry.target,forceUpdate:!0})));updateNodeDimensions(updates)}));return resizeObserverRef.current=observer,observer}),[]);return(0,react.useEffect)((()=>()=>{resizeObserverRef?.current?.disconnect()}),[]),(0,jsx_runtime.jsx)("div",{className:"react-flow__nodes",style:containerStyle,children:nodes.map((node=>{let nodeType=node.type||"default";props.nodeTypes[nodeType]||(onError?.("003",errorMessages.error003(nodeType)),nodeType="default");const NodeComponent=props.nodeTypes[nodeType]||props.nodeTypes.default,isDraggable=!!(node.draggable||nodesDraggable&&void 0===node.draggable),isSelectable=!!(node.selectable||elementsSelectable&&void 0===node.selectable),isConnectable=!!(node.connectable||nodesConnectable&&void 0===node.connectable),isFocusable=!!(node.focusable||nodesFocusable&&void 0===node.focusable),clampedPosition=props.nodeExtent?clampPosition(node.positionAbsolute,props.nodeExtent):node.positionAbsolute,posX=clampedPosition?.x??0,posY=clampedPosition?.y??0,posOrigin=(({x,y,width,height,origin})=>width&&height?origin[0]<0||origin[1]<0||origin[0]>1||origin[1]>1?{x,y}:{x:x-width*origin[0],y:y-height*origin[1]}:{x,y})({x:posX,y:posY,width:node.width??0,height:node.height??0,origin:props.nodeOrigin});return(0,jsx_runtime.jsx)(NodeComponent,{id:node.id,className:node.className,style:node.style,type:nodeType,data:node.data,sourcePosition:node.sourcePosition||Position.Bottom,targetPosition:node.targetPosition||Position.Top,hidden:node.hidden,xPos:posX,yPos:posY,xPosOrigin:posOrigin.x,yPosOrigin:posOrigin.y,selectNodesOnDrag:props.selectNodesOnDrag,onClick:props.onNodeClick,onMouseEnter:props.onNodeMouseEnter,onMouseMove:props.onNodeMouseMove,onMouseLeave:props.onNodeMouseLeave,onContextMenu:props.onNodeContextMenu,onDoubleClick:props.onNodeDoubleClick,selected:!!node.selected,isDraggable,isSelectable,isConnectable,isFocusable,resizeObserver,dragHandle:node.dragHandle,zIndex:node[internalsSymbol]?.z??0,isParent:!!node[internalsSymbol]?.isParent,noDragClassName:props.noDragClassName,noPanClassName:props.noPanClassName,initialized:!!node.width&&!!node.height,rfId:props.rfId,disableKeyboardA11y:props.disableKeyboardA11y,ariaLabel:node.ariaLabel},node.id)}))})};NodeRenderer.displayName="NodeRenderer";var NodeRenderer$1=(0,react.memo)(NodeRenderer);const shiftX=(x,shift,position)=>position===Position.Left?x-shift:position===Position.Right?x+shift:x,shiftY=(y,shift,position)=>position===Position.Top?y-shift:position===Position.Bottom?y+shift:y,EdgeAnchor=({position,centerX,centerY,radius=10,onMouseDown,onMouseEnter,onMouseOut,type})=>(0,jsx_runtime.jsx)("circle",{onMouseDown,onMouseEnter,onMouseOut,className:cc(["react-flow__edgeupdater",`react-flow__edgeupdater-${type}`]),cx:shiftX(centerX,radius,position),cy:shiftY(centerY,radius,position),r:radius,stroke:"transparent",fill:"transparent"}),alwaysValidConnection=()=>!0;var wrapEdge=EdgeComponent=>{const EdgeWrapper=({id,className,type,data,onClick,onEdgeDoubleClick,selected,animated,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,style,source,target,sourceX,sourceY,targetX,targetY,sourcePosition,targetPosition,elementsSelectable,hidden,sourceHandleId,targetHandleId,onContextMenu,onMouseEnter,onMouseMove,onMouseLeave,edgeUpdaterRadius,onEdgeUpdate,onEdgeUpdateStart,onEdgeUpdateEnd,markerEnd,markerStart,rfId,ariaLabel,isFocusable,isUpdatable,pathOptions,interactionWidth})=>{const edgeRef=(0,react.useRef)(null),[updateHover,setUpdateHover]=(0,react.useState)(!1),[updating,setUpdating]=(0,react.useState)(!1),store=useStoreApi(),markerStartUrl=(0,react.useMemo)((()=>`url(#${getMarkerId(markerStart,rfId)})`),[markerStart,rfId]),markerEndUrl=(0,react.useMemo)((()=>`url(#${getMarkerId(markerEnd,rfId)})`),[markerEnd,rfId]);if(hidden)return null;const onEdgeDoubleClickHandler=getMouseHandler$1(id,store.getState,onEdgeDoubleClick),onEdgeContextMenu=getMouseHandler$1(id,store.getState,onContextMenu),onEdgeMouseEnter=getMouseHandler$1(id,store.getState,onMouseEnter),onEdgeMouseMove=getMouseHandler$1(id,store.getState,onMouseMove),onEdgeMouseLeave=getMouseHandler$1(id,store.getState,onMouseLeave),handleEdgeUpdater=(event,isSourceHandle)=>{if(0!==event.button)return;const{edges,isValidConnection:isValidConnectionStore}=store.getState(),nodeId=isSourceHandle?target:source,handleId=(isSourceHandle?targetHandleId:sourceHandleId)||null,handleType=isSourceHandle?"target":"source",isValidConnection=isValidConnectionStore||alwaysValidConnection,isTarget=isSourceHandle,edge=edges.find((e=>e.id===id));setUpdating(!0),onEdgeUpdateStart?.(event,edge,handleType);handlePointerDown({event,handleId,nodeId,onConnect:connection=>onEdgeUpdate?.(edge,connection),isTarget,getState:store.getState,setState:store.setState,isValidConnection,edgeUpdaterType:handleType,onEdgeUpdateEnd:evt=>{setUpdating(!1),onEdgeUpdateEnd?.(evt,edge,handleType)}})},onEdgeUpdaterMouseEnter=()=>setUpdateHover(!0),onEdgeUpdaterMouseOut=()=>setUpdateHover(!1),inactive=!elementsSelectable&&!onClick;return(0,jsx_runtime.jsxs)("g",{className:cc(["react-flow__edge",`react-flow__edge-${type}`,className,{selected,animated,inactive,updating:updateHover}]),onClick:event=>{const{edges,addSelectedEdges}=store.getState();if(elementsSelectable&&(store.setState({nodesSelectionActive:!1}),addSelectedEdges([id])),onClick){const edge=edges.find((e=>e.id===id));onClick(event,edge)}},onDoubleClick:onEdgeDoubleClickHandler,onContextMenu:onEdgeContextMenu,onMouseEnter:onEdgeMouseEnter,onMouseMove:onEdgeMouseMove,onMouseLeave:onEdgeMouseLeave,onKeyDown:isFocusable?event=>{if(elementSelectionKeys.includes(event.key)&&elementsSelectable){const{unselectNodesAndEdges,addSelectedEdges,edges}=store.getState();"Escape"===event.key?(edgeRef.current?.blur(),unselectNodesAndEdges({edges:[edges.find((e=>e.id===id))]})):addSelectedEdges([id])}}:void 0,tabIndex:isFocusable?0:void 0,role:isFocusable?"button":"img","data-testid":`rf__edge-${id}`,"aria-label":null===ariaLabel?void 0:ariaLabel||`Edge from ${source} to ${target}`,"aria-describedby":isFocusable?`react-flow__edge-desc-${rfId}`:void 0,ref:edgeRef,children:[!updating&&(0,jsx_runtime.jsx)(EdgeComponent,{id,source,target,selected,animated,label,labelStyle,labelShowBg,labelBgStyle,labelBgPadding,labelBgBorderRadius,data,style,sourceX,sourceY,targetX,targetY,sourcePosition,targetPosition,sourceHandleId,targetHandleId,markerStart:markerStartUrl,markerEnd:markerEndUrl,pathOptions,interactionWidth}),isUpdatable&&(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[("source"===isUpdatable||!0===isUpdatable)&&(0,jsx_runtime.jsx)(EdgeAnchor,{position:sourcePosition,centerX:sourceX,centerY:sourceY,radius:edgeUpdaterRadius,onMouseDown:event=>handleEdgeUpdater(event,!0),onMouseEnter:onEdgeUpdaterMouseEnter,onMouseOut:onEdgeUpdaterMouseOut,type:"source"}),("target"===isUpdatable||!0===isUpdatable)&&(0,jsx_runtime.jsx)(EdgeAnchor,{position:targetPosition,centerX:targetX,centerY:targetY,radius:edgeUpdaterRadius,onMouseDown:event=>handleEdgeUpdater(event,!1),onMouseEnter:onEdgeUpdaterMouseEnter,onMouseOut:onEdgeUpdaterMouseOut,type:"target"})]})]})};return EdgeWrapper.displayName="EdgeWrapper",(0,react.memo)(EdgeWrapper)};function createEdgeTypes(edgeTypes){return{...{default:wrapEdge(edgeTypes.default||BezierEdge),straight:wrapEdge(edgeTypes.bezier||StraightEdge),step:wrapEdge(edgeTypes.step||StepEdge),smoothstep:wrapEdge(edgeTypes.step||SmoothStepEdge),simplebezier:wrapEdge(edgeTypes.simplebezier||SimpleBezierEdge)},...Object.keys(edgeTypes).filter((k=>!["default","bezier"].includes(k))).reduce(((res,key)=>(res[key]=wrapEdge(edgeTypes[key]||BezierEdge),res)),{})}}function getHandlePosition(position,nodeRect,handle=null){const x=(handle?.x||0)+nodeRect.x,y=(handle?.y||0)+nodeRect.y,width=handle?.width||nodeRect.width,height=handle?.height||nodeRect.height;switch(position){case Position.Top:return{x:x+width/2,y};case Position.Right:return{x:x+width,y:y+height/2};case Position.Bottom:return{x:x+width/2,y:y+height};case Position.Left:return{x,y:y+height/2}}}function getHandle(bounds,handleId){return bounds?1!==bounds.length&&handleId?handleId&&bounds.find((d=>d.id===handleId))||null:bounds[0]:null}function getNodeData(node){const handleBounds=node?.[internalsSymbol]?.handleBounds||null,isValid=handleBounds&&node?.width&&node?.height&&void 0!==node?.positionAbsolute?.x&&void 0!==node?.positionAbsolute?.y;return[{x:node?.positionAbsolute?.x||0,y:node?.positionAbsolute?.y||0,width:node?.width||0,height:node?.height||0},handleBounds,!!isValid]}const defaultEdgeTree=[{level:0,isMaxLevel:!0,edges:[]}];function useVisibleEdges(onlyRenderVisible,nodeInternals,elevateEdgesOnSelect){const edges=useStore((0,react.useCallback)((s=>onlyRenderVisible?s.edges.filter((e=>{const sourceNode=nodeInternals.get(e.source),targetNode=nodeInternals.get(e.target);return sourceNode?.width&&sourceNode?.height&&targetNode?.width&&targetNode?.height&&function isEdgeVisible({sourcePos,targetPos,sourceWidth,sourceHeight,targetWidth,targetHeight,width,height,transform}){const edgeBox={x:Math.min(sourcePos.x,targetPos.x),y:Math.min(sourcePos.y,targetPos.y),x2:Math.max(sourcePos.x+sourceWidth,targetPos.x+targetWidth),y2:Math.max(sourcePos.y+sourceHeight,targetPos.y+targetHeight)};edgeBox.x===edgeBox.x2&&(edgeBox.x2+=1),edgeBox.y===edgeBox.y2&&(edgeBox.y2+=1);const viewBox=rectToBox({x:(0-transform[0])/transform[2],y:(0-transform[1])/transform[2],width:width/transform[2],height:height/transform[2]}),xOverlap=Math.max(0,Math.min(viewBox.x2,edgeBox.x2)-Math.max(viewBox.x,edgeBox.x)),yOverlap=Math.max(0,Math.min(viewBox.y2,edgeBox.y2)-Math.max(viewBox.y,edgeBox.y));return Math.ceil(xOverlap*yOverlap)>0}({sourcePos:sourceNode.positionAbsolute||{x:0,y:0},targetPos:targetNode.positionAbsolute||{x:0,y:0},sourceWidth:sourceNode.width,sourceHeight:sourceNode.height,targetWidth:targetNode.width,targetHeight:targetNode.height,width:s.width,height:s.height,transform:s.transform})})):s.edges),[onlyRenderVisible,nodeInternals]));return function groupEdgesByZLevel(edges,nodeInternals,elevateEdgesOnSelect=!1){let maxLevel=-1;const levelLookup=edges.reduce(((tree,edge)=>{const hasZIndex=isNumeric(edge.zIndex);let z=hasZIndex?edge.zIndex:0;if(elevateEdgesOnSelect){const targetNode=nodeInternals.get(edge.target),sourceNode=nodeInternals.get(edge.source),edgeOrConnectedNodeSelected=edge.selected||targetNode?.selected||sourceNode?.selected,selectedZIndex=Math.max(sourceNode?.[internalsSymbol]?.z||0,targetNode?.[internalsSymbol]?.z||0,1e3);z=(hasZIndex?edge.zIndex:0)+(edgeOrConnectedNodeSelected?selectedZIndex:0)}return tree[z]?tree[z].push(edge):tree[z]=[edge],maxLevel=z>maxLevel?z:maxLevel,tree}),{}),edgeTree=Object.entries(levelLookup).map((([key,edges])=>{const level=+key;return{edges,level,isMaxLevel:level===maxLevel}}));return 0===edgeTree.length?defaultEdgeTree:edgeTree}(edges,nodeInternals,elevateEdgesOnSelect)}const MarkerSymbols={[MarkerType.Arrow]:({color="none",strokeWidth=1})=>(0,jsx_runtime.jsx)("polyline",{stroke:color,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth,fill:"none",points:"-5,-4 0,0 -5,4"}),[MarkerType.ArrowClosed]:({color="none",strokeWidth=1})=>(0,jsx_runtime.jsx)("polyline",{stroke:color,strokeLinecap:"round",strokeLinejoin:"round",strokeWidth,fill:color,points:"-5,-4 0,0 -5,4 -5,-4"})};const Marker=({id,type,color,width=12.5,height=12.5,markerUnits="strokeWidth",strokeWidth,orient="auto-start-reverse"})=>{const Symbol=function useMarkerSymbol(type){const store=useStoreApi();return(0,react.useMemo)((()=>Object.prototype.hasOwnProperty.call(MarkerSymbols,type)?MarkerSymbols[type]:(store.getState().onError?.("009",errorMessages.error009(type)),null)),[type])}(type);return Symbol?(0,jsx_runtime.jsx)("marker",{className:"react-flow__arrowhead",id,markerWidth:`${width}`,markerHeight:`${height}`,viewBox:"-10 -10 20 20",markerUnits,orient,refX:"0",refY:"0",children:(0,jsx_runtime.jsx)(Symbol,{color,strokeWidth})}):null},MarkerDefinitions=({defaultColor,rfId})=>{const markers=useStore((0,react.useCallback)((({defaultColor,rfId})=>s=>{const ids=[];return s.edges.reduce(((markers,edge)=>([edge.markerStart,edge.markerEnd].forEach((marker=>{if(marker&&"object"==typeof marker){const markerId=getMarkerId(marker,rfId);ids.includes(markerId)||(markers.push({id:markerId,color:marker.color||defaultColor,...marker}),ids.push(markerId))}})),markers)),[]).sort(((a,b)=>a.id.localeCompare(b.id)))})({defaultColor,rfId}),[defaultColor,rfId]),((a,b)=>!(a.length!==b.length||a.some(((m,i)=>m.id!==b[i].id)))));return(0,jsx_runtime.jsx)("defs",{children:markers.map((marker=>(0,jsx_runtime.jsx)(Marker,{id:marker.id,type:marker.type,color:marker.color,width:marker.width,height:marker.height,markerUnits:marker.markerUnits,strokeWidth:marker.strokeWidth,orient:marker.orient},marker.id)))})};MarkerDefinitions.displayName="MarkerDefinitions";var MarkerDefinitions$1=(0,react.memo)(MarkerDefinitions);const selector$4=s=>({nodesConnectable:s.nodesConnectable,edgesFocusable:s.edgesFocusable,edgesUpdatable:s.edgesUpdatable,elementsSelectable:s.elementsSelectable,width:s.width,height:s.height,connectionMode:s.connectionMode,nodeInternals:s.nodeInternals,onError:s.onError}),EdgeRenderer=({defaultMarkerColor,onlyRenderVisibleElements,elevateEdgesOnSelect,rfId,edgeTypes,noPanClassName,onEdgeUpdate,onEdgeContextMenu,onEdgeMouseEnter,onEdgeMouseMove,onEdgeMouseLeave,onEdgeClick,edgeUpdaterRadius,onEdgeDoubleClick,onEdgeUpdateStart,onEdgeUpdateEnd,children})=>{const{edgesFocusable,edgesUpdatable,elementsSelectable,width,height,connectionMode,nodeInternals,onError}=useStore(selector$4,shallow_shallow),edgeTree=useVisibleEdges(onlyRenderVisibleElements,nodeInternals,elevateEdgesOnSelect);return width?(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[edgeTree.map((({level,edges,isMaxLevel})=>(0,jsx_runtime.jsxs)("svg",{style:{zIndex:level},width,height,className:"react-flow__edges react-flow__container",children:[isMaxLevel&&(0,jsx_runtime.jsx)(MarkerDefinitions$1,{defaultColor:defaultMarkerColor,rfId}),(0,jsx_runtime.jsx)("g",{children:edges.map((edge=>{const[sourceNodeRect,sourceHandleBounds,sourceIsValid]=getNodeData(nodeInternals.get(edge.source)),[targetNodeRect,targetHandleBounds,targetIsValid]=getNodeData(nodeInternals.get(edge.target));if(!sourceIsValid||!targetIsValid)return null;let edgeType=edge.type||"default";edgeTypes[edgeType]||(onError?.("011",errorMessages.error011(edgeType)),edgeType="default");const EdgeComponent=edgeTypes[edgeType]||edgeTypes.default,targetNodeHandles=connectionMode===ConnectionMode.Strict?targetHandleBounds.target:(targetHandleBounds.target??[]).concat(targetHandleBounds.source??[]),sourceHandle=getHandle(sourceHandleBounds.source,edge.sourceHandle),targetHandle=getHandle(targetNodeHandles,edge.targetHandle),sourcePosition=sourceHandle?.position||Position.Bottom,targetPosition=targetHandle?.position||Position.Top,isFocusable=!!(edge.focusable||edgesFocusable&&void 0===edge.focusable),isUpdatable=void 0!==onEdgeUpdate&&(edge.updatable||edgesUpdatable&&void 0===edge.updatable);if(!sourceHandle||!targetHandle)return onError?.("008",errorMessages.error008(sourceHandle,edge)),null;const{sourceX,sourceY,targetX,targetY}=((sourceNodeRect,sourceHandle,sourcePosition,targetNodeRect,targetHandle,targetPosition)=>{const sourceHandlePos=getHandlePosition(sourcePosition,sourceNodeRect,sourceHandle),targetHandlePos=getHandlePosition(targetPosition,targetNodeRect,targetHandle);return{sourceX:sourceHandlePos.x,sourceY:sourceHandlePos.y,targetX:targetHandlePos.x,targetY:targetHandlePos.y}})(sourceNodeRect,sourceHandle,sourcePosition,targetNodeRect,targetHandle,targetPosition);return(0,jsx_runtime.jsx)(EdgeComponent,{id:edge.id,className:cc([edge.className,noPanClassName]),type:edgeType,data:edge.data,selected:!!edge.selected,animated:!!edge.animated,hidden:!!edge.hidden,label:edge.label,labelStyle:edge.labelStyle,labelShowBg:edge.labelShowBg,labelBgStyle:edge.labelBgStyle,labelBgPadding:edge.labelBgPadding,labelBgBorderRadius:edge.labelBgBorderRadius,style:edge.style,source:edge.source,target:edge.target,sourceHandleId:edge.sourceHandle,targetHandleId:edge.targetHandle,markerEnd:edge.markerEnd,markerStart:edge.markerStart,sourceX,sourceY,targetX,targetY,sourcePosition,targetPosition,elementsSelectable,onEdgeUpdate,onContextMenu:onEdgeContextMenu,onMouseEnter:onEdgeMouseEnter,onMouseMove:onEdgeMouseMove,onMouseLeave:onEdgeMouseLeave,onClick:onEdgeClick,edgeUpdaterRadius,onEdgeDoubleClick,onEdgeUpdateStart,onEdgeUpdateEnd,rfId,ariaLabel:edge.ariaLabel,isFocusable,isUpdatable,pathOptions:"pathOptions"in edge?edge.pathOptions:void 0,interactionWidth:edge.interactionWidth},edge.id)}))})]},level))),children]}):null};EdgeRenderer.displayName="EdgeRenderer";var EdgeRenderer$1=(0,react.memo)(EdgeRenderer);const selector$3=s=>`translate(${s.transform[0]}px,${s.transform[1]}px) scale(${s.transform[2]})`;function Viewport({children}){const transform=useStore(selector$3);return(0,jsx_runtime.jsx)("div",{className:"react-flow__viewport react-flow__container",style:{transform},children})}const oppositePosition={[Position.Left]:Position.Right,[Position.Right]:Position.Left,[Position.Top]:Position.Bottom,[Position.Bottom]:Position.Top},ConnectionLine=({nodeId,handleType,style,type=ConnectionLineType.Bezier,CustomComponent,connectionStatus})=>{const{fromNode,handleId,toX,toY,connectionMode}=useStore((0,react.useCallback)((s=>({fromNode:s.nodeInternals.get(nodeId),handleId:s.connectionHandleId,toX:(s.connectionPosition.x-s.transform[0])/s.transform[2],toY:(s.connectionPosition.y-s.transform[1])/s.transform[2],connectionMode:s.connectionMode})),[nodeId]),shallow_shallow),fromHandleBounds=fromNode?.[internalsSymbol]?.handleBounds;let handleBounds=fromHandleBounds?.[handleType];if(connectionMode===ConnectionMode.Loose&&(handleBounds=handleBounds||fromHandleBounds?.["source"===handleType?"target":"source"]),!fromNode||!handleBounds)return null;const fromHandle=handleId?handleBounds.find((d=>d.id===handleId)):handleBounds[0],fromHandleX=fromHandle?fromHandle.x+fromHandle.width/2:(fromNode.width??0)/2,fromHandleY=fromHandle?fromHandle.y+fromHandle.height/2:fromNode.height??0,fromX=(fromNode.positionAbsolute?.x??0)+fromHandleX,fromY=(fromNode.positionAbsolute?.y??0)+fromHandleY,fromPosition=fromHandle?.position,toPosition=fromPosition?oppositePosition[fromPosition]:null;if(!fromPosition||!toPosition)return null;if(CustomComponent)return(0,jsx_runtime.jsx)(CustomComponent,{connectionLineType:type,connectionLineStyle:style,fromNode,fromHandle,fromX,fromY,toX,toY,fromPosition,toPosition,connectionStatus});let dAttr="";const pathParams={sourceX:fromX,sourceY:fromY,sourcePosition:fromPosition,targetX:toX,targetY:toY,targetPosition:toPosition};return type===ConnectionLineType.Bezier?[dAttr]=getBezierPath(pathParams):type===ConnectionLineType.Step?[dAttr]=getSmoothStepPath({...pathParams,borderRadius:0}):type===ConnectionLineType.SmoothStep?[dAttr]=getSmoothStepPath(pathParams):type===ConnectionLineType.SimpleBezier?[dAttr]=getSimpleBezierPath(pathParams):dAttr=`M${fromX},${fromY} ${toX},${toY}`,(0,jsx_runtime.jsx)("path",{d:dAttr,fill:"none",className:"react-flow__connection-path",style})};ConnectionLine.displayName="ConnectionLine";const selector$2=s=>({nodeId:s.connectionNodeId,handleType:s.connectionHandleType,nodesConnectable:s.nodesConnectable,connectionStatus:s.connectionStatus,width:s.width,height:s.height});function ConnectionLineWrapper({containerStyle,style,type,component}){const{nodeId,handleType,nodesConnectable,width,height,connectionStatus}=useStore(selector$2,shallow_shallow);return!!(nodeId&&handleType&&width&&nodesConnectable)?(0,jsx_runtime.jsx)("svg",{style:containerStyle,width,height,className:"react-flow__edges react-flow__connectionline react-flow__container",children:(0,jsx_runtime.jsx)("g",{className:cc(["react-flow__connection",connectionStatus]),children:(0,jsx_runtime.jsx)(ConnectionLine,{nodeId,handleType,style,type,CustomComponent:component,connectionStatus})})}):null}function useNodeOrEdgeTypes(nodeOrEdgeTypes,createTypes){(0,react.useRef)(null),useStoreApi();return(0,react.useMemo)((()=>createTypes(nodeOrEdgeTypes)),[nodeOrEdgeTypes])}const GraphView=({nodeTypes,edgeTypes,onMove,onMoveStart,onMoveEnd,onInit,onNodeClick,onEdgeClick,onNodeDoubleClick,onEdgeDoubleClick,onNodeMouseEnter,onNodeMouseMove,onNodeMouseLeave,onNodeContextMenu,onSelectionContextMenu,onSelectionStart,onSelectionEnd,connectionLineType,connectionLineStyle,connectionLineComponent,connectionLineContainerStyle,selectionKeyCode,selectionOnDrag,selectionMode,multiSelectionKeyCode,panActivationKeyCode,zoomActivationKeyCode,deleteKeyCode,onlyRenderVisibleElements,elementsSelectable,selectNodesOnDrag,defaultViewport,translateExtent,minZoom,maxZoom,preventScrolling,defaultMarkerColor,zoomOnScroll,zoomOnPinch,panOnScroll,panOnScrollSpeed,panOnScrollMode,zoomOnDoubleClick,panOnDrag,onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneScroll,onPaneContextMenu,onEdgeUpdate,onEdgeContextMenu,onEdgeMouseEnter,onEdgeMouseMove,onEdgeMouseLeave,edgeUpdaterRadius,onEdgeUpdateStart,onEdgeUpdateEnd,noDragClassName,noWheelClassName,noPanClassName,elevateEdgesOnSelect,disableKeyboardA11y,nodeOrigin,nodeExtent,rfId})=>{const nodeTypesWrapped=useNodeOrEdgeTypes(nodeTypes,createNodeTypes),edgeTypesWrapped=useNodeOrEdgeTypes(edgeTypes,createEdgeTypes);return function useOnInitHandler(onInit){const rfInstance=useReactFlow(),isInitialized=(0,react.useRef)(!1);(0,react.useEffect)((()=>{!isInitialized.current&&rfInstance.viewportInitialized&&onInit&&(setTimeout((()=>onInit(rfInstance)),1),isInitialized.current=!0)}),[onInit,rfInstance.viewportInitialized])}(onInit),(0,jsx_runtime.jsx)(FlowRenderer$1,{onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneContextMenu,onPaneScroll,deleteKeyCode,selectionKeyCode,selectionOnDrag,selectionMode,onSelectionStart,onSelectionEnd,multiSelectionKeyCode,panActivationKeyCode,zoomActivationKeyCode,elementsSelectable,onMove,onMoveStart,onMoveEnd,zoomOnScroll,zoomOnPinch,zoomOnDoubleClick,panOnScroll,panOnScrollSpeed,panOnScrollMode,panOnDrag,defaultViewport,translateExtent,minZoom,maxZoom,onSelectionContextMenu,preventScrolling,noDragClassName,noWheelClassName,noPanClassName,disableKeyboardA11y,children:(0,jsx_runtime.jsxs)(Viewport,{children:[(0,jsx_runtime.jsx)(EdgeRenderer$1,{edgeTypes:edgeTypesWrapped,onEdgeClick,onEdgeDoubleClick,onEdgeUpdate,onlyRenderVisibleElements,onEdgeContextMenu,onEdgeMouseEnter,onEdgeMouseMove,onEdgeMouseLeave,onEdgeUpdateStart,onEdgeUpdateEnd,edgeUpdaterRadius,defaultMarkerColor,noPanClassName,elevateEdgesOnSelect:!!elevateEdgesOnSelect,disableKeyboardA11y,rfId,children:(0,jsx_runtime.jsx)(ConnectionLineWrapper,{style:connectionLineStyle,type:connectionLineType,component:connectionLineComponent,containerStyle:connectionLineContainerStyle})}),(0,jsx_runtime.jsx)("div",{className:"react-flow__edgelabel-renderer"}),(0,jsx_runtime.jsx)(NodeRenderer$1,{nodeTypes:nodeTypesWrapped,onNodeClick,onNodeDoubleClick,onNodeMouseEnter,onNodeMouseMove,onNodeMouseLeave,onNodeContextMenu,selectNodesOnDrag,onlyRenderVisibleElements,noPanClassName,noDragClassName,disableKeyboardA11y,nodeOrigin,nodeExtent,rfId})]})})};GraphView.displayName="GraphView";var GraphView$1=(0,react.memo)(GraphView);const infiniteExtent=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],initialState={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:infiniteExtent,nodeExtent:infiniteExtent,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:ConnectionMode.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:devWarn,isValidConnection:void 0},createRFStore=()=>{return createState=(set,get)=>({...initialState,setNodes:nodes=>{const{nodeInternals,nodeOrigin,elevateNodesOnSelect}=get();set({nodeInternals:createNodeInternals(nodes,nodeInternals,nodeOrigin,elevateNodesOnSelect)})},getNodes:()=>Array.from(get().nodeInternals.values()),setEdges:edges=>{const{defaultEdgeOptions={}}=get();set({edges:edges.map((e=>({...defaultEdgeOptions,...e})))})},setDefaultNodesAndEdges:(nodes,edges)=>{const hasDefaultNodes=void 0!==nodes,hasDefaultEdges=void 0!==edges,nodeInternals=hasDefaultNodes?createNodeInternals(nodes,new Map,get().nodeOrigin,get().elevateNodesOnSelect):new Map;set({nodeInternals,edges:hasDefaultEdges?edges:[],hasDefaultNodes,hasDefaultEdges})},updateNodeDimensions:updates=>{const{onNodesChange,nodeInternals,fitViewOnInit,fitViewOnInitDone,fitViewOnInitOptions,domNode,nodeOrigin}=get(),viewportNode=domNode?.querySelector(".react-flow__viewport");if(!viewportNode)return;const style=window.getComputedStyle(viewportNode),{m22:zoom}=new window.DOMMatrixReadOnly(style.transform),changes=updates.reduce(((res,update)=>{const node=nodeInternals.get(update.id);if(node){const dimensions=getDimensions(update.nodeElement);dimensions.width&&dimensions.height&&(node.width!==dimensions.width||node.height!==dimensions.height||update.forceUpdate)&&(nodeInternals.set(node.id,{...node,[internalsSymbol]:{...node[internalsSymbol],handleBounds:{source:getHandleBounds(".source",update.nodeElement,zoom,nodeOrigin),target:getHandleBounds(".target",update.nodeElement,zoom,nodeOrigin)}},...dimensions}),res.push({id:node.id,type:"dimensions",dimensions}))}return res}),[]);updateAbsoluteNodePositions(nodeInternals,nodeOrigin);const nextFitViewOnInitDone=fitViewOnInitDone||fitViewOnInit&&!fitViewOnInitDone&&fitView(get,{initial:!0,...fitViewOnInitOptions});set({nodeInternals:new Map(nodeInternals),fitViewOnInitDone:nextFitViewOnInitDone}),changes?.length>0&&onNodesChange?.(changes)},updateNodePositions:(nodeDragItems,positionChanged=!0,dragging=!1)=>{const{triggerNodeChanges}=get(),changes=nodeDragItems.map((node=>{const change={id:node.id,type:"position",dragging};return positionChanged&&(change.positionAbsolute=node.positionAbsolute,change.position=node.position),change}));triggerNodeChanges(changes)},triggerNodeChanges:changes=>{const{onNodesChange,nodeInternals,hasDefaultNodes,nodeOrigin,getNodes,elevateNodesOnSelect}=get();if(changes?.length){if(hasDefaultNodes){const nextNodeInternals=createNodeInternals(applyNodeChanges(changes,getNodes()),nodeInternals,nodeOrigin,elevateNodesOnSelect);set({nodeInternals:nextNodeInternals})}onNodesChange?.(changes)}},addSelectedNodes:selectedNodeIds=>{const{multiSelectionActive,edges,getNodes}=get();let changedNodes,changedEdges=null;multiSelectionActive?changedNodes=selectedNodeIds.map((nodeId=>createSelectionChange(nodeId,!0))):(changedNodes=getSelectionChanges(getNodes(),selectedNodeIds),changedEdges=getSelectionChanges(edges,[])),updateNodesAndEdgesSelections({changedNodes,changedEdges,get,set})},addSelectedEdges:selectedEdgeIds=>{const{multiSelectionActive,edges,getNodes}=get();let changedEdges,changedNodes=null;multiSelectionActive?changedEdges=selectedEdgeIds.map((edgeId=>createSelectionChange(edgeId,!0))):(changedEdges=getSelectionChanges(edges,selectedEdgeIds),changedNodes=getSelectionChanges(getNodes(),[])),updateNodesAndEdgesSelections({changedNodes,changedEdges,get,set})},unselectNodesAndEdges:({nodes,edges}={})=>{const{edges:storeEdges,getNodes}=get(),edgesToUnselect=edges||storeEdges;updateNodesAndEdgesSelections({changedNodes:(nodes||getNodes()).map((n=>(n.selected=!1,createSelectionChange(n.id,!1)))),changedEdges:edgesToUnselect.map((edge=>createSelectionChange(edge.id,!1))),get,set})},setMinZoom:minZoom=>{const{d3Zoom,maxZoom}=get();d3Zoom?.scaleExtent([minZoom,maxZoom]),set({minZoom})},setMaxZoom:maxZoom=>{const{d3Zoom,minZoom}=get();d3Zoom?.scaleExtent([minZoom,maxZoom]),set({maxZoom})},setTranslateExtent:translateExtent=>{get().d3Zoom?.translateExtent(translateExtent),set({translateExtent})},resetSelectedElements:()=>{const{edges,getNodes}=get();updateNodesAndEdgesSelections({changedNodes:getNodes().filter((e=>e.selected)).map((n=>createSelectionChange(n.id,!1))),changedEdges:edges.filter((e=>e.selected)).map((e=>createSelectionChange(e.id,!1))),get,set})},setNodeExtent:nodeExtent=>{const{nodeInternals}=get();nodeInternals.forEach((node=>{node.positionAbsolute=clampPosition(node.position,nodeExtent)})),set({nodeExtent,nodeInternals:new Map(nodeInternals)})},panBy:delta=>{const{transform,width,height,d3Zoom,d3Selection,translateExtent}=get();if(!d3Zoom||!d3Selection||!delta.x&&!delta.y)return!1;const nextTransform=transform_identity.translate(transform[0]+delta.x,transform[1]+delta.y).scale(transform[2]),extent=[[0,0],[width,height]],constrainedTransform=d3Zoom?.constrain()(nextTransform,extent,translateExtent);return d3Zoom.transform(d3Selection,constrainedTransform),transform[0]!==constrainedTransform.x||transform[1]!==constrainedTransform.y||transform[2]!==constrainedTransform.k},cancelConnection:()=>set({connectionNodeId:initialState.connectionNodeId,connectionHandleId:initialState.connectionHandleId,connectionHandleType:initialState.connectionHandleType,connectionStatus:initialState.connectionStatus,connectionStartHandle:initialState.connectionStartHandle,connectionEndHandle:initialState.connectionEndHandle}),reset:()=>set({...initialState})}),defaultEqualityFn=Object.is,createState?createWithEqualityFnImpl(createState,defaultEqualityFn):createWithEqualityFnImpl;var createState,defaultEqualityFn},ReactFlowProvider=({children})=>{const storeRef=(0,react.useRef)(null);return storeRef.current||(storeRef.current=createRFStore()),(0,jsx_runtime.jsx)(Provider$1,{value:storeRef.current,children})};ReactFlowProvider.displayName="ReactFlowProvider";const Wrapper=({children})=>(0,react.useContext)(StoreContext)?(0,jsx_runtime.jsx)(jsx_runtime.Fragment,{children}):(0,jsx_runtime.jsx)(ReactFlowProvider,{children});Wrapper.displayName="ReactFlowWrapper";const defaultNodeTypes={input:InputNode$1,default:DefaultNode$1,output:OutputNode$1,group:GroupNode},defaultEdgeTypes={default:BezierEdge,straight:StraightEdge,step:StepEdge,smoothstep:SmoothStepEdge,simplebezier:SimpleBezierEdge},initNodeOrigin=[0,0],initSnapGrid=[15,15],initDefaultViewport={x:0,y:0,zoom:1},wrapperStyle={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},ReactFlow=(0,react.forwardRef)((({nodes,edges,defaultNodes,defaultEdges,className,nodeTypes=defaultNodeTypes,edgeTypes=defaultEdgeTypes,onNodeClick,onEdgeClick,onInit,onMove,onMoveStart,onMoveEnd,onConnect,onConnectStart,onConnectEnd,onClickConnectStart,onClickConnectEnd,onNodeMouseEnter,onNodeMouseMove,onNodeMouseLeave,onNodeContextMenu,onNodeDoubleClick,onNodeDragStart,onNodeDrag,onNodeDragStop,onNodesDelete,onEdgesDelete,onSelectionChange,onSelectionDragStart,onSelectionDrag,onSelectionDragStop,onSelectionContextMenu,onSelectionStart,onSelectionEnd,connectionMode=ConnectionMode.Strict,connectionLineType=ConnectionLineType.Bezier,connectionLineStyle,connectionLineComponent,connectionLineContainerStyle,deleteKeyCode="Backspace",selectionKeyCode="Shift",selectionOnDrag=!1,selectionMode=SelectionMode.Full,panActivationKeyCode="Space",multiSelectionKeyCode=isMacOs()?"Meta":"Control",zoomActivationKeyCode=isMacOs()?"Meta":"Control",snapToGrid=!1,snapGrid=initSnapGrid,onlyRenderVisibleElements=!1,selectNodesOnDrag=!0,nodesDraggable,nodesConnectable,nodesFocusable,nodeOrigin=initNodeOrigin,edgesFocusable,edgesUpdatable,elementsSelectable,defaultViewport=initDefaultViewport,minZoom=.5,maxZoom=2,translateExtent=infiniteExtent,preventScrolling=!0,nodeExtent,defaultMarkerColor="#b1b1b7",zoomOnScroll=!0,zoomOnPinch=!0,panOnScroll=!1,panOnScrollSpeed=.5,panOnScrollMode=PanOnScrollMode.Free,zoomOnDoubleClick=!0,panOnDrag=!0,onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneScroll,onPaneContextMenu,children,onEdgeUpdate,onEdgeContextMenu,onEdgeDoubleClick,onEdgeMouseEnter,onEdgeMouseMove,onEdgeMouseLeave,onEdgeUpdateStart,onEdgeUpdateEnd,edgeUpdaterRadius=10,onNodesChange,onEdgesChange,noDragClassName="nodrag",noWheelClassName="nowheel",noPanClassName="nopan",fitView=!1,fitViewOptions,connectOnClick=!0,attributionPosition,proOptions,defaultEdgeOptions,elevateNodesOnSelect=!0,elevateEdgesOnSelect=!1,disableKeyboardA11y=!1,autoPanOnConnect=!0,autoPanOnNodeDrag=!0,connectionRadius=20,isValidConnection,onError,style,id,...rest},ref)=>{const rfId=id||"1";return(0,jsx_runtime.jsx)("div",{...rest,style:{...style,...wrapperStyle},ref,className:cc(["react-flow",className]),"data-testid":"rf__wrapper",id,children:(0,jsx_runtime.jsxs)(Wrapper,{children:[(0,jsx_runtime.jsx)(GraphView$1,{onInit,onMove,onMoveStart,onMoveEnd,onNodeClick,onEdgeClick,onNodeMouseEnter,onNodeMouseMove,onNodeMouseLeave,onNodeContextMenu,onNodeDoubleClick,nodeTypes,edgeTypes,connectionLineType,connectionLineStyle,connectionLineComponent,connectionLineContainerStyle,selectionKeyCode,selectionOnDrag,selectionMode,deleteKeyCode,multiSelectionKeyCode,panActivationKeyCode,zoomActivationKeyCode,onlyRenderVisibleElements,selectNodesOnDrag,defaultViewport,translateExtent,minZoom,maxZoom,preventScrolling,zoomOnScroll,zoomOnPinch,zoomOnDoubleClick,panOnScroll,panOnScrollSpeed,panOnScrollMode,panOnDrag,onPaneClick,onPaneMouseEnter,onPaneMouseMove,onPaneMouseLeave,onPaneScroll,onPaneContextMenu,onSelectionContextMenu,onSelectionStart,onSelectionEnd,onEdgeUpdate,onEdgeContextMenu,onEdgeDoubleClick,onEdgeMouseEnter,onEdgeMouseMove,onEdgeMouseLeave,onEdgeUpdateStart,onEdgeUpdateEnd,edgeUpdaterRadius,defaultMarkerColor,noDragClassName,noWheelClassName,noPanClassName,elevateEdgesOnSelect,rfId,disableKeyboardA11y,nodeOrigin,nodeExtent}),(0,jsx_runtime.jsx)(StoreUpdater,{nodes,edges,defaultNodes,defaultEdges,onConnect,onConnectStart,onConnectEnd,onClickConnectStart,onClickConnectEnd,nodesDraggable,nodesConnectable,nodesFocusable,edgesFocusable,edgesUpdatable,elementsSelectable,elevateNodesOnSelect,minZoom,maxZoom,nodeExtent,onNodesChange,onEdgesChange,snapToGrid,snapGrid,connectionMode,translateExtent,connectOnClick,defaultEdgeOptions,fitView,fitViewOptions,onNodesDelete,onEdgesDelete,onNodeDragStart,onNodeDrag,onNodeDragStop,onSelectionDrag,onSelectionDragStart,onSelectionDragStop,noPanClassName,nodeOrigin,rfId,autoPanOnConnect,autoPanOnNodeDrag,onError,connectionRadius,isValidConnection}),(0,jsx_runtime.jsx)(Wrapper$1,{onSelectionChange}),children,(0,jsx_runtime.jsx)(Attribution,{proOptions,position:attributionPosition}),(0,jsx_runtime.jsx)(A11yDescriptions,{rfId,disableKeyboardA11y})]})})}));ReactFlow.displayName="ReactFlow";const nodesSelector=state=>state.getNodes();function useNodes(){return useStore(nodesSelector,shallow_shallow)}function createUseItemsState(applyChanges){return initialItems=>{const[items,setItems]=(0,react.useState)(initialItems),onItemsChange=(0,react.useCallback)((changes=>setItems((items=>applyChanges(changes,items)))),[]);return[items,setItems,onItemsChange]}}createUseItemsState(applyNodeChanges),createUseItemsState((function applyEdgeChanges(changes,edges){return applyChanges(changes,edges)}))},"./node_modules/heap/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/heap/lib/heap.js")},"./node_modules/heap/lib/heap.js":function(module,__unused_webpack_exports,__webpack_require__){module=__webpack_require__.nmd(module),function(){var Heap,defaultCmp,floor,heapify,heappop,heappush,heappushpop,heapreplace,insort,min,nlargest,nsmallest,updateItem,_siftdown,_siftup;floor=Math.floor,min=Math.min,defaultCmp=function(x,y){return x<y?-1:x>y?1:0},insort=function(a,x,lo,hi,cmp){var mid;if(null==lo&&(lo=0),null==cmp&&(cmp=defaultCmp),lo<0)throw new Error("lo must be non-negative");for(null==hi&&(hi=a.length);lo<hi;)cmp(x,a[mid=floor((lo+hi)/2)])<0?hi=mid:lo=mid+1;return[].splice.apply(a,[lo,lo-lo].concat(x)),x},heappush=function(array,item,cmp){return null==cmp&&(cmp=defaultCmp),array.push(item),_siftdown(array,0,array.length-1,cmp)},heappop=function(array,cmp){var lastelt,returnitem;return null==cmp&&(cmp=defaultCmp),lastelt=array.pop(),array.length?(returnitem=array[0],array[0]=lastelt,_siftup(array,0,cmp)):returnitem=lastelt,returnitem},heapreplace=function(array,item,cmp){var returnitem;return null==cmp&&(cmp=defaultCmp),returnitem=array[0],array[0]=item,_siftup(array,0,cmp),returnitem},heappushpop=function(array,item,cmp){var _ref;return null==cmp&&(cmp=defaultCmp),array.length&&cmp(array[0],item)<0&&(item=(_ref=[array[0],item])[0],array[0]=_ref[1],_siftup(array,0,cmp)),item},heapify=function(array,cmp){var i,_i,_len,_ref1,_results,_results1;for(null==cmp&&(cmp=defaultCmp),_ref1=function(){_results1=[];for(var _j=0,_ref=floor(array.length/2);0<=_ref?_j<_ref:_j>_ref;0<=_ref?_j++:_j--)_results1.push(_j);return _results1}.apply(this).reverse(),_results=[],_i=0,_len=_ref1.length;_i<_len;_i++)i=_ref1[_i],_results.push(_siftup(array,i,cmp));return _results},updateItem=function(array,item,cmp){var pos;if(null==cmp&&(cmp=defaultCmp),-1!==(pos=array.indexOf(item)))return _siftdown(array,0,pos,cmp),_siftup(array,pos,cmp)},nlargest=function(array,n,cmp){var elem,result,_i,_len,_ref;if(null==cmp&&(cmp=defaultCmp),!(result=array.slice(0,n)).length)return result;for(heapify(result,cmp),_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)elem=_ref[_i],heappushpop(result,elem,cmp);return result.sort(cmp).reverse()},nsmallest=function(array,n,cmp){var elem,los,result,_i,_j,_len,_ref,_ref1,_results;if(null==cmp&&(cmp=defaultCmp),10*n<=array.length){if(!(result=array.slice(0,n).sort(cmp)).length)return result;for(los=result[result.length-1],_i=0,_len=(_ref=array.slice(n)).length;_i<_len;_i++)cmp(elem=_ref[_i],los)<0&&(insort(result,elem,0,null,cmp),result.pop(),los=result[result.length-1]);return result}for(heapify(array,cmp),_results=[],_j=0,_ref1=min(n,array.length);0<=_ref1?_j<_ref1:_j>_ref1;0<=_ref1?++_j:--_j)_results.push(heappop(array,cmp));return _results},_siftdown=function(array,startpos,pos,cmp){var newitem,parent,parentpos;for(null==cmp&&(cmp=defaultCmp),newitem=array[pos];pos>startpos&&cmp(newitem,parent=array[parentpos=pos-1>>1])<0;)array[pos]=parent,pos=parentpos;return array[pos]=newitem},_siftup=function(array,pos,cmp){var childpos,endpos,newitem,rightpos,startpos;for(null==cmp&&(cmp=defaultCmp),endpos=array.length,startpos=pos,newitem=array[pos],childpos=2*pos+1;childpos<endpos;)(rightpos=childpos+1)<endpos&&!(cmp(array[childpos],array[rightpos])<0)&&(childpos=rightpos),array[pos]=array[childpos],childpos=2*(pos=childpos)+1;return array[pos]=newitem,_siftdown(array,startpos,pos,cmp)},Heap=function(){function Heap(cmp){this.cmp=null!=cmp?cmp:defaultCmp,this.nodes=[]}return Heap.push=heappush,Heap.pop=heappop,Heap.replace=heapreplace,Heap.pushpop=heappushpop,Heap.heapify=heapify,Heap.updateItem=updateItem,Heap.nlargest=nlargest,Heap.nsmallest=nsmallest,Heap.prototype.push=function(x){return heappush(this.nodes,x,this.cmp)},Heap.prototype.pop=function(){return heappop(this.nodes,this.cmp)},Heap.prototype.peek=function(){return this.nodes[0]},Heap.prototype.contains=function(x){return-1!==this.nodes.indexOf(x)},Heap.prototype.replace=function(x){return heapreplace(this.nodes,x,this.cmp)},Heap.prototype.pushpop=function(x){return heappushpop(this.nodes,x,this.cmp)},Heap.prototype.heapify=function(){return heapify(this.nodes,this.cmp)},Heap.prototype.updateItem=function(x){return updateItem(this.nodes,x,this.cmp)},Heap.prototype.clear=function(){return this.nodes=[]},Heap.prototype.empty=function(){return 0===this.nodes.length},Heap.prototype.size=function(){return this.nodes.length},Heap.prototype.clone=function(){var heap;return(heap=new Heap).nodes=this.nodes.slice(0),heap},Heap.prototype.toArray=function(){return this.nodes.slice(0)},Heap.prototype.insert=Heap.prototype.push,Heap.prototype.top=Heap.prototype.peek,Heap.prototype.front=Heap.prototype.peek,Heap.prototype.has=Heap.prototype.contains,Heap.prototype.copy=Heap.prototype.clone,Heap}(),(null!==module?module.exports:void 0)?module.exports=Heap:window.Heap=Heap}.call(this)},"./node_modules/pathfinding/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports=__webpack_require__("./node_modules/pathfinding/src/PathFinding.js")},"./node_modules/pathfinding/src/PathFinding.js":(module,__unused_webpack_exports,__webpack_require__)=>{module.exports={Heap:__webpack_require__("./node_modules/heap/index.js"),Node:__webpack_require__("./node_modules/pathfinding/src/core/Node.js"),Grid:__webpack_require__("./node_modules/pathfinding/src/core/Grid.js"),Util:__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),DiagonalMovement:__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js"),Heuristic:__webpack_require__("./node_modules/pathfinding/src/core/Heuristic.js"),AStarFinder:__webpack_require__("./node_modules/pathfinding/src/finders/AStarFinder.js"),BestFirstFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BestFirstFinder.js"),BreadthFirstFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BreadthFirstFinder.js"),DijkstraFinder:__webpack_require__("./node_modules/pathfinding/src/finders/DijkstraFinder.js"),BiAStarFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BiAStarFinder.js"),BiBestFirstFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BiBestFirstFinder.js"),BiBreadthFirstFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BiBreadthFirstFinder.js"),BiDijkstraFinder:__webpack_require__("./node_modules/pathfinding/src/finders/BiDijkstraFinder.js"),IDAStarFinder:__webpack_require__("./node_modules/pathfinding/src/finders/IDAStarFinder.js"),JumpPointFinder:__webpack_require__("./node_modules/pathfinding/src/finders/JumpPointFinder.js")}},"./node_modules/pathfinding/src/core/DiagonalMovement.js":module=>{module.exports={Always:1,Never:2,IfAtMostOneObstacle:3,OnlyWhenNoObstacles:4}},"./node_modules/pathfinding/src/core/Grid.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Node=__webpack_require__("./node_modules/pathfinding/src/core/Node.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function Grid(width_or_matrix,height,matrix){var width;"object"!=typeof width_or_matrix?width=width_or_matrix:(height=width_or_matrix.length,width=width_or_matrix[0].length,matrix=width_or_matrix),this.width=width,this.height=height,this.nodes=this._buildNodes(width,height,matrix)}Grid.prototype._buildNodes=function(width,height,matrix){var i,j,nodes=new Array(height);for(i=0;i<height;++i)for(nodes[i]=new Array(width),j=0;j<width;++j)nodes[i][j]=new Node(j,i);if(void 0===matrix)return nodes;if(matrix.length!==height||matrix[0].length!==width)throw new Error("Matrix size does not fit");for(i=0;i<height;++i)for(j=0;j<width;++j)matrix[i][j]&&(nodes[i][j].walkable=!1);return nodes},Grid.prototype.getNodeAt=function(x,y){return this.nodes[y][x]},Grid.prototype.isWalkableAt=function(x,y){return this.isInside(x,y)&&this.nodes[y][x].walkable},Grid.prototype.isInside=function(x,y){return x>=0&&x<this.width&&y>=0&&y<this.height},Grid.prototype.setWalkableAt=function(x,y,walkable){this.nodes[y][x].walkable=walkable},Grid.prototype.getNeighbors=function(node,diagonalMovement){var x=node.x,y=node.y,neighbors=[],s0=!1,d0=!1,s1=!1,d1=!1,s2=!1,d2=!1,s3=!1,d3=!1,nodes=this.nodes;if(this.isWalkableAt(x,y-1)&&(neighbors.push(nodes[y-1][x]),s0=!0),this.isWalkableAt(x+1,y)&&(neighbors.push(nodes[y][x+1]),s1=!0),this.isWalkableAt(x,y+1)&&(neighbors.push(nodes[y+1][x]),s2=!0),this.isWalkableAt(x-1,y)&&(neighbors.push(nodes[y][x-1]),s3=!0),diagonalMovement===DiagonalMovement.Never)return neighbors;if(diagonalMovement===DiagonalMovement.OnlyWhenNoObstacles)d0=s3&&s0,d1=s0&&s1,d2=s1&&s2,d3=s2&&s3;else if(diagonalMovement===DiagonalMovement.IfAtMostOneObstacle)d0=s3||s0,d1=s0||s1,d2=s1||s2,d3=s2||s3;else{if(diagonalMovement!==DiagonalMovement.Always)throw new Error("Incorrect value of diagonalMovement");d0=!0,d1=!0,d2=!0,d3=!0}return d0&&this.isWalkableAt(x-1,y-1)&&neighbors.push(nodes[y-1][x-1]),d1&&this.isWalkableAt(x+1,y-1)&&neighbors.push(nodes[y-1][x+1]),d2&&this.isWalkableAt(x+1,y+1)&&neighbors.push(nodes[y+1][x+1]),d3&&this.isWalkableAt(x-1,y+1)&&neighbors.push(nodes[y+1][x-1]),neighbors},Grid.prototype.clone=function(){var i,j,width=this.width,height=this.height,thisNodes=this.nodes,newGrid=new Grid(width,height),newNodes=new Array(height);for(i=0;i<height;++i)for(newNodes[i]=new Array(width),j=0;j<width;++j)newNodes[i][j]=new Node(j,i,thisNodes[i][j].walkable);return newGrid.nodes=newNodes,newGrid},module.exports=Grid},"./node_modules/pathfinding/src/core/Heuristic.js":module=>{module.exports={manhattan:function(dx,dy){return dx+dy},euclidean:function(dx,dy){return Math.sqrt(dx*dx+dy*dy)},octile:function(dx,dy){var F=Math.SQRT2-1;return dx<dy?F*dx+dy:F*dy+dx},chebyshev:function(dx,dy){return Math.max(dx,dy)}}},"./node_modules/pathfinding/src/core/Node.js":module=>{module.exports=function Node(x,y,walkable){this.x=x,this.y=y,this.walkable=void 0===walkable||walkable}},"./node_modules/pathfinding/src/core/Util.js":(__unused_webpack_module,exports)=>{function backtrace(node){for(var path=[[node.x,node.y]];node.parent;)node=node.parent,path.push([node.x,node.y]);return path.reverse()}function interpolate(x0,y0,x1,y1){var sx,sy,dx,dy,err,e2,abs=Math.abs,line=[];for(sx=x0<x1?1:-1,sy=y0<y1?1:-1,err=(dx=abs(x1-x0))-(dy=abs(y1-y0));line.push([x0,y0]),x0!==x1||y0!==y1;)(e2=2*err)>-dy&&(err-=dy,x0+=sx),e2<dx&&(err+=dx,y0+=sy);return line}exports.backtrace=backtrace,exports.biBacktrace=function biBacktrace(nodeA,nodeB){var pathA=backtrace(nodeA),pathB=backtrace(nodeB);return pathA.concat(pathB.reverse())},exports.pathLength=function pathLength(path){var i,a,b,dx,dy,sum=0;for(i=1;i<path.length;++i)a=path[i-1],b=path[i],dx=a[0]-b[0],dy=a[1]-b[1],sum+=Math.sqrt(dx*dx+dy*dy);return sum},exports.interpolate=interpolate,exports.expandPath=function expandPath(path){var coord0,coord1,interpolated,interpolatedLen,i,j,expanded=[],len=path.length;if(len<2)return expanded;for(i=0;i<len-1;++i)for(coord0=path[i],coord1=path[i+1],interpolatedLen=(interpolated=interpolate(coord0[0],coord0[1],coord1[0],coord1[1])).length,j=0;j<interpolatedLen-1;++j)expanded.push(interpolated[j]);return expanded.push(path[len-1]),expanded},exports.smoothenPath=function smoothenPath(grid,path){var sx,sy,newPath,i,j,coord,line,testCoord,blocked,len=path.length,x0=path[0][0],y0=path[0][1],x1=path[len-1][0],y1=path[len-1][1];for(newPath=[[sx=x0,sy=y0]],i=2;i<len;++i){for(line=interpolate(sx,sy,(coord=path[i])[0],coord[1]),blocked=!1,j=1;j<line.length;++j)if(testCoord=line[j],!grid.isWalkableAt(testCoord[0],testCoord[1])){blocked=!0;break}blocked&&(lastValidCoord=path[i-1],newPath.push(lastValidCoord),sx=lastValidCoord[0],sy=lastValidCoord[1])}return newPath.push([x1,y1]),newPath},exports.compressPath=function compressPath(path){if(path.length<3)return path;var lx,ly,ldx,ldy,sq,i,compressed=[],sx=path[0][0],sy=path[0][1],px=path[1][0],py=path[1][1],dx=px-sx,dy=py-sy;for(dx/=sq=Math.sqrt(dx*dx+dy*dy),dy/=sq,compressed.push([sx,sy]),i=2;i<path.length;i++)lx=px,ly=py,ldx=dx,ldy=dy,dx=(px=path[i][0])-lx,dy=(py=path[i][1])-ly,dy/=sq=Math.sqrt(dx*dx+dy*dy),(dx/=sq)===ldx&&dy===ldy||compressed.push([lx,ly]);return compressed.push([px,py]),compressed}},"./node_modules/pathfinding/src/finders/AStarFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Heap=__webpack_require__("./node_modules/heap/index.js"),Util=__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),Heuristic=__webpack_require__("./node_modules/pathfinding/src/core/Heuristic.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function AStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}AStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var node,neighbors,neighbor,i,l,x,y,ng,openList=new Heap((function(nodeA,nodeB){return nodeA.f-nodeB.f})),startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),heuristic=this.heuristic,diagonalMovement=this.diagonalMovement,weight=this.weight,abs=Math.abs,SQRT2=Math.SQRT2;for(startNode.g=0,startNode.f=0,openList.push(startNode),startNode.opened=!0;!openList.empty();){if((node=openList.pop()).closed=!0,node===endNode)return Util.backtrace(endNode);for(i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)(neighbor=neighbors[i]).closed||(x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-endX),abs(y-endY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?openList.updateItem(neighbor):(openList.push(neighbor),neighbor.opened=!0)))}return[]},module.exports=AStarFinder},"./node_modules/pathfinding/src/finders/BestFirstFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var AStarFinder=__webpack_require__("./node_modules/pathfinding/src/finders/AStarFinder.js");function BestFirstFinder(opt){AStarFinder.call(this,opt);var orig=this.heuristic;this.heuristic=function(dx,dy){return 1e6*orig(dx,dy)}}BestFirstFinder.prototype=new AStarFinder,BestFirstFinder.prototype.constructor=BestFirstFinder,module.exports=BestFirstFinder},"./node_modules/pathfinding/src/finders/BiAStarFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Heap=__webpack_require__("./node_modules/heap/index.js"),Util=__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),Heuristic=__webpack_require__("./node_modules/pathfinding/src/core/Heuristic.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function BiAStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}BiAStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var node,neighbors,neighbor,i,l,x,y,ng,cmp=function(nodeA,nodeB){return nodeA.f-nodeB.f},startOpenList=new Heap(cmp),endOpenList=new Heap(cmp),startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),heuristic=this.heuristic,diagonalMovement=this.diagonalMovement,weight=this.weight,abs=Math.abs,SQRT2=Math.SQRT2;for(startNode.g=0,startNode.f=0,startOpenList.push(startNode),startNode.opened=1,endNode.g=0,endNode.f=0,endOpenList.push(endNode),endNode.opened=2;!startOpenList.empty()&&!endOpenList.empty();){for((node=startOpenList.pop()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed){if(2===neighbor.opened)return Util.biBacktrace(node,neighbor);x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-endX),abs(y-endY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?startOpenList.updateItem(neighbor):(startOpenList.push(neighbor),neighbor.opened=1))}for((node=endOpenList.pop()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed){if(1===neighbor.opened)return Util.biBacktrace(neighbor,node);x=neighbor.x,y=neighbor.y,ng=node.g+(x-node.x==0||y-node.y==0?1:SQRT2),(!neighbor.opened||ng<neighbor.g)&&(neighbor.g=ng,neighbor.h=neighbor.h||weight*heuristic(abs(x-startX),abs(y-startY)),neighbor.f=neighbor.g+neighbor.h,neighbor.parent=node,neighbor.opened?endOpenList.updateItem(neighbor):(endOpenList.push(neighbor),neighbor.opened=2))}}return[]},module.exports=BiAStarFinder},"./node_modules/pathfinding/src/finders/BiBestFirstFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var BiAStarFinder=__webpack_require__("./node_modules/pathfinding/src/finders/BiAStarFinder.js");function BiBestFirstFinder(opt){BiAStarFinder.call(this,opt);var orig=this.heuristic;this.heuristic=function(dx,dy){return 1e6*orig(dx,dy)}}BiBestFirstFinder.prototype=new BiAStarFinder,BiBestFirstFinder.prototype.constructor=BiBestFirstFinder,module.exports=BiBestFirstFinder},"./node_modules/pathfinding/src/finders/BiBreadthFirstFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Util=__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function BiBreadthFirstFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never)}BiBreadthFirstFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var neighbors,neighbor,node,i,l,startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY),startOpenList=[],endOpenList=[],diagonalMovement=this.diagonalMovement;for(startOpenList.push(startNode),startNode.opened=!0,startNode.by=0,endOpenList.push(endNode),endNode.opened=!0,endNode.by=1;startOpenList.length&&endOpenList.length;){for((node=startOpenList.shift()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed)if(neighbor.opened){if(1===neighbor.by)return Util.biBacktrace(node,neighbor)}else startOpenList.push(neighbor),neighbor.parent=node,neighbor.opened=!0,neighbor.by=0;for((node=endOpenList.shift()).closed=!0,i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)if(!(neighbor=neighbors[i]).closed)if(neighbor.opened){if(0===neighbor.by)return Util.biBacktrace(neighbor,node)}else endOpenList.push(neighbor),neighbor.parent=node,neighbor.opened=!0,neighbor.by=1}return[]},module.exports=BiBreadthFirstFinder},"./node_modules/pathfinding/src/finders/BiDijkstraFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var BiAStarFinder=__webpack_require__("./node_modules/pathfinding/src/finders/BiAStarFinder.js");function BiDijkstraFinder(opt){BiAStarFinder.call(this,opt),this.heuristic=function(dx,dy){return 0}}BiDijkstraFinder.prototype=new BiAStarFinder,BiDijkstraFinder.prototype.constructor=BiDijkstraFinder,module.exports=BiDijkstraFinder},"./node_modules/pathfinding/src/finders/BreadthFirstFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Util=__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function BreadthFirstFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never)}BreadthFirstFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var neighbors,neighbor,node,i,l,openList=[],diagonalMovement=this.diagonalMovement,startNode=grid.getNodeAt(startX,startY),endNode=grid.getNodeAt(endX,endY);for(openList.push(startNode),startNode.opened=!0;openList.length;){if((node=openList.shift()).closed=!0,node===endNode)return Util.backtrace(endNode);for(i=0,l=(neighbors=grid.getNeighbors(node,diagonalMovement)).length;i<l;++i)(neighbor=neighbors[i]).closed||neighbor.opened||(openList.push(neighbor),neighbor.opened=!0,neighbor.parent=node)}return[]},module.exports=BreadthFirstFinder},"./node_modules/pathfinding/src/finders/DijkstraFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var AStarFinder=__webpack_require__("./node_modules/pathfinding/src/finders/AStarFinder.js");function DijkstraFinder(opt){AStarFinder.call(this,opt),this.heuristic=function(dx,dy){return 0}}DijkstraFinder.prototype=new AStarFinder,DijkstraFinder.prototype.constructor=DijkstraFinder,module.exports=DijkstraFinder},"./node_modules/pathfinding/src/finders/IDAStarFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{__webpack_require__("./node_modules/pathfinding/src/core/Util.js");var Heuristic=__webpack_require__("./node_modules/pathfinding/src/core/Heuristic.js"),Node=__webpack_require__("./node_modules/pathfinding/src/core/Node.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function IDAStarFinder(opt){opt=opt||{},this.allowDiagonal=opt.allowDiagonal,this.dontCrossCorners=opt.dontCrossCorners,this.diagonalMovement=opt.diagonalMovement,this.heuristic=opt.heuristic||Heuristic.manhattan,this.weight=opt.weight||1,this.trackRecursion=opt.trackRecursion||!1,this.timeLimit=opt.timeLimit||1/0,this.diagonalMovement||(this.allowDiagonal?this.dontCrossCorners?this.diagonalMovement=DiagonalMovement.OnlyWhenNoObstacles:this.diagonalMovement=DiagonalMovement.IfAtMostOneObstacle:this.diagonalMovement=DiagonalMovement.Never),this.diagonalMovement===DiagonalMovement.Never?this.heuristic=opt.heuristic||Heuristic.manhattan:this.heuristic=opt.heuristic||Heuristic.octile}IDAStarFinder.prototype.findPath=function(startX,startY,endX,endY,grid){var j,route,t,startTime=(new Date).getTime(),h=function(a,b){return this.heuristic(Math.abs(b.x-a.x),Math.abs(b.y-a.y))}.bind(this),search=function(node,g,cutoff,route,depth){if(this.timeLimit>0&&(new Date).getTime()-startTime>1e3*this.timeLimit)return 1/0;var min,t,k,neighbour,f=g+h(node,end)*this.weight;if(f>cutoff)return f;if(node==end)return route[depth]=[node.x,node.y],node;var a,b,neighbours=grid.getNeighbors(node,this.diagonalMovement);for(k=0,min=1/0;neighbour=neighbours[k];++k){if(this.trackRecursion&&(neighbour.retainCount=neighbour.retainCount+1||1,!0!==neighbour.tested&&(neighbour.tested=!0)),(t=search(neighbour,g+(b=neighbour,(a=node).x===b.x||a.y===b.y?1:Math.SQRT2),cutoff,route,depth+1))instanceof Node)return route[depth]=[node.x,node.y],t;this.trackRecursion&&0==--neighbour.retainCount&&(neighbour.tested=!1),t<min&&(min=t)}return min}.bind(this),start=grid.getNodeAt(startX,startY),end=grid.getNodeAt(endX,endY),cutOff=h(start,end);for(j=0;;++j){if((t=search(start,0,cutOff,route=[],0))===1/0)return[];if(t instanceof Node)return route;cutOff=t}return[]},module.exports=IDAStarFinder},"./node_modules/pathfinding/src/finders/JPFAlwaysMoveDiagonally.js":(module,__unused_webpack_exports,__webpack_require__)=>{var JumpPointFinderBase=__webpack_require__("./node_modules/pathfinding/src/finders/JumpPointFinderBase.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function JPFAlwaysMoveDiagonally(opt){JumpPointFinderBase.call(this,opt)}JPFAlwaysMoveDiagonally.prototype=new JumpPointFinderBase,JPFAlwaysMoveDiagonally.prototype.constructor=JPFAlwaysMoveDiagonally,JPFAlwaysMoveDiagonally.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(grid.isWalkableAt(x-dx,y+dy)&&!grid.isWalkableAt(x-dx,y)||grid.isWalkableAt(x+dx,y-dy)&&!grid.isWalkableAt(x,y-dy))return[x,y];if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x+dx,y+1)&&!grid.isWalkableAt(x,y+1)||grid.isWalkableAt(x+dx,y-1)&&!grid.isWalkableAt(x,y-1))return[x,y]}else if(grid.isWalkableAt(x+1,y+dy)&&!grid.isWalkableAt(x+1,y)||grid.isWalkableAt(x-1,y+dy)&&!grid.isWalkableAt(x-1,y))return[x,y];return this._jump(x+dx,y+dy,x,y)},JPFAlwaysMoveDiagonally.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x+dx,y+dy)&&neighbors.push([x+dx,y+dy]),grid.isWalkableAt(x-dx,y)||neighbors.push([x-dx,y+dy]),grid.isWalkableAt(x,y-dy)||neighbors.push([x+dx,y-dy])):0===dx?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+1,y)||neighbors.push([x+1,y+dy]),grid.isWalkableAt(x-1,y)||neighbors.push([x-1,y+dy])):(grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+1)||neighbors.push([x+dx,y+1]),grid.isWalkableAt(x,y-1)||neighbors.push([x+dx,y-1]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.Always)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFAlwaysMoveDiagonally},"./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfAtMostOneObstacle.js":(module,__unused_webpack_exports,__webpack_require__)=>{var JumpPointFinderBase=__webpack_require__("./node_modules/pathfinding/src/finders/JumpPointFinderBase.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function JPFMoveDiagonallyIfAtMostOneObstacle(opt){JumpPointFinderBase.call(this,opt)}JPFMoveDiagonallyIfAtMostOneObstacle.prototype=new JumpPointFinderBase,JPFMoveDiagonallyIfAtMostOneObstacle.prototype.constructor=JPFMoveDiagonallyIfAtMostOneObstacle,JPFMoveDiagonallyIfAtMostOneObstacle.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(grid.isWalkableAt(x-dx,y+dy)&&!grid.isWalkableAt(x-dx,y)||grid.isWalkableAt(x+dx,y-dy)&&!grid.isWalkableAt(x,y-dy))return[x,y];if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x+dx,y+1)&&!grid.isWalkableAt(x,y+1)||grid.isWalkableAt(x+dx,y-1)&&!grid.isWalkableAt(x,y-1))return[x,y]}else if(grid.isWalkableAt(x+1,y+dy)&&!grid.isWalkableAt(x+1,y)||grid.isWalkableAt(x-1,y+dy)&&!grid.isWalkableAt(x-1,y))return[x,y];return grid.isWalkableAt(x+dx,y)||grid.isWalkableAt(x,y+dy)?this._jump(x+dx,y+dy,x,y):null},JPFMoveDiagonallyIfAtMostOneObstacle.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy?(grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),(grid.isWalkableAt(x,y+dy)||grid.isWalkableAt(x+dx,y))&&neighbors.push([x+dx,y+dy]),!grid.isWalkableAt(x-dx,y)&&grid.isWalkableAt(x,y+dy)&&neighbors.push([x-dx,y+dy]),!grid.isWalkableAt(x,y-dy)&&grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y-dy])):0===dx?grid.isWalkableAt(x,y+dy)&&(neighbors.push([x,y+dy]),grid.isWalkableAt(x+1,y)||neighbors.push([x+1,y+dy]),grid.isWalkableAt(x-1,y)||neighbors.push([x-1,y+dy])):grid.isWalkableAt(x+dx,y)&&(neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+1)||neighbors.push([x+dx,y+1]),grid.isWalkableAt(x,y-1)||neighbors.push([x+dx,y-1]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.IfAtMostOneObstacle)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFMoveDiagonallyIfAtMostOneObstacle},"./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfNoObstacles.js":(module,__unused_webpack_exports,__webpack_require__)=>{var JumpPointFinderBase=__webpack_require__("./node_modules/pathfinding/src/finders/JumpPointFinderBase.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function JPFMoveDiagonallyIfNoObstacles(opt){JumpPointFinderBase.call(this,opt)}JPFMoveDiagonallyIfNoObstacles.prototype=new JumpPointFinderBase,JPFMoveDiagonallyIfNoObstacles.prototype.constructor=JPFMoveDiagonallyIfNoObstacles,JPFMoveDiagonallyIfNoObstacles.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx&&0!==dy){if(this._jump(x+dx,y,x,y)||this._jump(x,y+dy,x,y))return[x,y]}else if(0!==dx){if(grid.isWalkableAt(x,y-1)&&!grid.isWalkableAt(x-dx,y-1)||grid.isWalkableAt(x,y+1)&&!grid.isWalkableAt(x-dx,y+1))return[x,y]}else if(0!==dy&&(grid.isWalkableAt(x-1,y)&&!grid.isWalkableAt(x-1,y-dy)||grid.isWalkableAt(x+1,y)&&!grid.isWalkableAt(x+1,y-dy)))return[x,y];return grid.isWalkableAt(x+dx,y)&&grid.isWalkableAt(x,y+dy)?this._jump(x+dx,y+dy,x,y):null},JPFMoveDiagonallyIfNoObstacles.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,isNextWalkable,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent){if(px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx&&0!==dy)grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y]),grid.isWalkableAt(x,y+dy)&&grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y+dy]);else if(0!==dx){isNextWalkable=grid.isWalkableAt(x+dx,y);var isTopWalkable=grid.isWalkableAt(x,y+1),isBottomWalkable=grid.isWalkableAt(x,y-1);isNextWalkable&&(neighbors.push([x+dx,y]),isTopWalkable&&neighbors.push([x+dx,y+1]),isBottomWalkable&&neighbors.push([x+dx,y-1])),isTopWalkable&&neighbors.push([x,y+1]),isBottomWalkable&&neighbors.push([x,y-1])}else if(0!==dy){isNextWalkable=grid.isWalkableAt(x,y+dy);var isRightWalkable=grid.isWalkableAt(x+1,y),isLeftWalkable=grid.isWalkableAt(x-1,y);isNextWalkable&&(neighbors.push([x,y+dy]),isRightWalkable&&neighbors.push([x+1,y+dy]),isLeftWalkable&&neighbors.push([x-1,y+dy])),isRightWalkable&&neighbors.push([x+1,y]),isLeftWalkable&&neighbors.push([x-1,y])}}else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.OnlyWhenNoObstacles)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFMoveDiagonallyIfNoObstacles},"./node_modules/pathfinding/src/finders/JPFNeverMoveDiagonally.js":(module,__unused_webpack_exports,__webpack_require__)=>{var JumpPointFinderBase=__webpack_require__("./node_modules/pathfinding/src/finders/JumpPointFinderBase.js"),DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function JPFNeverMoveDiagonally(opt){JumpPointFinderBase.call(this,opt)}JPFNeverMoveDiagonally.prototype=new JumpPointFinderBase,JPFNeverMoveDiagonally.prototype.constructor=JPFNeverMoveDiagonally,JPFNeverMoveDiagonally.prototype._jump=function(x,y,px,py){var grid=this.grid,dx=x-px,dy=y-py;if(!grid.isWalkableAt(x,y))return null;if(!0===this.trackJumpRecursion&&(grid.getNodeAt(x,y).tested=!0),grid.getNodeAt(x,y)===this.endNode)return[x,y];if(0!==dx){if(grid.isWalkableAt(x,y-1)&&!grid.isWalkableAt(x-dx,y-1)||grid.isWalkableAt(x,y+1)&&!grid.isWalkableAt(x-dx,y+1))return[x,y]}else{if(0===dy)throw new Error("Only horizontal and vertical movements are allowed");if(grid.isWalkableAt(x-1,y)&&!grid.isWalkableAt(x-1,y-dy)||grid.isWalkableAt(x+1,y)&&!grid.isWalkableAt(x+1,y-dy))return[x,y];if(this._jump(x+1,y,x,y)||this._jump(x-1,y,x,y))return[x,y]}return this._jump(x+dx,y+dy,x,y)},JPFNeverMoveDiagonally.prototype._findNeighbors=function(node){var px,py,dx,dy,neighborNodes,neighborNode,i,l,parent=node.parent,x=node.x,y=node.y,grid=this.grid,neighbors=[];if(parent)px=parent.x,py=parent.y,dx=(x-px)/Math.max(Math.abs(x-px),1),dy=(y-py)/Math.max(Math.abs(y-py),1),0!==dx?(grid.isWalkableAt(x,y-1)&&neighbors.push([x,y-1]),grid.isWalkableAt(x,y+1)&&neighbors.push([x,y+1]),grid.isWalkableAt(x+dx,y)&&neighbors.push([x+dx,y])):0!==dy&&(grid.isWalkableAt(x-1,y)&&neighbors.push([x-1,y]),grid.isWalkableAt(x+1,y)&&neighbors.push([x+1,y]),grid.isWalkableAt(x,y+dy)&&neighbors.push([x,y+dy]));else for(i=0,l=(neighborNodes=grid.getNeighbors(node,DiagonalMovement.Never)).length;i<l;++i)neighborNode=neighborNodes[i],neighbors.push([neighborNode.x,neighborNode.y]);return neighbors},module.exports=JPFNeverMoveDiagonally},"./node_modules/pathfinding/src/finders/JumpPointFinder.js":(module,__unused_webpack_exports,__webpack_require__)=>{var DiagonalMovement=__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js"),JPFNeverMoveDiagonally=__webpack_require__("./node_modules/pathfinding/src/finders/JPFNeverMoveDiagonally.js"),JPFAlwaysMoveDiagonally=__webpack_require__("./node_modules/pathfinding/src/finders/JPFAlwaysMoveDiagonally.js"),JPFMoveDiagonallyIfNoObstacles=__webpack_require__("./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfNoObstacles.js"),JPFMoveDiagonallyIfAtMostOneObstacle=__webpack_require__("./node_modules/pathfinding/src/finders/JPFMoveDiagonallyIfAtMostOneObstacle.js");module.exports=function JumpPointFinder(opt){return(opt=opt||{}).diagonalMovement===DiagonalMovement.Never?new JPFNeverMoveDiagonally(opt):opt.diagonalMovement===DiagonalMovement.Always?new JPFAlwaysMoveDiagonally(opt):opt.diagonalMovement===DiagonalMovement.OnlyWhenNoObstacles?new JPFMoveDiagonallyIfNoObstacles(opt):new JPFMoveDiagonallyIfAtMostOneObstacle(opt)}},"./node_modules/pathfinding/src/finders/JumpPointFinderBase.js":(module,__unused_webpack_exports,__webpack_require__)=>{var Heap=__webpack_require__("./node_modules/heap/index.js"),Util=__webpack_require__("./node_modules/pathfinding/src/core/Util.js"),Heuristic=__webpack_require__("./node_modules/pathfinding/src/core/Heuristic.js");__webpack_require__("./node_modules/pathfinding/src/core/DiagonalMovement.js");function JumpPointFinderBase(opt){opt=opt||{},this.heuristic=opt.heuristic||Heuristic.manhattan,this.trackJumpRecursion=opt.trackJumpRecursion||!1}JumpPointFinderBase.prototype.findPath=function(startX,startY,endX,endY,grid){var node,openList=this.openList=new Heap((function(nodeA,nodeB){return nodeA.f-nodeB.f})),startNode=this.startNode=grid.getNodeAt(startX,startY),endNode=this.endNode=grid.getNodeAt(endX,endY);for(this.grid=grid,startNode.g=0,startNode.f=0,openList.push(startNode),startNode.opened=!0;!openList.empty();){if((node=openList.pop()).closed=!0,node===endNode)return Util.expandPath(Util.backtrace(endNode));this._identifySuccessors(node)}return[]},JumpPointFinderBase.prototype._identifySuccessors=function(node){var neighbors,neighbor,jumpPoint,i,l,jx,jy,d,ng,jumpNode,grid=this.grid,heuristic=this.heuristic,openList=this.openList,endX=this.endNode.x,endY=this.endNode.y,x=node.x,y=node.y,abs=Math.abs;Math.max;for(i=0,l=(neighbors=this._findNeighbors(node)).length;i<l;++i)if(neighbor=neighbors[i],jumpPoint=this._jump(neighbor[0],neighbor[1],x,y)){if(jx=jumpPoint[0],jy=jumpPoint[1],(jumpNode=grid.getNodeAt(jx,jy)).closed)continue;d=Heuristic.octile(abs(jx-x),abs(jy-y)),ng=node.g+d,(!jumpNode.opened||ng<jumpNode.g)&&(jumpNode.g=ng,jumpNode.h=jumpNode.h||heuristic(abs(jx-endX),abs(jy-endY)),jumpNode.f=jumpNode.g+jumpNode.h,jumpNode.parent=node,jumpNode.opened?openList.updateItem(jumpNode):(openList.push(jumpNode),jumpNode.opened=!0))}},module.exports=JumpPointFinderBase},"./node_modules/react/cjs/react-jsx-runtime.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var f=__webpack_require__("./node_modules/react/index.js"),k=Symbol.for("react.element"),l=Symbol.for("react.fragment"),m=Object.prototype.hasOwnProperty,n=f.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p={key:!0,ref:!0,__self:!0,__source:!0};function q(c,a,g){var b,d={},e=null,h=null;for(b in void 0!==g&&(e=""+g),void 0!==a.key&&(e=""+a.key),void 0!==a.ref&&(h=a.ref),a)m.call(a,b)&&!p.hasOwnProperty(b)&&(d[b]=a[b]);if(c&&c.defaultProps)for(b in a=c.defaultProps)void 0===d[b]&&(d[b]=a[b]);return{$$typeof:k,type:c,key:e,ref:h,props:d,_owner:n.current}}exports.Fragment=l,exports.jsx=q,exports.jsxs=q},"./node_modules/react/jsx-runtime.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/react/cjs/react-jsx-runtime.production.min.js")},"./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var e=__webpack_require__("./node_modules/react/index.js");var k="function"==typeof Object.is?Object.is:function h(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},l=e.useState,m=e.useEffect,n=e.useLayoutEffect,p=e.useDebugValue;function r(a){var b=a.getSnapshot;a=a.value;try{var d=b();return!k(a,d)}catch(f){return!0}}var u="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function t(a,b){return b()}:function q(a,b){var d=b(),f=l({inst:{value:d,getSnapshot:b}}),c=f[0].inst,g=f[1];return n((function(){c.value=d,c.getSnapshot=b,r(c)&&g({inst:c})}),[a,d,b]),m((function(){return r(c)&&g({inst:c}),a((function(){r(c)&&g({inst:c})}))}),[a]),p(d),d};exports.useSyncExternalStore=void 0!==e.useSyncExternalStore?e.useSyncExternalStore:u},"./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js":(__unused_webpack_module,exports,__webpack_require__)=>{"use strict";var h=__webpack_require__("./node_modules/react/index.js"),n=__webpack_require__("./node_modules/use-sync-external-store/shim/index.js");var q="function"==typeof Object.is?Object.is:function p(a,b){return a===b&&(0!==a||1/a==1/b)||a!=a&&b!=b},r=n.useSyncExternalStore,t=h.useRef,u=h.useEffect,v=h.useMemo,w=h.useDebugValue;exports.useSyncExternalStoreWithSelector=function(a,b,e,l,g){var c=t(null);if(null===c.current){var f={hasValue:!1,value:null};c.current=f}else f=c.current;c=v((function(){function a(a){if(!c){if(c=!0,d=a,a=l(a),void 0!==g&&f.hasValue){var b=f.value;if(g(b,a))return k=b}return k=a}if(b=k,q(d,a))return b;var e=l(a);return void 0!==g&&g(b,e)?b:(d=a,k=e)}var d,k,c=!1,m=void 0===e?null:e;return[function(){return a(b())},null===m?void 0:function(){return a(m())}]}),[b,e,l,g]);var d=r(a,c[0],c[1]);return u((function(){f.hasValue=!0,f.value=d}),[d]),w(d),d}},"./node_modules/use-sync-external-store/shim/index.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim.production.min.js")},"./node_modules/use-sync-external-store/shim/with-selector.js":(module,__unused_webpack_exports,__webpack_require__)=>{"use strict";module.exports=__webpack_require__("./node_modules/use-sync-external-store/cjs/use-sync-external-store-shim/with-selector.production.min.js")}}]);